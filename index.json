{"repository_name":"mocopo","body":"# MocoPo\n\n⚠️ WARNING VIBE CODING ⚠️\n\nA Crystal library for building MCP (Model Context Protocol) servers.\n\n## Overview\n\nMocoPo enables you to easily build MCP servers in Crystal.  \nIt provides a flexible transport layer supporting multiple communication methods (HTTP, SSE, stdio),  \nand offers a DSL-style API for intuitive management of tools, resources, and prompts.\n\nThe library uses Kemal for HTTP handling but abstracts communication through a transport layer,  \nallowing for different communication mechanisms to be used interchangeably.\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     mocopo:\n       github: your-github-user/mocopo\n   ```\n\n2. Run `shards install`\n\n## Features\n\n- **Multiple Transport Support**:\n\n  - HTTP transport for web-based applications\n  - SSE (Server-Sent Events) transport for real-time notifications\n  - stdio transport for command-line tools and local integrations\n  - Extensible architecture for custom transports\n\n- **Tool Management**:\n\n  - Register and manage tools with rich argument schemas\n  - Support for nested arguments, arrays, and objects\n  - Execution callbacks with context\n\n- **Resource Management**:\n\n  - URI-based resource registration\n  - Content providers with dynamic generation\n  - MIME type support\n\n- **Notification System**:\n\n  - Real-time notifications across all transports\n  - List change notifications for tools, resources, and prompts\n  - Resource update notifications\n\n- **Consistent JSON Handling**:\n  - Uses `JsonValue` type consistently throughout the codebase\n  - Type-safe JSON handling with clear interfaces\n  - Utility functions for converting between `JsonValue` and Crystal's `JSON::Any` when needed\n  - Simplified JSON schema generation and validation\n\n## Usage\n\n```crystal\nrequire \"mocopo\"\n\n# Create a new MCP server\nserver = MocoPo::Server.new(\n  name: \"MyMCPServer\",\n  version: \"1.0.0\"\n)\n\n# By default, HTTP transport is created automatically\n# You can create additional transports as needed\nstdio_transport = server.create_stdio_transport\nsse_transport = server.create_sse_transport\n\n# Register a tool with arguments and execution callback\ngreet_tool = server.register_tool(\"greet\", \"Greet someone by name\")\ngreet_tool\n  .argument_string(\"name\", true, \"Name to greet\")\n  .on_execute do |args|\n    # args is a JsonObject (Hash(String, JsonValue))\n    name = \"World\"\n    if args && args[\"name\"]?\n      name_value = args[\"name\"]\n      name = name_value.is_a?(String) ? name_value : name_value.to_s\n    end\n\n    {\n      \"content\" => [\n        {\n          \"type\" => \"text\",\n          \"text\" => \"Hello, #{name}!\"\n        }\n      ] of Hash(String, String),\n      \"isError\" => \"false\"\n    }\n  end\n\n# Register a resource with content callback\nreadme_resource = server.register_resource(\n  uri: \"file:///readme\",\n  name: \"README\",\n  description: \"Project README file\",\n  mime_type: \"text/markdown\"\n)\nreadme_resource.on_read do\n  MocoPo::ResourceContent.text(\n    uri: \"file:///readme\",\n    text: \"# My MCP Server\\n\\nThis is a sample README.\",\n    mime_type: \"text/markdown\"\n  )\nend\n\n# Start the server on port 3000 (starts all transports)\nserver.start\n```\n\nFor more examples, see the [examples](examples/) directory.\n\n## Development\n\n- Use Crystal's built-in Spec framework for testing\n- Generate documentation with `crystal doc`\n\n## Contributing\n\n1. Fork it (<https://github.com/your-github-user/mocopo/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n","program":{"html_id":"mocopo/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"mocopo","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"mocopo/MocoPo","path":"MocoPo.html","kind":"module","full_name":"MocoPo","name":"MocoPo","abstract":false,"locations":[{"filename":"src/mocopo.cr","line_number":21,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L21"},{"filename":"src/mocopo/arguments.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L1"},{"filename":"src/mocopo/cancellation.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L3"},{"filename":"src/mocopo/completion.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L1"},{"filename":"src/mocopo/context.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L1"},{"filename":"src/mocopo/handlers.cr","line_number":12,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers.cr#L12"},{"filename":"src/mocopo/handlers/base_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/base_handler.cr#L3"},{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L1"},{"filename":"src/mocopo/handlers/completion_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/completion_handler.cr#L1"},{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L1"},{"filename":"src/mocopo/handlers/initialize_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/initialize_handler.cr#L1"},{"filename":"src/mocopo/handlers/prompts_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/prompts_handler.cr#L1"},{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L1"},{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L1"},{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L1"},{"filename":"src/mocopo/handlers/tools_handler.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/tools_handler.cr#L1"},{"filename":"src/mocopo/json_rpc.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L3"},{"filename":"src/mocopo/notifications.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L1"},{"filename":"src/mocopo/pagination.cr","line_number":4,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L4"},{"filename":"src/mocopo/prompts.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L1"},{"filename":"src/mocopo/resources.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L1"},{"filename":"src/mocopo/roots.cr","line_number":4,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L4"},{"filename":"src/mocopo/sampling.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L3"},{"filename":"src/mocopo/tools.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L3"},{"filename":"src/mocopo/transport.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L1"},{"filename":"src/mocopo/transport_manager.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L6"},{"filename":"src/mocopo/transports/http_transport.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L6"},{"filename":"src/mocopo/transports/sse_transport.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L6"},{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L5"},{"filename":"src/mocopo/types.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L1"},{"filename":"src/mocopo/utils.cr","line_number":1,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L1"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"PROTOCOL_VERSION","name":"PROTOCOL_VERSION","value":"\"2025-03-26\"","doc":"MCP protocol version supported by this implementation","summary":"<p>MCP protocol version supported by this implementation</p>"},{"id":"VERSION","name":"VERSION","value":"\"0.1.0\""}],"doc":"MocoPo - A Crystal library for building MCP (Model Context Protocol) servers","summary":"<p>MocoPo - A Crystal library for building MCP (Model Context Protocol) servers</p>","class_methods":[{"html_id":"safe_array(value:JsonValue|Nil):Array(JsonValue)|Nil-class-method","name":"safe_array","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"args_string":"(value : JsonValue | Nil) : Array(JsonValue) | Nil","args_html":"(value : <a href=\"MocoPo/JsonValue.html\">JsonValue</a> | Nil) : Array(<a href=\"MocoPo/JsonValue.html\">JsonValue</a>) | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":76,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L76"},"def":{"name":"safe_array","args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"return_type":"Array(JsonValue) | ::Nil","visibility":"Public","body":"if value.nil?\n  return nil\nend\n\ncase value\nwhen Array\n  value.as(Array(JsonValue))\nelse\n  nil\nend\n"},"external_var":false},{"html_id":"safe_float(value:JsonValue|Nil):Float64|Nil-class-method","name":"safe_float","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"args_string":"(value : JsonValue | Nil) : Float64 | Nil","args_html":"(value : <a href=\"MocoPo/JsonValue.html\">JsonValue</a> | Nil) : Float64 | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":31,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L31"},"def":{"name":"safe_float","args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"return_type":"Float64 | ::Nil","visibility":"Public","body":"if value.nil?\n  return nil\nend\n\ncase value\nwhen Float64\n  value.as(Float64)\nwhen Int32\n  (value.as(Int32)).to_f64\nelse\n  begin\n    value.to_s.to_f64\n  rescue\n    nil\n  end\nend\n"},"external_var":false},{"html_id":"safe_hash(value:JsonValue|Nil):JsonObject|Nil-class-method","name":"safe_hash","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"args_string":"(value : JsonValue | Nil) : JsonObject | Nil","args_html":"(value : <a href=\"MocoPo/JsonValue.html\">JsonValue</a> | Nil) : <a href=\"MocoPo/JsonObject.html\">JsonObject</a> | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":65,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L65"},"def":{"name":"safe_hash","args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"return_type":"JsonObject | ::Nil","visibility":"Public","body":"if value.nil?\n  return nil\nend\n\ncase value\nwhen Hash\n  value.as(JsonObject)\nelse\n  nil\nend\n"},"external_var":false},{"html_id":"safe_int(value:JsonValue|Nil):Int32|Nil-class-method","name":"safe_int","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"args_string":"(value : JsonValue | Nil) : Int32 | Nil","args_html":"(value : <a href=\"MocoPo/JsonValue.html\">JsonValue</a> | Nil) : Int32 | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L48"},"def":{"name":"safe_int","args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"return_type":"Int32 | ::Nil","visibility":"Public","body":"if value.nil?\n  return nil\nend\n\ncase value\nwhen Int32\n  value.as(Int32)\nwhen Float64\n  (value.as(Float64)).to_i32\nelse\n  begin\n    value.to_s.to_i32\n  rescue\n    nil\n  end\nend\n"},"external_var":false},{"html_id":"safe_string(value:JsonValue|Nil):String|Nil-class-method","name":"safe_string","doc":"Helper methods for JSON parsing","summary":"<p>Helper methods for JSON parsing</p>","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"args_string":"(value : JsonValue | Nil) : String | Nil","args_html":"(value : <a href=\"MocoPo/JsonValue.html\">JsonValue</a> | Nil) : String | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L16"},"def":{"name":"safe_string","args":[{"name":"value","external_name":"value","restriction":"JsonValue | ::Nil"}],"return_type":"String | ::Nil","visibility":"Public","body":"if value.nil?\n  return nil\nend\n\ncase value\nwhen String\n  value.as(String)\nelse\n  begin\n    value.to_s\n  rescue\n    nil\n  end\nend\n"},"external_var":false}],"types":[{"html_id":"mocopo/MocoPo/Argument","path":"MocoPo/Argument.html","kind":"class","full_name":"MocoPo::Argument","name":"Argument","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/arguments.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Represents an argument for a tool","summary":"<p>Represents an argument for a tool</p>","constructors":[{"html_id":"new(name:String,type:String,required:Bool=false,description:String|Nil=nil,nested_arguments:Array(Argument)|Nil=nil,item_type:String|Nil=nil)-class-method","name":"new","doc":"Initialize a new argument","summary":"<p>Initialize a new argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"type","external_name":"type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"nested_arguments","default_value":"nil","external_name":"nested_arguments","restriction":"Array(Argument) | ::Nil"},{"name":"item_type","default_value":"nil","external_name":"item_type","restriction":"String | ::Nil"}],"args_string":"(name : String, type : String, required : Bool = false, description : String | Nil = nil, nested_arguments : Array(Argument) | Nil = nil, item_type : String | Nil = nil)","args_html":"(name : String, type : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>, nested_arguments : Array(<a href=\"../MocoPo/Argument.html\">Argument</a>) | Nil = <span class=\"n\">nil</span>, item_type : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/arguments.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L23"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"type","external_name":"type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"nested_arguments","default_value":"nil","external_name":"nested_arguments","restriction":"Array(Argument) | ::Nil"},{"name":"item_type","default_value":"nil","external_name":"item_type","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, type, required, description, nested_arguments, item_type)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"description:String|Nil-instance-method","name":"description","doc":"Human-readable description","summary":"<p>Human-readable description</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L14"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"item_type:String|Nil-instance-method","name":"item_type","doc":"Item type (for array arguments)","summary":"<p>Item type (for array arguments)</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":20,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L20"},"def":{"name":"item_type","return_type":"String | ::Nil","visibility":"Public","body":"@item_type"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Argument name","summary":"<p>Argument name</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L5"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"nested_arguments:Array(Argument)|Nil-instance-method","name":"nested_arguments","doc":"Nested arguments (for object arguments)","summary":"<p>Nested arguments (for object arguments)</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L17"},"def":{"name":"nested_arguments","return_type":"Array(Argument) | ::Nil","visibility":"Public","body":"@nested_arguments"},"external_var":false},{"html_id":"required:Bool-instance-method","name":"required","doc":"Whether the argument is required","summary":"<p>Whether the argument is required</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L11"},"def":{"name":"required","return_type":"Bool","visibility":"Public","body":"@required"},"external_var":false},{"html_id":"to_json_schema:JsonObject-instance-method","name":"to_json_schema","doc":"Convert to JSON Schema","summary":"<p>Convert to JSON Schema</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":27,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L27"},"def":{"name":"to_json_schema","return_type":"JsonObject","visibility":"Public","body":"schema = {\"type\" => @type} of String => JsonValue\n\n\nif @description\n  schema[\"description\"] = @description\nend\n\n\nif (@type == \"array\") && @item_type\n  schema[\"items\"] = {\"type\" => @item_type} of String => JsonValue\nend\n\n\nif (@type == \"object\") && @nested_arguments\n  properties = {} of String => JsonValue\n  required = [] of JsonValue\n\n  @nested_arguments.not_nil!.each do |arg|\n    properties[arg.name] = arg.to_json_schema\n    if arg.required\n      required << arg.name\n    end\n  end\n\n  schema[\"properties\"] = properties\n  if required.empty?\n  else\n    schema[\"required\"] = required\n  end\nend\n\nschema\n"},"external_var":false},{"html_id":"type:String-instance-method","name":"type","doc":"Argument type","summary":"<p>Argument type</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L8"},"def":{"name":"type","return_type":"String","visibility":"Public","body":"@type"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ArgumentBuilder","path":"MocoPo/ArgumentBuilder.html","kind":"class","full_name":"MocoPo::ArgumentBuilder","name":"ArgumentBuilder","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/arguments.cr","line_number":59,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L59"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Builder for creating argument definitions","summary":"<p>Builder for creating argument definitions</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new argument builder","summary":"<p>Initialize a new argument builder</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":64,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L64"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"arguments:Array(Argument)-instance-method","name":"arguments","doc":"Arguments being built","summary":"<p>Arguments being built</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L61"},"def":{"name":"arguments","return_type":"Array(Argument)","visibility":"Public","body":"@arguments"},"external_var":false},{"html_id":"array(name:String,item_type:String,required:Bool=false,description:String|Nil=nil):Argument-instance-method","name":"array","doc":"Add an array argument","summary":"<p>Add an array argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"item_type","external_name":"item_type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, item_type : String, required : Bool = false, description : String | Nil = nil) : Argument","args_html":"(name : String, item_type : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Argument.html\">Argument</a>","location":{"filename":"src/mocopo/arguments.cr","line_number":104,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L104"},"def":{"name":"array","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"item_type","external_name":"item_type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Argument","visibility":"Public","body":"arg = Argument.new(name, \"array\", required, description, nil, item_type)\n@arguments << arg\narg\n"},"external_var":false},{"html_id":"boolean(name:String,required:Bool=false,description:String|Nil=nil):Argument-instance-method","name":"boolean","doc":"Add a boolean argument","summary":"<p>Add a boolean argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Argument","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Argument.html\">Argument</a>","location":{"filename":"src/mocopo/arguments.cr","line_number":83,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L83"},"def":{"name":"boolean","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Argument","visibility":"Public","body":"arg = Argument.new(name, \"boolean\", required, description)\n@arguments << arg\narg\n"},"external_var":false},{"html_id":"number(name:String,required:Bool=false,description:String|Nil=nil):Argument-instance-method","name":"number","doc":"Add a number argument","summary":"<p>Add a number argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Argument","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Argument.html\">Argument</a>","location":{"filename":"src/mocopo/arguments.cr","line_number":76,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L76"},"def":{"name":"number","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Argument","visibility":"Public","body":"arg = Argument.new(name, \"number\", required, description)\n@arguments << arg\narg\n"},"external_var":false},{"html_id":"object(name:String,required:Bool=false,description:String|Nil=nil,&):Argument-instance-method","name":"object","doc":"Add an object argument","summary":"<p>Add an object argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil, &) : Argument","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>, &) : <a href=\"../MocoPo/Argument.html\">Argument</a>","location":{"filename":"src/mocopo/arguments.cr","line_number":90,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L90"},"def":{"name":"object","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"yields":1,"block_arity":1,"return_type":"Argument","visibility":"Public","body":"nested_builder = ArgumentBuilder.new\n\n\nyield nested_builder\n\n\narg = Argument.new(name, \"object\", required, description, nested_builder.arguments)\n@arguments << arg\narg\n"},"external_var":false},{"html_id":"string(name:String,required:Bool=false,description:String|Nil=nil):Argument-instance-method","name":"string","doc":"Add a string argument","summary":"<p>Add a string argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Argument","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Argument.html\">Argument</a>","location":{"filename":"src/mocopo/arguments.cr","line_number":69,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L69"},"def":{"name":"string","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Argument","visibility":"Public","body":"arg = Argument.new(name, \"string\", required, description)\n@arguments << arg\narg\n"},"external_var":false},{"html_id":"to_json_schema:JsonObject-instance-method","name":"to_json_schema","doc":"Build JSON Schema from arguments","summary":"<p>Build JSON Schema from arguments</p>","abstract":false,"location":{"filename":"src/mocopo/arguments.cr","line_number":111,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/arguments.cr#L111"},"def":{"name":"to_json_schema","return_type":"JsonObject","visibility":"Public","body":"properties = {} of String => JsonValue\nrequired = [] of JsonValue\n\n@arguments.each do |arg|\n  properties[arg.name] = arg.to_json_schema\n  if arg.required\n    required << arg.name\n  end\nend\n\nschema = {\"type\" => \"object\", \"properties\" => properties} of String => JsonValue\n\nif required.empty?\nelse\n  schema[\"required\"] = required\nend\n\nschema\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/BaseHandler","path":"MocoPo/BaseHandler.html","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler","abstract":true,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/base_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/base_handler.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/CancellationHandler","kind":"class","full_name":"MocoPo::CancellationHandler","name":"CancellationHandler"},{"html_id":"mocopo/MocoPo/CompletionHandler","kind":"class","full_name":"MocoPo::CompletionHandler","name":"CompletionHandler"},{"html_id":"mocopo/MocoPo/InitializeHandler","kind":"class","full_name":"MocoPo::InitializeHandler","name":"InitializeHandler"},{"html_id":"mocopo/MocoPo/PromptsHandler","kind":"class","full_name":"MocoPo::PromptsHandler","name":"PromptsHandler"},{"html_id":"mocopo/MocoPo/ResourcesHandler","kind":"class","full_name":"MocoPo::ResourcesHandler","name":"ResourcesHandler"},{"html_id":"mocopo/MocoPo/RootsHandler","kind":"class","full_name":"MocoPo::RootsHandler","name":"RootsHandler"},{"html_id":"mocopo/MocoPo/SamplingHandler","kind":"class","full_name":"MocoPo::SamplingHandler","name":"SamplingHandler"},{"html_id":"mocopo/MocoPo/ToolsHandler","kind":"class","full_name":"MocoPo::ToolsHandler","name":"ToolsHandler"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Base class for all JSON-RPC method handlers","summary":"<p>Base class for all JSON-RPC method handlers</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new handler","summary":"<p>Initialize a new handler</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/handlers/base_handler.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/base_handler.cr#L10"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":true,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/base_handler.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/base_handler.cr#L14"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":""},"external_var":false}]},{"html_id":"mocopo/MocoPo/CancellationHandler","path":"MocoPo/CancellationHandler.html","kind":"class","full_name":"MocoPo::CancellationHandler","name":"CancellationHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for cancellation methods","summary":"<p>Handler for cancellation methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,method:String,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request with method","summary":"<p>Handle a JSON-RPC request with method</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"method","external_name":"method","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, method : String, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, method : String, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":111,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L111"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"method","external_name":"method","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"case method\nwhen \"cancellation/create\"\n  handle_create(id, params)\nwhen \"cancellation/cancel\"\n  handle_cancel(id, params)\nwhen \"cancellation/status\"\n  handle_status(id, params)\nwhen \"cancellation/list\"\n  handle_list(id, params)\nelse\n  error_response(-32601, \"Method not found: #{method}\", id)\nend"},"external_var":false},{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":105,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L105"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"CancellationHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_cancel(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_cancel","doc":"Handle cancellation/cancel request","summary":"<p>Handle cancellation/cancel request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":20,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L20"},"def":{"name":"handle_cancel","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  token_id = params.try do |p|\n    MocoPo.safe_string(p[\"id\"]?)\n  end\n  reason = params.try do |p|\n    MocoPo.safe_string(p[\"reason\"]?)\n  end\n\n\n  if token_id\n  else\n    return error_response(-32602, \"Missing token ID\", id)\n  end\n\n\n  success = @server.cancel_token(token_id, reason)\n\n\n  if success\n    success_response(id, {\"success\" => true} of String => JsonValue)\n  else\n    error_response(-32602, \"Token not found: #{token_id}\", id)\n  end\nrescue ex\n  error_response(-32603, \"Error cancelling token: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_create(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_create","doc":"Handle cancellation/create request","summary":"<p>Handle cancellation/create request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L5"},"def":{"name":"handle_create","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  token_id = params.try do |p|\n    MocoPo.safe_string(p[\"id\"]?)\n  end\n  token = @server.create_cancellation_token(token_id)\n\n\n  success_response(id, token.to_json_object)\nrescue ex\n  error_response(-32603, \"Error creating cancellation token: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle cancellation/list request","summary":"<p>Handle cancellation/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":83,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L83"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  tokens = @server.cancellation_manager.list\n\n\n  tokens_array = [] of JsonValue\n  tokens.each do |token|\n    tokens_array << token.to_json_object\n  end\n\n\n  result = {} of String => JsonValue\n  result[\"tokens\"] = tokens_array\n  success_response(id, result)\nrescue ex\n  error_response(-32603, \"Error listing tokens: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_status(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_status","doc":"Handle cancellation/status request","summary":"<p>Handle cancellation/status request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/cancellation_handler.cr","line_number":52,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/cancellation_handler.cr#L52"},"def":{"name":"handle_status","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  token_id = params.try do |p|\n    MocoPo.safe_string(p[\"id\"]?)\n  end\n\n\n  if token_id\n  else\n    return error_response(-32602, \"Missing token ID\", id)\n  end\n\n\n  token = @server.cancellation_manager.get_token(token_id)\n\n\n  if token\n    success_response(id, token.to_json_object)\n  else\n    error_response(-32602, \"Token not found: #{token_id}\", id)\n  end\nrescue ex\n  error_response(-32603, \"Error getting token status: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false}]},{"html_id":"mocopo/MocoPo/CancellationManager","path":"MocoPo/CancellationManager.html","kind":"class","full_name":"MocoPo::CancellationManager","name":"CancellationManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/cancellation.cr","line_number":49,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L49"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Cancellation manager","summary":"<p>Cancellation manager</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new cancellation manager","summary":"<p>Initialize a new cancellation manager</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":54,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L54"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"cancel_token(id:String,reason:String|Nil=nil):Bool-instance-method","name":"cancel_token","doc":"Cancel a token by ID","summary":"<p>Cancel a token by ID</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"args_string":"(id : String, reason : String | Nil = nil) : Bool","args_html":"(id : String, reason : String | Nil = <span class=\"n\">nil</span>) : Bool","location":{"filename":"src/mocopo/cancellation.cr","line_number":79,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L79"},"def":{"name":"cancel_token","args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"return_type":"Bool","visibility":"Public","body":"token = get_token(id)\n\n\nif token\nelse\n  return false\nend\n\n\ntoken.cancel(reason)\n\n\ntrue\n"},"external_var":false},{"html_id":"clear-instance-method","name":"clear","doc":"Clear all tokens","summary":"<p>Clear all tokens</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":123,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L123"},"def":{"name":"clear","visibility":"Public","body":"@tokens.clear"},"external_var":false},{"html_id":"create_token(id:String|Nil=nil):CancellationToken-instance-method","name":"create_token","doc":"Create a new token","summary":"<p>Create a new token</p>","abstract":false,"args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"String | ::Nil"}],"args_string":"(id : String | Nil = nil) : CancellationToken","args_html":"(id : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/CancellationToken.html\">CancellationToken</a>","location":{"filename":"src/mocopo/cancellation.cr","line_number":59,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L59"},"def":{"name":"create_token","args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"String | ::Nil"}],"return_type":"CancellationToken","visibility":"Public","body":"id = id || (Random.new.hex(16))\n\n\ntoken = CancellationToken.new(id)\n\n\n@tokens[id] = token\n\n\ntoken\n"},"external_var":false},{"html_id":"get_token(id:String):CancellationToken|Nil-instance-method","name":"get_token","doc":"Get a token by ID","summary":"<p>Get a token by ID</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : CancellationToken | Nil","args_html":"(id : String) : <a href=\"../MocoPo/CancellationToken.html\">CancellationToken</a> | Nil","location":{"filename":"src/mocopo/cancellation.cr","line_number":74,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L74"},"def":{"name":"get_token","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"CancellationToken | ::Nil","visibility":"Public","body":"@tokens[id]?"},"external_var":false},{"html_id":"is_cancelled?(id:String):Bool-instance-method","name":"is_cancelled?","doc":"Check if a token is cancelled","summary":"<p>Check if a token is cancelled</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","args_html":"(id : String) : Bool","location":{"filename":"src/mocopo/cancellation.cr","line_number":94,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L94"},"def":{"name":"is_cancelled?","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"token = get_token(id)\n\n\nif token\nelse\n  return false\nend\n\n\ntoken.cancelled?\n"},"external_var":false},{"html_id":"list:Array(CancellationToken)-instance-method","name":"list","doc":"List all tokens","summary":"<p>List all tokens</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":106,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L106"},"def":{"name":"list","return_type":"Array(CancellationToken)","visibility":"Public","body":"@tokens.values"},"external_var":false},{"html_id":"remove_token(id:String):Bool-instance-method","name":"remove_token","doc":"Remove a token by ID","summary":"<p>Remove a token by ID</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","args_html":"(id : String) : Bool","location":{"filename":"src/mocopo/cancellation.cr","line_number":111,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L111"},"def":{"name":"remove_token","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"if @tokens.has_key?(id)\nelse\n  return false\nend\n\n\n@tokens.delete(id)\n\n\ntrue\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/CancellationToken","path":"MocoPo/CancellationToken.html","kind":"class","full_name":"MocoPo::CancellationToken","name":"CancellationToken","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/cancellation.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Cancellation token class","summary":"<p>Cancellation token class</p>","constructors":[{"html_id":"new(id:String)-class-method","name":"new","doc":"Initialize a new cancellation token","summary":"<p>Initialize a new cancellation token</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String)","args_html":"(id : String)","location":{"filename":"src/mocopo/cancellation.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L16"},"def":{"name":"new","args":[{"name":"id","external_name":"id","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(id)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"cancel(reason:String|Nil=nil)-instance-method","name":"cancel","doc":"Cancel the token","summary":"<p>Cancel the token</p>","abstract":false,"args":[{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"args_string":"(reason : String | Nil = nil)","args_html":"(reason : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/cancellation.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L22"},"def":{"name":"cancel","args":[{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"visibility":"Public","body":"@cancelled = true\n@reason = reason\n"},"external_var":false},{"html_id":"cancelled:Bool-instance-method","name":"cancelled","doc":"Cancellation status","summary":"<p>Cancellation status</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L10"},"def":{"name":"cancelled","return_type":"Bool","visibility":"Public","body":"@cancelled"},"external_var":false},{"html_id":"cancelled?:Bool-instance-method","name":"cancelled?","doc":"Check if the token is cancelled","summary":"<p>Check if the token is cancelled</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":28,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L28"},"def":{"name":"cancelled?","visibility":"Public","body":"@cancelled"},"external_var":false},{"html_id":"id:String-instance-method","name":"id","doc":"Token ID","summary":"<p>Token ID</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":7,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L7"},"def":{"name":"id","return_type":"String","visibility":"Public","body":"@id"},"external_var":false},{"html_id":"reason:String|Nil-instance-method","name":"reason","doc":"Cancellation reason","summary":"<p>Cancellation reason</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":13,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L13"},"def":{"name":"reason","return_type":"String | ::Nil","visibility":"Public","body":"@reason"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":33,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L33"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"id\" => @id, \"cancelled\" => @cancelled} of String => JsonValue\n\n\nif reason = @reason\n  result[\"reason\"] = reason\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Completion","path":"MocoPo/Completion.html","kind":"module","full_name":"MocoPo::Completion","name":"Completion","abstract":false,"locations":[{"filename":"src/mocopo/completion.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"MAX_COMPLETION_VALUES","name":"MAX_COMPLETION_VALUES","value":"100","doc":"Maximum number of completion values to return","summary":"<p>Maximum number of completion values to return</p>"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Completion utilities for MCP","summary":"<p>Completion utilities for MCP</p>","class_methods":[{"html_id":"complete(ref:Reference,arg:Argument,server:Server):Result-class-method","name":"complete","doc":"Complete an argument value","summary":"<p>Complete an argument value</p>","abstract":false,"args":[{"name":"ref","external_name":"ref","restriction":"Reference"},{"name":"arg","external_name":"arg","restriction":"Argument"},{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(ref : Reference, arg : Argument, server : Server) : Result","args_html":"(ref : <a href=\"../MocoPo/Completion/Reference.html\">Reference</a>, arg : <a href=\"../MocoPo/Completion/Argument.html\">Argument</a>, server : <a href=\"../MocoPo/Server.html\">Server</a>) : <a href=\"../MocoPo/Completion/Result.html\">Result</a>","location":{"filename":"src/mocopo/completion.cr","line_number":109,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L109"},"def":{"name":"complete","args":[{"name":"ref","external_name":"ref","restriction":"Reference"},{"name":"arg","external_name":"arg","restriction":"Argument"},{"name":"server","external_name":"server","restriction":"Server"}],"return_type":"Result","visibility":"Public","body":"case ref.type\nwhen ReferenceType::Prompt\n  complete_prompt_argument(ref.identifier, arg, server)\nwhen ReferenceType::Resource\n  complete_resource_argument(ref.identifier, arg, server)\nelse\n  Result.new([] of String)\nend"},"external_var":false}],"types":[{"html_id":"mocopo/MocoPo/Completion/Argument","path":"MocoPo/Completion/Argument.html","kind":"class","full_name":"MocoPo::Completion::Argument","name":"Argument","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/completion.cr","line_number":53,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L53"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo/Completion","kind":"module","full_name":"MocoPo::Completion","name":"Completion"},"doc":"Argument for completion","summary":"<p>Argument for completion</p>","class_methods":[{"html_id":"from_json(json:Hash(String,JsonValue)):Argument|Nil-class-method","name":"from_json","doc":"Create an argument from a JSON object","summary":"<p>Create an argument from a JSON object</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"Hash(String, JsonValue)"}],"args_string":"(json : Hash(String, JsonValue)) : Argument | Nil","args_html":"(json : Hash(String, <a href=\"../../MocoPo/JsonValue.html\">JsonValue</a>)) : <a href=\"../../MocoPo/Completion/Argument.html\">Argument</a> | Nil","location":{"filename":"src/mocopo/completion.cr","line_number":65,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L65"},"def":{"name":"from_json","args":[{"name":"json","external_name":"json","restriction":"Hash(String, JsonValue)"}],"return_type":"Argument | ::Nil","visibility":"Public","body":"json_str = json.to_json\n\n\nparsed = JSON.parse(json_str)\n\n\nname = parsed[\"name\"]?.try(&.as_s)\nvalue = parsed[\"value\"]?.try(&.as_s)\nif name && value\nelse\n  return nil\nend\nnew(name, value)\n"},"external_var":false}],"constructors":[{"html_id":"new(name:String,value:String)-class-method","name":"new","doc":"Initialize a new argument","summary":"<p>Initialize a new argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"}],"args_string":"(name : String, value : String)","args_html":"(name : String, value : String)","location":{"filename":"src/mocopo/completion.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L61"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"value","external_name":"value","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, value)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"name:String-instance-method","name":"name","doc":"Argument name","summary":"<p>Argument name</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":55,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L55"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"value:String-instance-method","name":"value","doc":"Current value","summary":"<p>Current value</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":58,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L58"},"def":{"name":"value","return_type":"String","visibility":"Public","body":"@value"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Completion/Reference","path":"MocoPo/Completion/Reference.html","kind":"class","full_name":"MocoPo::Completion::Reference","name":"Reference","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/completion.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L14"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo/Completion","kind":"module","full_name":"MocoPo::Completion","name":"Completion"},"doc":"Reference for completion","summary":"<p>Reference for completion</p>","class_methods":[{"html_id":"from_json(json:Hash(String,JsonValue)):Reference|Nil-class-method","name":"from_json","doc":"Create a reference from a JSON object","summary":"<p>Create a reference from a JSON object</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"Hash(String, JsonValue)"}],"args_string":"(json : Hash(String, JsonValue)) : Reference | Nil","args_html":"(json : Hash(String, <a href=\"../../MocoPo/JsonValue.html\">JsonValue</a>)) : <a href=\"../../MocoPo/Completion/Reference.html\">Reference</a> | Nil","location":{"filename":"src/mocopo/completion.cr","line_number":26,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L26"},"def":{"name":"from_json","args":[{"name":"json","external_name":"json","restriction":"Hash(String, JsonValue)"}],"return_type":"Reference | ::Nil","visibility":"Public","body":"json_str = json.to_json\n\n\nparsed = JSON.parse(json_str)\n\n\ntype_str = parsed[\"type\"]?.try(&.as_s)\nif type_str\nelse\n  return nil\nend\n\ncase type_str\nwhen \"ref/prompt\"\n  name = parsed[\"name\"]?.try(&.as_s)\n  if name\n  else\n    return nil\n  end\n  new(ReferenceType::Prompt, name)\nwhen \"ref/resource\"\n  uri = parsed[\"uri\"]?.try(&.as_s)\n  if uri\n  else\n    return nil\n  end\n  new(ReferenceType::Resource, uri)\nelse\n  nil\nend\n"},"external_var":false}],"constructors":[{"html_id":"new(type:ReferenceType,identifier:String)-class-method","name":"new","doc":"Initialize a new reference","summary":"<p>Initialize a new reference</p>","abstract":false,"args":[{"name":"type","external_name":"type","restriction":"ReferenceType"},{"name":"identifier","external_name":"identifier","restriction":"String"}],"args_string":"(type : ReferenceType, identifier : String)","args_html":"(type : <a href=\"../../MocoPo/Completion/ReferenceType.html\">ReferenceType</a>, identifier : String)","location":{"filename":"src/mocopo/completion.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L22"},"def":{"name":"new","args":[{"name":"type","external_name":"type","restriction":"ReferenceType"},{"name":"identifier","external_name":"identifier","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(type, identifier)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"identifier:String-instance-method","name":"identifier","doc":"Reference name or URI","summary":"<p>Reference name or URI</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":19,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L19"},"def":{"name":"identifier","return_type":"String","visibility":"Public","body":"@identifier"},"external_var":false},{"html_id":"type:ReferenceType-instance-method","name":"type","doc":"Reference type","summary":"<p>Reference type</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L16"},"def":{"name":"type","return_type":"ReferenceType","visibility":"Public","body":"@type"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Completion/ReferenceType","path":"MocoPo/Completion/ReferenceType.html","kind":"enum","full_name":"MocoPo::Completion::ReferenceType","name":"ReferenceType","abstract":false,"ancestors":[{"html_id":"mocopo/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"mocopo/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"mocopo/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/completion.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L8"}],"repository_name":"mocopo","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Prompt","name":"Prompt","value":"0"},{"id":"Resource","name":"Resource","value":"1"}],"namespace":{"html_id":"mocopo/MocoPo/Completion","kind":"module","full_name":"MocoPo::Completion","name":"Completion"},"doc":"Reference types for completion","summary":"<p>Reference types for completion</p>","instance_methods":[{"html_id":"prompt?-instance-method","name":"prompt?","doc":"Returns `true` if this enum value equals `Prompt`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../MocoPo/Completion/ReferenceType.html#Prompt\">Prompt</a></code></p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":9,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L9"},"def":{"name":"prompt?","visibility":"Public","body":"self == Prompt"},"external_var":false},{"html_id":"resource?-instance-method","name":"resource?","doc":"Returns `true` if this enum value equals `Resource`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../../MocoPo/Completion/ReferenceType.html#Resource\">Resource</a></code></p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L10"},"def":{"name":"resource?","visibility":"Public","body":"self == Resource"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Completion/Result","path":"MocoPo/Completion/Result.html","kind":"class","full_name":"MocoPo::Completion::Result","name":"Result","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/completion.cr","line_number":81,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L81"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo/Completion","kind":"module","full_name":"MocoPo::Completion","name":"Completion"},"doc":"Completion result","summary":"<p>Completion result</p>","constructors":[{"html_id":"new(values:Array(String),total:Int32|Nil=nil,has_more:Bool=false)-class-method","name":"new","doc":"Initialize a new completion result","summary":"<p>Initialize a new completion result</p>","abstract":false,"args":[{"name":"values","external_name":"values","restriction":"Array(String)"},{"name":"total","default_value":"nil","external_name":"total","restriction":"Int32 | ::Nil"},{"name":"has_more","default_value":"false","external_name":"has_more","restriction":"Bool"}],"args_string":"(values : Array(String), total : Int32 | Nil = nil, has_more : Bool = false)","args_html":"(values : Array(String), total : Int32 | Nil = <span class=\"n\">nil</span>, has_more : Bool = <span class=\"n\">false</span>)","location":{"filename":"src/mocopo/completion.cr","line_number":92,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L92"},"def":{"name":"new","args":[{"name":"values","external_name":"values","restriction":"Array(String)"},{"name":"total","default_value":"nil","external_name":"total","restriction":"Int32 | ::Nil"},{"name":"has_more","default_value":"false","external_name":"has_more","restriction":"Bool"}],"visibility":"Public","body":"_ = allocate\n_.initialize(values, total, has_more)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"has_more:Bool-instance-method","name":"has_more","doc":"Whether there are more results","summary":"<p>Whether there are more results</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":89,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L89"},"def":{"name":"has_more","return_type":"Bool","visibility":"Public","body":"@has_more"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L96"},"def":{"name":"to_json_object","visibility":"Public","body":"result = {\"values\" => @values, \"hasMore\" => @has_more} of String => Array(String) | Int32 | Bool | Nil\n\nif @total\n  result[\"total\"] = @total\nend\n\nresult\n"},"external_var":false},{"html_id":"total:Int32|Nil-instance-method","name":"total","doc":"Total number of matches","summary":"<p>Total number of matches</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":86,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L86"},"def":{"name":"total","return_type":"Int32 | ::Nil","visibility":"Public","body":"@total"},"external_var":false},{"html_id":"values:Array(String)-instance-method","name":"values","doc":"Completion values","summary":"<p>Completion values</p>","abstract":false,"location":{"filename":"src/mocopo/completion.cr","line_number":83,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/completion.cr#L83"},"def":{"name":"values","return_type":"Array(String)","visibility":"Public","body":"@values"},"external_var":false}]}]},{"html_id":"mocopo/MocoPo/CompletionHandler","path":"MocoPo/CompletionHandler.html","kind":"class","full_name":"MocoPo::CompletionHandler","name":"CompletionHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/completion_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/completion_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"RATE_LIMIT_MAX_CALLS","name":"RATE_LIMIT_MAX_CALLS","value":"10"},{"id":"RATE_LIMIT_WINDOW","name":"RATE_LIMIT_WINDOW","value":"5","doc":"Rate limit settings","summary":"<p>Rate limit settings</p>"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for completion methods","summary":"<p>Handler for completion methods</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new completion handler","summary":"<p>Initialize a new completion handler</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/handlers/completion_handler.cr","line_number":12,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/completion_handler.cr#L12"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/completion_handler.cr","line_number":68,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/completion_handler.cr#L68"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"CompletionHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_complete(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_complete","doc":"Handle completion/complete request","summary":"<p>Handle completion/complete request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/completion_handler.cr","line_number":18,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/completion_handler.cr#L18"},"def":{"name":"handle_complete","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"ref_json = get_hash_param(params, \"ref\")\narg_json = get_hash_param(params, \"argument\")\n\n\nif ref_json && arg_json\nelse\n  return error_response(-32602, \"Missing required parameters: ref and argument\", id)\nend\n\n\nref = Completion::Reference.from_json(ref_json)\nif ref\nelse\n  return error_response(-32602, \"Invalid reference\", id)\nend\n\n\narg = Completion::Argument.from_json(arg_json)\nif arg\nelse\n  return error_response(-32602, \"Invalid argument\", id)\nend\n\n\nrequest_id = id.to_s\nclient_id = \"client-#{Random.new.hex(4)}\"\ncontext = Context.new(request_id, client_id, @server)\n\n\nif exceeds_rate_limit?(client_id)\n  return error_response(-32603, \"Rate limit exceeded\", id)\nend\n\n\nresult = Completion.complete(ref, arg, @server)\n\n\nresponse = {} of String => JsonValue\n\n\nresult_json = result.to_json_object\nresult_json_str = result_json.to_json\nresult_json_value = JSON.parse(result_json_str)\n\nresponse[\"completion\"] = Utils.to_json_value(result_json_value)\n\n\nsuccess_response(id, response)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ContentType","path":"MocoPo/ContentType.html","kind":"enum","full_name":"MocoPo::ContentType","name":"ContentType","abstract":false,"ancestors":[{"html_id":"mocopo/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"mocopo/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"mocopo/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":9,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L9"}],"repository_name":"mocopo","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"Text","name":"Text","value":"0"},{"id":"Image","name":"Image","value":"1"},{"id":"Audio","name":"Audio","value":"2"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Content type for messages","summary":"<p>Content type for messages</p>","instance_methods":[{"html_id":"audio?-instance-method","name":"audio?","doc":"Returns `true` if this enum value equals `Audio`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../MocoPo/ContentType.html#Audio\">Audio</a></code></p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":12,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L12"},"def":{"name":"audio?","visibility":"Public","body":"self == Audio"},"external_var":false},{"html_id":"image?-instance-method","name":"image?","doc":"Returns `true` if this enum value equals `Image`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../MocoPo/ContentType.html#Image\">Image</a></code></p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L11"},"def":{"name":"image?","visibility":"Public","body":"self == Image"},"external_var":false},{"html_id":"text?-instance-method","name":"text?","doc":"Returns `true` if this enum value equals `Text`","summary":"<p>Returns <code>true</code> if this enum value equals <code><a href=\"../MocoPo/ContentType.html#Text\">Text</a></code></p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L10"},"def":{"name":"text?","visibility":"Public","body":"self == Text"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Context","path":"MocoPo/Context.html","kind":"class","full_name":"MocoPo::Context","name":"Context","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/context.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Context for tool and resource execution","summary":"<p>Context for tool and resource execution</p>","constructors":[{"html_id":"new(request_id:String,client_id:String,server:Server)-class-method","name":"new","doc":"Initialize a new context","summary":"<p>Initialize a new context</p>","abstract":false,"args":[{"name":"request_id","external_name":"request_id","restriction":"String"},{"name":"client_id","external_name":"client_id","restriction":"String"},{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(request_id : String, client_id : String, server : Server)","args_html":"(request_id : String, client_id : String, server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/context.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L14"},"def":{"name":"new","args":[{"name":"request_id","external_name":"request_id","restriction":"String"},{"name":"client_id","external_name":"client_id","restriction":"String"},{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(request_id, client_id, server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"client_id:String-instance-method","name":"client_id","doc":"Client ID","summary":"<p>Client ID</p>","abstract":false,"location":{"filename":"src/mocopo/context.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L8"},"def":{"name":"client_id","return_type":"String","visibility":"Public","body":"@client_id"},"external_var":false},{"html_id":"debug(message:String)-instance-method","name":"debug","doc":"Log a debug message","summary":"<p>Log a debug message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(message : String)","args_html":"(message : String)","location":{"filename":"src/mocopo/context.cr","line_number":18,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L18"},"def":{"name":"debug","args":[{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"send_log_notification(\"debug\", message)"},"external_var":false},{"html_id":"error(message:String)-instance-method","name":"error","doc":"Log an error message","summary":"<p>Log an error message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(message : String)","args_html":"(message : String)","location":{"filename":"src/mocopo/context.cr","line_number":33,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L33"},"def":{"name":"error","args":[{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"send_log_notification(\"error\", message)"},"external_var":false},{"html_id":"info(message:String)-instance-method","name":"info","doc":"Log an info message","summary":"<p>Log an info message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(message : String)","args_html":"(message : String)","location":{"filename":"src/mocopo/context.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L23"},"def":{"name":"info","args":[{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"send_log_notification(\"info\", message)"},"external_var":false},{"html_id":"read_resource(uri:String):Array(ResourceContent)-instance-method","name":"read_resource","doc":"Read a resource","summary":"<p>Read a resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String) : Array(ResourceContent)","args_html":"(uri : String) : Array(<a href=\"../MocoPo/ResourceContent.html\">ResourceContent</a>)","location":{"filename":"src/mocopo/context.cr","line_number":57,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L57"},"def":{"name":"read_resource","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"return_type":"Array(ResourceContent)","visibility":"Public","body":"if @server.resource_manager.exists?(uri)\n  resource = (@server.resource_manager.get(uri)).not_nil!\n  [resource.get_content(self)]\nelse\n  [] of ResourceContent\nend"},"external_var":false},{"html_id":"report_progress(current:Int32|Float64,total:Int32|Float64,message:String|Nil=nil)-instance-method","name":"report_progress","doc":"Report progress","summary":"<p>Report progress</p>","abstract":false,"args":[{"name":"current","external_name":"current","restriction":"Int32 | Float64"},{"name":"total","external_name":"total","restriction":"Int32 | Float64"},{"name":"message","default_value":"nil","external_name":"message","restriction":"String | ::Nil"}],"args_string":"(current : Int32 | Float64, total : Int32 | Float64, message : String | Nil = nil)","args_html":"(current : Int32 | Float64, total : Int32 | Float64, message : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/context.cr","line_number":38,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L38"},"def":{"name":"report_progress","args":[{"name":"current","external_name":"current","restriction":"Int32 | Float64"},{"name":"total","external_name":"total","restriction":"Int32 | Float64"},{"name":"message","default_value":"nil","external_name":"message","restriction":"String | ::Nil"}],"visibility":"Public","body":"params = {} of String => JsonValue\nparams[\"progressToken\"] = @request_id\nparams[\"progress\"] = current\nparams[\"total\"] = total\nif message\n  params[\"message\"] = message\nend\n\n\nnotification = {} of String => JsonValue\nnotification[\"jsonrpc\"] = \"2.0\"\nnotification[\"method\"] = \"notifications/progress\"\nnotification[\"params\"] = params\n\n\nsend_notification(notification)\n"},"external_var":false},{"html_id":"request_id:String-instance-method","name":"request_id","doc":"Request ID","summary":"<p>Request ID</p>","abstract":false,"location":{"filename":"src/mocopo/context.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L5"},"def":{"name":"request_id","return_type":"String","visibility":"Public","body":"@request_id"},"external_var":false},{"html_id":"warning(message:String)-instance-method","name":"warning","doc":"Log a warning message","summary":"<p>Log a warning message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(message : String)","args_html":"(message : String)","location":{"filename":"src/mocopo/context.cr","line_number":28,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/context.cr#L28"},"def":{"name":"warning","args":[{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"send_log_notification(\"warning\", message)"},"external_var":false}]},{"html_id":"mocopo/MocoPo/GreedySamplingMethod","path":"MocoPo/GreedySamplingMethod.html","kind":"class","full_name":"MocoPo::GreedySamplingMethod","name":"GreedySamplingMethod","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},"ancestors":[{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":490,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L490"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Greedy sampling method","summary":"<p>Greedy sampling method</p>","constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":491,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L491"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"parameters_schema:JsonObject-instance-method","name":"parameters_schema","doc":"Return the parameters schema","summary":"<p>Return the parameters schema</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":495,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L495"},"def":{"name":"parameters_schema","return_type":"JsonObject","visibility":"Public","body":"{\"type\" => \"object\", \"properties\" => {} of String => JsonValue, \"required\" => [] of JsonValue} of String => JsonValue"},"external_var":false},{"html_id":"sample(text:String,params:JsonObject|Nil,context:Context):JsonObject-instance-method","name":"sample","doc":"Execute sampling","summary":"<p>Execute sampling</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(text : String, params : JsonObject | Nil, context : Context) : JsonObject","args_html":"(text : String, params : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":503,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L503"},"def":{"name":"sample","args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"JsonObject","visibility":"Public","body":"{\"text\" => \"Sampling result: #{text}\"} of String => JsonValue"},"external_var":false}]},{"html_id":"mocopo/MocoPo/HandlerManager","path":"MocoPo/HandlerManager.html","kind":"class","full_name":"MocoPo::HandlerManager","name":"HandlerManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Manages handlers for JSON-RPC methods","summary":"<p>Manages handlers for JSON-RPC methods</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new handler manager","summary":"<p>Initialize a new handler manager</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L14"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"handle_request(method:String,id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_request","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(method : String, id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(method : String, id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":79,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L79"},"def":{"name":"handle_request","args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"if @method_mappings.has_key?(method)\n  handler, method_symbol = @method_mappings[method]\n\n\n  if method_symbol == (:handle)\n    handler.handle(id, params)\n  else\n    case method_symbol\n    when :handle_list\n      if handler.is_a?(ToolsHandler)\n        handler.handle_list(id, params)\n      else\n        if handler.is_a?(ResourcesHandler)\n          handler.handle_list(id, params)\n        else\n          if handler.is_a?(PromptsHandler)\n            handler.handle_list(id, params)\n          else\n            if handler.is_a?(SamplingHandler)\n              handler.handle_list(id, params)\n            else\n              if handler.is_a?(RootsHandler)\n                handler.handle_list(id, params)\n              else\n                if handler.is_a?(CancellationHandler)\n                  handler.handle_list(id, params)\n                else\n                  handler.handle(id, params)\n                end\n              end\n            end\n          end\n        end\n      end\n    when :handle_call\n      if handler.responds_to?(:handle_call)\n        (handler.as(ToolsHandler)).handle_call(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_read\n      if handler.responds_to?(:handle_read)\n        (handler.as(ResourcesHandler)).handle_read(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_subscribe\n      if handler.responds_to?(:handle_subscribe)\n        (handler.as(ResourcesHandler)).handle_subscribe(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_get\n      if handler.responds_to?(:handle_get)\n        (handler.as(PromptsHandler)).handle_get(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_sample\n      if handler.responds_to?(:handle_sample)\n        (handler.as(SamplingHandler)).handle_sample(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_create_message\n      if handler.responds_to?(:handle_create_message)\n        (handler.as(SamplingHandler)).handle_create_message(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_list_directory\n      if handler.responds_to?(:handle_list_directory)\n        (handler.as(RootsHandler)).handle_list_directory(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_read_file\n      if handler.responds_to?(:handle_read_file)\n        (handler.as(RootsHandler)).handle_read_file(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_write_file\n      if handler.responds_to?(:handle_write_file)\n        (handler.as(RootsHandler)).handle_write_file(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_delete_file\n      if handler.responds_to?(:handle_delete_file)\n        (handler.as(RootsHandler)).handle_delete_file(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_create_directory\n      if handler.responds_to?(:handle_create_directory)\n        (handler.as(RootsHandler)).handle_create_directory(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_delete_directory\n      if handler.responds_to?(:handle_delete_directory)\n        (handler.as(RootsHandler)).handle_delete_directory(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_create\n      if handler.responds_to?(:handle_create)\n        (handler.as(CancellationHandler)).handle_create(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_cancel\n      if handler.responds_to?(:handle_cancel)\n        (handler.as(CancellationHandler)).handle_cancel(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_status\n      if handler.responds_to?(:handle_status)\n        (handler.as(CancellationHandler)).handle_status(id, params)\n      else\n        handler.handle(id, params)\n      end\n    when :handle_complete\n      if handler.responds_to?(:handle_complete)\n        (handler.as(CompletionHandler)).handle_complete(id, params)\n      else\n        handler.handle(id, params)\n      end\n    else\n      handler.handle(id, params)\n    end\n  end\nelse\n  (JsonRpcErrorResponse.new(JsonRpcError.new(-32601, \"Method not found: #{method}\"), id)).to_json_object\nend"},"external_var":false},{"html_id":"register_handler(name:String,handler:BaseHandler)-instance-method","name":"register_handler","doc":"Register a handler","summary":"<p>Register a handler</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"handler","external_name":"handler","restriction":"BaseHandler"}],"args_string":"(name : String, handler : BaseHandler)","args_html":"(name : String, handler : <a href=\"../MocoPo/BaseHandler.html\">BaseHandler</a>)","location":{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":69,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L69"},"def":{"name":"register_handler","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"handler","external_name":"handler","restriction":"BaseHandler"}],"visibility":"Public","body":"@handlers[name] = handler"},"external_var":false},{"html_id":"register_method(method:String,handler:BaseHandler,handler_method:Symbol)-instance-method","name":"register_method","doc":"Register a method mapping","summary":"<p>Register a method mapping</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"handler","external_name":"handler","restriction":"BaseHandler"},{"name":"handler_method","external_name":"handler_method","restriction":"Symbol"}],"args_string":"(method : String, handler : BaseHandler, handler_method : Symbol)","args_html":"(method : String, handler : <a href=\"../MocoPo/BaseHandler.html\">BaseHandler</a>, handler_method : Symbol)","location":{"filename":"src/mocopo/handlers/handler_manager.cr","line_number":74,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/handler_manager.cr#L74"},"def":{"name":"register_method","args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"handler","external_name":"handler","restriction":"BaseHandler"},{"name":"handler_method","external_name":"handler_method","restriction":"Symbol"}],"visibility":"Public","body":"@method_mappings[method] = {handler, handler_method}"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Handlers","path":"MocoPo/Handlers.html","kind":"module","full_name":"MocoPo::Handlers","name":"Handlers","abstract":false,"locations":[{"filename":"src/mocopo/handlers.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers.cr#L14"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handlers module","summary":"<p>Handlers module</p>"},{"html_id":"mocopo/MocoPo/HttpTransport","path":"MocoPo/HttpTransport.html","kind":"class","full_name":"MocoPo::HttpTransport","name":"HttpTransport","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},"ancestors":[{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/transports/http_transport.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L8"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"HTTP transport implementation for MCP","summary":"<p>HTTP transport implementation for MCP</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new HTTP transport","summary":"<p>Initialize a new HTTP transport</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/transports/http_transport.cr","line_number":13,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L13"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close:Nil-instance-method","name":"close","doc":"Close the transport","summary":"<p>Close the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/http_transport.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L61"},"def":{"name":"close","return_type":"Nil","visibility":"Public","body":"Kemal.stop\nhandle_close\n"},"external_var":false},{"html_id":"send(message:JsonObject):Nil-instance-method","name":"send","doc":"Send a JSON-RPC message","summary":"<p>Send a JSON-RPC message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"args_string":"(message : JsonObject) : Nil","args_html":"(message : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : Nil","location":{"filename":"src/mocopo/transports/http_transport.cr","line_number":53,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L53"},"def":{"name":"send","args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"return_type":"Nil","visibility":"Public","body":"puts(\"Sending message: #{message.to_json}\")"},"external_var":false},{"html_id":"start:Nil-instance-method","name":"start","doc":"Start the transport","summary":"<p>Start the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/http_transport.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/http_transport.cr#L17"},"def":{"name":"start","return_type":"Nil","visibility":"Public","body":"post(\"/mcp\") do |env|\n  begin\n    request_body = env.request.body.try(&.gets_to_end)\n    if request_body\n    else\n      next (error_response(400, \"Missing request body\")).to_json\n    end\n\n\n    json = JSON.parse(request_body)\n\n\n    json_object = {} of String => JsonValue\n    json.as_h.each do |k, v|\n      json_object[k.to_s] = Utils.to_json_value(v)\n    end\n\n\n    handle_message(json_object)\n\n\n    env.response.content_type = \"application/json\"\n    response = process_jsonrpc(json_object)\n    response.to_json\n  rescue ex : JSON::ParseException\n    env.response.status_code = 400\n    next (error_response(-32700, \"Parse error: #{ex.message}\")).to_json\n  rescue ex\n    env.response.status_code = 500\n    handle_error(ex)\n    next (error_response(-32603, \"Internal error: #{ex.message}\")).to_json\n  end\nend"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ImageContent","path":"MocoPo/ImageContent.html","kind":"class","full_name":"MocoPo::ImageContent","name":"ImageContent","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},"ancestors":[{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":27,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L27"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Image content for messages","summary":"<p>Image content for messages</p>","constructors":[{"html_id":"new(data:String,mime_type:String)-class-method","name":"new","doc":"Initialize a new image content","summary":"<p>Initialize a new image content</p>","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"args_string":"(data : String, mime_type : String)","args_html":"(data : String, mime_type : String)","location":{"filename":"src/mocopo/prompts.cr","line_number":35,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L35"},"def":{"name":"new","args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(data, mime_type)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"data:String-instance-method","name":"data","doc":"Base64 encoded image data","summary":"<p>Base64 encoded image data</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":29,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L29"},"def":{"name":"data","return_type":"String","visibility":"Public","body":"@data"},"external_var":false},{"html_id":"mime_type:String-instance-method","name":"mime_type","doc":"MIME type of the image","summary":"<p>MIME type of the image</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":32,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L32"},"def":{"name":"mime_type","return_type":"String","visibility":"Public","body":"@mime_type"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":39,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L39"},"def":{"name":"to_json_object","visibility":"Public","body":"{\"type\" => \"image\", \"data\" => @data, \"mimeType\" => @mime_type} of String => String | Hash(String, String | Nil)"},"external_var":false}]},{"html_id":"mocopo/MocoPo/InitializeHandler","path":"MocoPo/InitializeHandler.html","kind":"class","full_name":"MocoPo::InitializeHandler","name":"InitializeHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/initialize_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/initialize_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for initialize method","summary":"<p>Handler for initialize method</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle initialize request","summary":"<p>Handle initialize request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/initialize_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/initialize_handler.cr#L5"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"client_protocol_version = (get_string_param(params, \"protocolVersion\")) || \"unknown\"\n\n\nif client_protocol_version != PROTOCOL_VERSION\nend\n\n\nresult = {\"protocolVersion\" => PROTOCOL_VERSION, \"capabilities\" => {\"resources\" => {\"listChanged\" => true}, \"tools\" => {\"listChanged\" => true}, \"prompts\" => {\"listChanged\" => true}, \"sampling\" => {} of String => Bool, \"logging\" => {} of String => Bool}, \"serverInfo\" => {\"name\" => @server.name, \"version\" => @server.version}}\n\n\nsafe_success_response(id, result)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonArray","path":"MocoPo/JsonArray.html","kind":"alias","full_name":"MocoPo::JsonArray","name":"JsonArray","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L14"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"Array(MocoPo::JsonValue)","aliased_html":"Array(<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>)","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON array type","summary":"<p>JSON array type</p>"},{"html_id":"mocopo/MocoPo/JsonObject","path":"MocoPo/JsonObject.html","kind":"alias","full_name":"MocoPo::JsonObject","name":"JsonObject","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L11"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"Hash(String, MocoPo::JsonValue)","aliased_html":"Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>)","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON object type","summary":"<p>JSON object type</p>"},{"html_id":"mocopo/MocoPo/JsonPrimitive","path":"MocoPo/JsonPrimitive.html","kind":"alias","full_name":"MocoPo::JsonPrimitive","name":"JsonPrimitive","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Bool | Float64 | Int32 | String | Nil)","aliased_html":"Bool | Float64 | Int32 | String | Nil","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Basic JSON value types","summary":"<p>Basic JSON value types</p>"},{"html_id":"mocopo/MocoPo/JsonRpcError","path":"MocoPo/JsonRpcError.html","kind":"class","full_name":"MocoPo::JsonRpcError","name":"JsonRpcError","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":46,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L46"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC error object","summary":"<p>JSON-RPC error object</p>","constructors":[{"html_id":"new(code:Int32,message:String,data:Array(MocoPo::JsonValue)|Bool|Float64|Hash(String,MocoPo::JsonValue)|Int32|String|Nil=nil)-class-method","name":"new","doc":"Initialize a new JSON-RPC error","summary":"<p>Initialize a new JSON-RPC error</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"::Int32"},{"name":"message","external_name":"message","restriction":"::String"},{"name":"data","default_value":"nil","external_name":"data","restriction":"::Array(::MocoPo::JsonValue) | ::Bool | ::Float64 | ::Hash(::String, ::MocoPo::JsonValue) | ::Int32 | ::String | ::Nil"}],"args_string":"(code : Int32, message : String, data : Array(MocoPo::JsonValue) | Bool | Float64 | Hash(String, MocoPo::JsonValue) | Int32 | String | Nil = nil)","args_html":"(code : Int32, message : String, data : Array(<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Bool | Float64 | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Int32 | String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":57,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L57"},"def":{"name":"new","args":[{"name":"code","external_name":"code","restriction":"::Int32"},{"name":"message","external_name":"message","restriction":"::String"},{"name":"data","default_value":"nil","external_name":"data","restriction":"::Array(::MocoPo::JsonValue) | ::Bool | ::Float64 | ::Hash(::String, ::MocoPo::JsonValue) | ::Int32 | ::String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(code, message, data)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"code:Int32-instance-method","name":"code","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L48"},"def":{"name":"code","return_type":"Int32","visibility":"Public","body":"@code"},"external_var":false},{"html_id":"code=(code:Int32)-instance-method","name":"code=","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"Int32"}],"args_string":"(code : Int32)","args_html":"(code : Int32)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L48"},"def":{"name":"code=","args":[{"name":"code","external_name":"code","restriction":"Int32"}],"visibility":"Public","body":"@code = code"},"external_var":false},{"html_id":"data:JsonRpcErrorData-instance-method","name":"data","doc":"Additional error data","summary":"<p>Additional error data</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":54,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L54"},"def":{"name":"data","return_type":"JsonRpcErrorData","visibility":"Public","body":"@data"},"external_var":false},{"html_id":"data=(data:JsonRpcErrorData)-instance-method","name":"data=","doc":"Additional error data","summary":"<p>Additional error data</p>","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"JsonRpcErrorData"}],"args_string":"(data : JsonRpcErrorData)","args_html":"(data : <a href=\"../MocoPo/JsonRpcErrorData.html\">JsonRpcErrorData</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":54,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L54"},"def":{"name":"data=","args":[{"name":"data","external_name":"data","restriction":"JsonRpcErrorData"}],"visibility":"Public","body":"@data = data"},"external_var":false},{"html_id":"message:String-instance-method","name":"message","doc":"Error message","summary":"<p>Error message</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":51,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L51"},"def":{"name":"message","return_type":"String","visibility":"Public","body":"@message"},"external_var":false},{"html_id":"message=(message:String)-instance-method","name":"message=","doc":"Error message","summary":"<p>Error message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(message : String)","args_html":"(message : String)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":51,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L51"},"def":{"name":"message=","args":[{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"@message = message"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L61"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"code\" => @code, \"message\" => @message} of String => JsonValue\n\nif @data\n  result[\"data\"] = @data\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcErrorData","path":"MocoPo/JsonRpcErrorData.html","kind":"alias","full_name":"MocoPo::JsonRpcErrorData","name":"JsonRpcErrorData","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":29,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L29"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Array(MocoPo::JsonValue) | Bool | Float64 | Hash(String, MocoPo::JsonValue) | Int32 | String | Nil)","aliased_html":"Array(<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Bool | Float64 | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Int32 | String | Nil","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC error data type","summary":"<p>JSON-RPC error data type</p>"},{"html_id":"mocopo/MocoPo/JsonRpcErrorResponse","path":"MocoPo/JsonRpcErrorResponse.html","kind":"class","full_name":"MocoPo::JsonRpcErrorResponse","name":"JsonRpcErrorResponse","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/JsonRpcResponse","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse"},"ancestors":[{"html_id":"mocopo/MocoPo/JsonRpcResponse","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse"},{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":74,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L74"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC error response","summary":"<p>JSON-RPC error response</p>","constructors":[{"html_id":"new(error:MocoPo::JsonRpcError,id:JsonRpcId=nil)-class-method","name":"new","doc":"Initialize a new error response","summary":"<p>Initialize a new error response</p>","abstract":false,"args":[{"name":"error","external_name":"error","restriction":"::MocoPo::JsonRpcError"},{"name":"id","default_value":"nil","external_name":"id","restriction":"JsonRpcId"}],"args_string":"(error : MocoPo::JsonRpcError, id : JsonRpcId = nil)","args_html":"(error : <a href=\"../MocoPo/JsonRpcError.html\">MocoPo::JsonRpcError</a>, id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a> = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":79,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L79"},"def":{"name":"new","args":[{"name":"error","external_name":"error","restriction":"::MocoPo::JsonRpcError"},{"name":"id","default_value":"nil","external_name":"id","restriction":"JsonRpcId"}],"visibility":"Public","body":"_ = allocate\n_.initialize(error, id)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"error:JsonRpcError-instance-method","name":"error","doc":"Error object","summary":"<p>Error object</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":76,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L76"},"def":{"name":"error","return_type":"JsonRpcError","visibility":"Public","body":"@error"},"external_var":false},{"html_id":"error=(error:JsonRpcError)-instance-method","name":"error=","doc":"Error object","summary":"<p>Error object</p>","abstract":false,"args":[{"name":"error","external_name":"error","restriction":"JsonRpcError"}],"args_string":"(error : JsonRpcError)","args_html":"(error : <a href=\"../MocoPo/JsonRpcError.html\">JsonRpcError</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":76,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L76"},"def":{"name":"error=","args":[{"name":"error","external_name":"error","restriction":"JsonRpcError"}],"visibility":"Public","body":"@error = error"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":84,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L84"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"jsonrpc\" => @jsonrpc, \"id\" => @id, \"error\" => @error.to_json_object} of String => JsonValue"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcId","path":"MocoPo/JsonRpcId.html","kind":"alias","full_name":"MocoPo::JsonRpcId","name":"JsonRpcId","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L17"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Int32 | String | Nil)","aliased_html":"Int32 | String | Nil","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC ID type","summary":"<p>JSON-RPC ID type</p>"},{"html_id":"mocopo/MocoPo/JsonRpcMessage","path":"MocoPo/JsonRpcMessage.html","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage","abstract":true,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/JsonRpcNotification","kind":"class","full_name":"MocoPo::JsonRpcNotification","name":"JsonRpcNotification"},{"html_id":"mocopo/MocoPo/JsonRpcRequest","kind":"class","full_name":"MocoPo::JsonRpcRequest","name":"JsonRpcRequest"},{"html_id":"mocopo/MocoPo/JsonRpcResponse","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Base class for all JSON-RPC messages","summary":"<p>Base class for all JSON-RPC messages</p>","instance_methods":[{"html_id":"jsonrpc:String-instance-method","name":"jsonrpc","doc":"JSON-RPC version","summary":"<p>JSON-RPC version</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":7,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L7"},"def":{"name":"jsonrpc","return_type":"String","visibility":"Public","body":"@jsonrpc"},"external_var":false},{"html_id":"jsonrpc=(jsonrpc:String)-instance-method","name":"jsonrpc=","doc":"JSON-RPC version","summary":"<p>JSON-RPC version</p>","abstract":false,"args":[{"name":"jsonrpc","external_name":"jsonrpc","restriction":"String"}],"args_string":"(jsonrpc : String)","args_html":"(jsonrpc : String)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":7,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L7"},"def":{"name":"jsonrpc=","args":[{"name":"jsonrpc","external_name":"jsonrpc","restriction":"String"}],"visibility":"Public","body":"@jsonrpc = jsonrpc"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":true,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L10"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":""},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcNotification","path":"MocoPo/JsonRpcNotification.html","kind":"class","full_name":"MocoPo::JsonRpcNotification","name":"JsonRpcNotification","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},"ancestors":[{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":94,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L94"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC notification","summary":"<p>JSON-RPC notification</p>","constructors":[{"html_id":"new(method:String,params:Nil|Hash(String,MocoPo::JsonValue)=nil)-class-method","name":"new","doc":"Initialize a new notification","summary":"<p>Initialize a new notification</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"::String"},{"name":"params","default_value":"nil","external_name":"params","restriction":"::Nil | ::Hash(::String, ::MocoPo::JsonValue)"}],"args_string":"(method : String, params : Nil | Hash(String, MocoPo::JsonValue) = nil)","args_html":"(method : String, params : Nil | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":102,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L102"},"def":{"name":"new","args":[{"name":"method","external_name":"method","restriction":"::String"},{"name":"params","default_value":"nil","external_name":"params","restriction":"::Nil | ::Hash(::String, ::MocoPo::JsonValue)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(method, params)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"method:String-instance-method","name":"method","doc":"Notification method","summary":"<p>Notification method</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L96"},"def":{"name":"method","return_type":"String","visibility":"Public","body":"@method"},"external_var":false},{"html_id":"method=(method:String)-instance-method","name":"method=","doc":"Notification method","summary":"<p>Notification method</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"String"}],"args_string":"(method : String)","args_html":"(method : String)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L96"},"def":{"name":"method=","args":[{"name":"method","external_name":"method","restriction":"String"}],"visibility":"Public","body":"@method = method"},"external_var":false},{"html_id":"params:JsonRpcNotificationParams-instance-method","name":"params","doc":"Notification parameters","summary":"<p>Notification parameters</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L99"},"def":{"name":"params","return_type":"JsonRpcNotificationParams","visibility":"Public","body":"@params"},"external_var":false},{"html_id":"params=(params:JsonRpcNotificationParams)-instance-method","name":"params=","doc":"Notification parameters","summary":"<p>Notification parameters</p>","abstract":false,"args":[{"name":"params","external_name":"params","restriction":"JsonRpcNotificationParams"}],"args_string":"(params : JsonRpcNotificationParams)","args_html":"(params : <a href=\"../MocoPo/JsonRpcNotificationParams.html\">JsonRpcNotificationParams</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L99"},"def":{"name":"params=","args":[{"name":"params","external_name":"params","restriction":"JsonRpcNotificationParams"}],"visibility":"Public","body":"@params = params"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":106,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L106"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"jsonrpc\" => @jsonrpc, \"method\" => @method} of String => JsonValue\n\nif @params\n  result[\"params\"] = @params\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcNotificationParams","path":"MocoPo/JsonRpcNotificationParams.html","kind":"alias","full_name":"MocoPo::JsonRpcNotificationParams","name":"JsonRpcNotificationParams","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":26,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L26"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Hash(String, MocoPo::JsonValue) | Nil)","aliased_html":"Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>)?","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC notification params type","summary":"<p>JSON-RPC notification params type</p>"},{"html_id":"mocopo/MocoPo/JsonRpcParams","path":"MocoPo/JsonRpcParams.html","kind":"alias","full_name":"MocoPo::JsonRpcParams","name":"JsonRpcParams","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L23"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Hash(String, MocoPo::JsonValue) | Nil)","aliased_html":"Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>)?","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC params type","summary":"<p>JSON-RPC params type</p>"},{"html_id":"mocopo/MocoPo/JsonRpcRequest","path":"MocoPo/JsonRpcRequest.html","kind":"class","full_name":"MocoPo::JsonRpcRequest","name":"JsonRpcRequest","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},"ancestors":[{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":119,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L119"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC request","summary":"<p>JSON-RPC request</p>","constructors":[{"html_id":"new(method:String,id:Int32|String|Nil=nil,params:Nil|Hash(String,MocoPo::JsonValue)=nil)-class-method","name":"new","doc":"Initialize a new request","summary":"<p>Initialize a new request</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"::String"},{"name":"id","default_value":"nil","external_name":"id","restriction":"::Int32 | ::String | ::Nil"},{"name":"params","default_value":"nil","external_name":"params","restriction":"::Nil | ::Hash(::String, ::MocoPo::JsonValue)"}],"args_string":"(method : String, id : Int32 | String | Nil = nil, params : Nil | Hash(String, MocoPo::JsonValue) = nil)","args_html":"(method : String, id : Int32 | String | Nil = <span class=\"n\">nil</span>, params : Nil | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":130,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L130"},"def":{"name":"new","args":[{"name":"method","external_name":"method","restriction":"::String"},{"name":"id","default_value":"nil","external_name":"id","restriction":"::Int32 | ::String | ::Nil"},{"name":"params","default_value":"nil","external_name":"params","restriction":"::Nil | ::Hash(::String, ::MocoPo::JsonValue)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(method, id, params)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"id:JsonRpcId-instance-method","name":"id","doc":"Request ID","summary":"<p>Request ID</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":121,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L121"},"def":{"name":"id","return_type":"JsonRpcId","visibility":"Public","body":"@id"},"external_var":false},{"html_id":"id=(id:JsonRpcId)-instance-method","name":"id=","doc":"Request ID","summary":"<p>Request ID</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"}],"args_string":"(id : JsonRpcId)","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":121,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L121"},"def":{"name":"id=","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"}],"visibility":"Public","body":"@id = id"},"external_var":false},{"html_id":"method:String-instance-method","name":"method","doc":"Request method","summary":"<p>Request method</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":124,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L124"},"def":{"name":"method","return_type":"String","visibility":"Public","body":"@method"},"external_var":false},{"html_id":"method=(method:String)-instance-method","name":"method=","doc":"Request method","summary":"<p>Request method</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"String"}],"args_string":"(method : String)","args_html":"(method : String)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":124,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L124"},"def":{"name":"method=","args":[{"name":"method","external_name":"method","restriction":"String"}],"visibility":"Public","body":"@method = method"},"external_var":false},{"html_id":"params:JsonRpcParams-instance-method","name":"params","doc":"Request parameters","summary":"<p>Request parameters</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":127,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L127"},"def":{"name":"params","return_type":"JsonRpcParams","visibility":"Public","body":"@params"},"external_var":false},{"html_id":"params=(params:JsonRpcParams)-instance-method","name":"params=","doc":"Request parameters","summary":"<p>Request parameters</p>","abstract":false,"args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(params : JsonRpcParams)","args_html":"(params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":127,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L127"},"def":{"name":"params=","args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"visibility":"Public","body":"@params = params"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":134,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L134"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"jsonrpc\" => @jsonrpc, \"id\" => @id, \"method\" => @method} of String => JsonValue\n\nif @params\n  result[\"params\"] = @params\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcResponse","path":"MocoPo/JsonRpcResponse.html","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse","abstract":true,"superclass":{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},"ancestors":[{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L14"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/JsonRpcErrorResponse","kind":"class","full_name":"MocoPo::JsonRpcErrorResponse","name":"JsonRpcErrorResponse"},{"html_id":"mocopo/MocoPo/JsonRpcSuccessResponse","kind":"class","full_name":"MocoPo::JsonRpcSuccessResponse","name":"JsonRpcSuccessResponse"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Base class for all JSON-RPC responses","summary":"<p>Base class for all JSON-RPC responses</p>","constructors":[{"html_id":"new(id:Int32|String|Nil=nil)-class-method","name":"new","doc":"Initialize a new JSON-RPC response","summary":"<p>Initialize a new JSON-RPC response</p>","abstract":false,"args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"::Int32 | ::String | ::Nil"}],"args_string":"(id : Int32 | String | Nil = nil)","args_html":"(id : Int32 | String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":19,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L19"},"def":{"name":"new","args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"::Int32 | ::String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(id)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"id:JsonRpcId-instance-method","name":"id","doc":"Request ID","summary":"<p>Request ID</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L16"},"def":{"name":"id","return_type":"JsonRpcId","visibility":"Public","body":"@id"},"external_var":false},{"html_id":"id=(id:JsonRpcId)-instance-method","name":"id=","doc":"Request ID","summary":"<p>Request ID</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"}],"args_string":"(id : JsonRpcId)","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L16"},"def":{"name":"id=","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"}],"visibility":"Public","body":"@id = id"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonRpcResult","path":"MocoPo/JsonRpcResult.html","kind":"alias","full_name":"MocoPo::JsonRpcResult","name":"JsonRpcResult","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":20,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L20"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"MocoPo::JsonValue","aliased_html":"<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC result type","summary":"<p>JSON-RPC result type</p>"},{"html_id":"mocopo/MocoPo/JsonRpcSuccessResponse","path":"MocoPo/JsonRpcSuccessResponse.html","kind":"class","full_name":"MocoPo::JsonRpcSuccessResponse","name":"JsonRpcSuccessResponse","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/JsonRpcResponse","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse"},"ancestors":[{"html_id":"mocopo/MocoPo/JsonRpcResponse","kind":"class","full_name":"MocoPo::JsonRpcResponse","name":"JsonRpcResponse"},{"html_id":"mocopo/MocoPo/JsonRpcMessage","kind":"class","full_name":"MocoPo::JsonRpcMessage","name":"JsonRpcMessage"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/json_rpc.cr","line_number":24,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L24"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"JSON-RPC success response","summary":"<p>JSON-RPC success response</p>","constructors":[{"html_id":"new(result:Array(MocoPo::JsonValue)|Bool|Float64|Hash(String,MocoPo::JsonValue)|Int32|String|Nil,id:JsonRpcId=nil)-class-method","name":"new","doc":"Initialize a new success response","summary":"<p>Initialize a new success response</p>","abstract":false,"args":[{"name":"result","external_name":"result","restriction":"::Array(::MocoPo::JsonValue) | ::Bool | ::Float64 | ::Hash(::String, ::MocoPo::JsonValue) | ::Int32 | ::String | ::Nil"},{"name":"id","default_value":"nil","external_name":"id","restriction":"JsonRpcId"}],"args_string":"(result : Array(MocoPo::JsonValue) | Bool | Float64 | Hash(String, MocoPo::JsonValue) | Int32 | String | Nil, id : JsonRpcId = nil)","args_html":"(result : Array(<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Bool | Float64 | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Int32 | String | Nil, id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a> = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":29,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L29"},"def":{"name":"new","args":[{"name":"result","external_name":"result","restriction":"::Array(::MocoPo::JsonValue) | ::Bool | ::Float64 | ::Hash(::String, ::MocoPo::JsonValue) | ::Int32 | ::String | ::Nil"},{"name":"id","default_value":"nil","external_name":"id","restriction":"JsonRpcId"}],"visibility":"Public","body":"_ = allocate\n_.initialize(result, id)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"result:JsonRpcResult-instance-method","name":"result","doc":"Response result","summary":"<p>Response result</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":26,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L26"},"def":{"name":"result","return_type":"JsonRpcResult","visibility":"Public","body":"@result"},"external_var":false},{"html_id":"result=(result:JsonRpcResult)-instance-method","name":"result=","doc":"Response result","summary":"<p>Response result</p>","abstract":false,"args":[{"name":"result","external_name":"result","restriction":"JsonRpcResult"}],"args_string":"(result : JsonRpcResult)","args_html":"(result : <a href=\"../MocoPo/JsonRpcResult.html\">JsonRpcResult</a>)","location":{"filename":"src/mocopo/json_rpc.cr","line_number":26,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L26"},"def":{"name":"result=","args":[{"name":"result","external_name":"result","restriction":"JsonRpcResult"}],"visibility":"Public","body":"@result = result"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/json_rpc.cr","line_number":34,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/json_rpc.cr#L34"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"jsonrpc\" => @jsonrpc, \"id\" => @id, \"result\" => @result} of String => JsonValue\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/JsonValue","path":"MocoPo/JsonValue.html","kind":"alias","full_name":"MocoPo::JsonValue","name":"JsonValue","abstract":false,"locations":[{"filename":"src/mocopo/types.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/types.cr#L8"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"(Array(MocoPo::JsonValue) | Bool | Float64 | Hash(String, MocoPo::JsonValue) | Int32 | String | Nil)","aliased_html":"Array(<a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Bool | Float64 | Hash(String, <a href=\"../MocoPo/JsonValue.html\">MocoPo::JsonValue</a>) | Int32 | String | Nil","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Forward declaration for JsonObject and JsonArray","summary":"<p>Forward declaration for JsonObject and JsonArray</p>"},{"html_id":"mocopo/MocoPo/MessageContent","path":"MocoPo/MessageContent.html","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent","abstract":true,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/ImageContent","kind":"class","full_name":"MocoPo::ImageContent","name":"ImageContent"},{"html_id":"mocopo/MocoPo/ResourceContentRef","kind":"class","full_name":"MocoPo::ResourceContentRef","name":"ResourceContentRef"},{"html_id":"mocopo/MocoPo/TextContent","kind":"class","full_name":"MocoPo::TextContent","name":"TextContent"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Base class for message content","summary":"<p>Base class for message content</p>","instance_methods":[{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":true,"location":{"filename":"src/mocopo/prompts.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L5"},"def":{"name":"to_json_object","visibility":"Public","body":""},"external_var":false}]},{"html_id":"mocopo/MocoPo/ModelHint","path":"MocoPo/ModelHint.html","kind":"class","full_name":"MocoPo::ModelHint","name":"ModelHint","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":205,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L205"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Model hint class","summary":"<p>Model hint class</p>","constructors":[{"html_id":"from_json_object(json:JsonObject):ModelHint-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : ModelHint","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/ModelHint.html\">ModelHint</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":221,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L221"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"ModelHint","visibility":"Public","body":"begin\n  name = (MocoPo.safe_string(json[\"name\"]?)) || \"\"\n  new(name)\nrescue ex\n  new(\"\")\nend"},"external_var":false},{"html_id":"new(name:String)-class-method","name":"new","doc":"Initialize a new model hint","summary":"<p>Initialize a new model hint</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":210,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L210"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"name:String-instance-method","name":"name","doc":"Model name","summary":"<p>Model name</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":207,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L207"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"name=(name:String)-instance-method","name":"name=","doc":"Model name","summary":"<p>Model name</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":207,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L207"},"def":{"name":"name=","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"@name = name"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":214,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L214"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"name\" => @name} of String => JsonValue"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ModelPreferences","path":"MocoPo/ModelPreferences.html","kind":"class","full_name":"MocoPo::ModelPreferences","name":"ModelPreferences","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":231,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L231"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Model preferences class","summary":"<p>Model preferences class</p>","constructors":[{"html_id":"from_json_object(json:JsonObject):ModelPreferences-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : ModelPreferences","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/ModelPreferences.html\">ModelPreferences</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":268,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L268"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"ModelPreferences","visibility":"Public","body":"begin\n  hints = [] of ModelHint\n\n  hints_array = MocoPo.safe_array(json[\"hints\"]?)\n  if hints_array\n    hints = hints_array.compact_map do |hint_json|\n      hint_hash = MocoPo.safe_hash(hint_json)\n      hint_hash ? ModelHint.from_json_object(hint_hash) : nil\n    end\n  end\n\n  cost_priority = MocoPo.safe_float(json[\"costPriority\"]?)\n  speed_priority = MocoPo.safe_float(json[\"speedPriority\"]?)\n  intelligence_priority = MocoPo.safe_float(json[\"intelligencePriority\"]?)\n\n  new(hints, cost_priority, speed_priority, intelligence_priority)\nrescue ex\n  new\nend"},"external_var":false},{"html_id":"new(hints:Array(MocoPo::ModelHint)=[]ofModelHint,cost_priority:Float64|Nil=nil,speed_priority:Float64|Nil=nil,intelligence_priority:Float64|Nil=nil)-class-method","name":"new","doc":"Initialize a new model preferences","summary":"<p>Initialize a new model preferences</p>","abstract":false,"args":[{"name":"hints","default_value":"[] of ModelHint","external_name":"hints","restriction":"::Array(::MocoPo::ModelHint)"},{"name":"cost_priority","default_value":"nil","external_name":"cost_priority","restriction":"::Float64 | ::Nil"},{"name":"speed_priority","default_value":"nil","external_name":"speed_priority","restriction":"::Float64 | ::Nil"},{"name":"intelligence_priority","default_value":"nil","external_name":"intelligence_priority","restriction":"::Float64 | ::Nil"}],"args_string":"(hints : Array(MocoPo::ModelHint) = [] of ModelHint, cost_priority : Float64 | Nil = nil, speed_priority : Float64 | Nil = nil, intelligence_priority : Float64 | Nil = nil)","args_html":"(hints : Array(<a href=\"../MocoPo/ModelHint.html\">MocoPo::ModelHint</a>) = <span class=\"o\">[]</span> <span class=\"k\">of</span> <span class=\"t\">ModelHint</span>, cost_priority : Float64 | Nil = <span class=\"n\">nil</span>, speed_priority : Float64 | Nil = <span class=\"n\">nil</span>, intelligence_priority : Float64 | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/sampling.cr","line_number":245,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L245"},"def":{"name":"new","args":[{"name":"hints","default_value":"[] of ModelHint","external_name":"hints","restriction":"::Array(::MocoPo::ModelHint)"},{"name":"cost_priority","default_value":"nil","external_name":"cost_priority","restriction":"::Float64 | ::Nil"},{"name":"speed_priority","default_value":"nil","external_name":"speed_priority","restriction":"::Float64 | ::Nil"},{"name":"intelligence_priority","default_value":"nil","external_name":"intelligence_priority","restriction":"::Float64 | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(hints, cost_priority, speed_priority, intelligence_priority)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"cost_priority:Float64|Nil-instance-method","name":"cost_priority","doc":"Cost priority (0.0 to 1.0)","summary":"<p>Cost priority (0.0 to 1.0)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":236,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L236"},"def":{"name":"cost_priority","return_type":"Float64 | ::Nil","visibility":"Public","body":"@cost_priority"},"external_var":false},{"html_id":"cost_priority=(cost_priority:Float64|Nil)-instance-method","name":"cost_priority=","doc":"Cost priority (0.0 to 1.0)","summary":"<p>Cost priority (0.0 to 1.0)</p>","abstract":false,"args":[{"name":"cost_priority","external_name":"cost_priority","restriction":"Float64 | ::Nil"}],"args_string":"(cost_priority : Float64 | Nil)","args_html":"(cost_priority : Float64 | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":236,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L236"},"def":{"name":"cost_priority=","args":[{"name":"cost_priority","external_name":"cost_priority","restriction":"Float64 | ::Nil"}],"visibility":"Public","body":"@cost_priority = cost_priority"},"external_var":false},{"html_id":"hints:Array(ModelHint)-instance-method","name":"hints","doc":"Model hints","summary":"<p>Model hints</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":233,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L233"},"def":{"name":"hints","return_type":"Array(ModelHint)","visibility":"Public","body":"@hints"},"external_var":false},{"html_id":"hints=(hints:Array(ModelHint))-instance-method","name":"hints=","doc":"Model hints","summary":"<p>Model hints</p>","abstract":false,"args":[{"name":"hints","external_name":"hints","restriction":"Array(ModelHint)"}],"args_string":"(hints : Array(ModelHint))","args_html":"(hints : Array(<a href=\"../MocoPo/ModelHint.html\">ModelHint</a>))","location":{"filename":"src/mocopo/sampling.cr","line_number":233,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L233"},"def":{"name":"hints=","args":[{"name":"hints","external_name":"hints","restriction":"Array(ModelHint)"}],"visibility":"Public","body":"@hints = hints"},"external_var":false},{"html_id":"intelligence_priority:Float64|Nil-instance-method","name":"intelligence_priority","doc":"Intelligence priority (0.0 to 1.0)","summary":"<p>Intelligence priority (0.0 to 1.0)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":242,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L242"},"def":{"name":"intelligence_priority","return_type":"Float64 | ::Nil","visibility":"Public","body":"@intelligence_priority"},"external_var":false},{"html_id":"intelligence_priority=(intelligence_priority:Float64|Nil)-instance-method","name":"intelligence_priority=","doc":"Intelligence priority (0.0 to 1.0)","summary":"<p>Intelligence priority (0.0 to 1.0)</p>","abstract":false,"args":[{"name":"intelligence_priority","external_name":"intelligence_priority","restriction":"Float64 | ::Nil"}],"args_string":"(intelligence_priority : Float64 | Nil)","args_html":"(intelligence_priority : Float64 | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":242,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L242"},"def":{"name":"intelligence_priority=","args":[{"name":"intelligence_priority","external_name":"intelligence_priority","restriction":"Float64 | ::Nil"}],"visibility":"Public","body":"@intelligence_priority = intelligence_priority"},"external_var":false},{"html_id":"speed_priority:Float64|Nil-instance-method","name":"speed_priority","doc":"Speed priority (0.0 to 1.0)","summary":"<p>Speed priority (0.0 to 1.0)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":239,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L239"},"def":{"name":"speed_priority","return_type":"Float64 | ::Nil","visibility":"Public","body":"@speed_priority"},"external_var":false},{"html_id":"speed_priority=(speed_priority:Float64|Nil)-instance-method","name":"speed_priority=","doc":"Speed priority (0.0 to 1.0)","summary":"<p>Speed priority (0.0 to 1.0)</p>","abstract":false,"args":[{"name":"speed_priority","external_name":"speed_priority","restriction":"Float64 | ::Nil"}],"args_string":"(speed_priority : Float64 | Nil)","args_html":"(speed_priority : Float64 | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":239,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L239"},"def":{"name":"speed_priority=","args":[{"name":"speed_priority","external_name":"speed_priority","restriction":"Float64 | ::Nil"}],"visibility":"Public","body":"@speed_priority = speed_priority"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":249,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L249"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {} of String => JsonValue\n\nif @hints.empty?\nelse\n  hints_array = [] of JsonValue\n  @hints.each do |hint|\n    hints_array << hint.to_json_object\n  end\n  result[\"hints\"] = hints_array\nend\n\nif @cost_priority\n  result[\"costPriority\"] = @cost_priority\nend\nif @speed_priority\n  result[\"speedPriority\"] = @speed_priority\nend\nif @intelligence_priority\n  result[\"intelligencePriority\"] = @intelligence_priority\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/NotificationManager","path":"MocoPo/NotificationManager.html","kind":"class","full_name":"MocoPo::NotificationManager","name":"NotificationManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/notifications.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Notification manager for MCP servers","summary":"<p>Notification manager for MCP servers</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new notification manager","summary":"<p>Initialize a new notification manager</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/notifications.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L8"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"prompts_list_changed-instance-method","name":"prompts_list_changed","doc":"Send a prompts list changed notification","summary":"<p>Send a prompts list changed notification</p>","abstract":false,"location":{"filename":"src/mocopo/notifications.cr","line_number":35,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L35"},"def":{"name":"prompts_list_changed","visibility":"Public","body":"send_notification(\"notifications/prompts/list_changed\")"},"external_var":false},{"html_id":"resource_updated(uri:String)-instance-method","name":"resource_updated","doc":"Send a resource updated notification","summary":"<p>Send a resource updated notification</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String)","args_html":"(uri : String)","location":{"filename":"src/mocopo/notifications.cr","line_number":50,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L50"},"def":{"name":"resource_updated","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"visibility":"Public","body":"params = {} of String => JsonValue\nparams[\"uri\"] = uri\n\n\nsend_notification(\"notifications/resources/updated\", params)\n"},"external_var":false},{"html_id":"resources_list_changed-instance-method","name":"resources_list_changed","doc":"Send a resources list changed notification","summary":"<p>Send a resources list changed notification</p>","abstract":false,"location":{"filename":"src/mocopo/notifications.cr","line_number":40,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L40"},"def":{"name":"resources_list_changed","visibility":"Public","body":"send_notification(\"notifications/resources/list_changed\")"},"external_var":false},{"html_id":"send_notification(method:String,params:JsonRpcNotificationParams=nil)-instance-method","name":"send_notification","doc":"Send a notification to all connected clients","summary":"<p>Send a notification to all connected clients</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"params","default_value":"nil","external_name":"params","restriction":"JsonRpcNotificationParams"}],"args_string":"(method : String, params : JsonRpcNotificationParams = nil)","args_html":"(method : String, params : <a href=\"../MocoPo/JsonRpcNotificationParams.html\">JsonRpcNotificationParams</a> = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/notifications.cr","line_number":12,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L12"},"def":{"name":"send_notification","args":[{"name":"method","external_name":"method","restriction":"String"},{"name":"params","default_value":"nil","external_name":"params","restriction":"JsonRpcNotificationParams"}],"visibility":"Public","body":"notification = JsonRpcNotification.new(method, params)\n\n\njson_object = notification.to_json_object\n\n\nif transport_manager = @server.transport_manager\n  (transport_manager.@transports).each do |transport|\n    begin\n      transport.send(json_object)\n    rescue ex : Exception\n      puts(\"Failed to send notification through transport: #{ex.message}\")\n    end\n  end\nend\n\n\nputs(\"Broadcasting notification: #{json_object.to_json}\")\n"},"external_var":false},{"html_id":"tools_list_changed-instance-method","name":"tools_list_changed","doc":"Send a tools list changed notification","summary":"<p>Send a tools list changed notification</p>","abstract":false,"location":{"filename":"src/mocopo/notifications.cr","line_number":45,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/notifications.cr#L45"},"def":{"name":"tools_list_changed","visibility":"Public","body":"send_notification(\"notifications/tools/list_changed\")"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Pagination","path":"MocoPo/Pagination.html","kind":"module","full_name":"MocoPo::Pagination","name":"Pagination","abstract":false,"locations":[{"filename":"src/mocopo/pagination.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L6"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"DEFAULT_PAGE_SIZE","name":"DEFAULT_PAGE_SIZE","value":"50","doc":"Default page size for paginated results","summary":"<p>Default page size for paginated results</p>"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Pagination utilities for MCP list operations","summary":"<p>Pagination utilities for MCP list operations</p>","class_methods":[{"html_id":"paginate(items:Array(T),cursor_string:String|Nil):Tuple(Array(T),String|Nil)forallT-class-method","name":"paginate","doc":"Paginate a list of items","summary":"<p>Paginate a list of items</p>","abstract":false,"args":[{"name":"items","external_name":"items","restriction":"Array(T)"},{"name":"cursor_string","external_name":"cursor_string","restriction":"String | ::Nil"}],"args_string":"(items : Array(T), cursor_string : String | Nil) : Tuple(Array(T), String | Nil) forall T","args_html":"(items : Array(T), cursor_string : String | Nil) : Tuple(Array(T), String | Nil) forall T","location":{"filename":"src/mocopo/pagination.cr","line_number":74,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L74"},"def":{"name":"paginate","args":[{"name":"items","external_name":"items","restriction":"Array(T)"},{"name":"cursor_string","external_name":"cursor_string","restriction":"String | ::Nil"}],"return_type":"::Tuple(Array(T), String | ::Nil)","visibility":"Public","body":"cursor = Cursor.from_string(cursor_string)\n\n\nstart_index = cursor.offset\nend_index = start_index + cursor.limit\n\n\npage_items = items[start_index...end_index]\n\n\nnext_cursor = end_index < items.size ? cursor.next.to_string : nil\n\n{page_items, next_cursor}\n"},"external_var":false}],"types":[{"html_id":"mocopo/MocoPo/Pagination/Cursor","path":"MocoPo/Pagination/Cursor.html","kind":"class","full_name":"MocoPo::Pagination::Cursor","name":"Cursor","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/pagination.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L11"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo/Pagination","kind":"module","full_name":"MocoPo::Pagination","name":"Pagination"},"doc":"Cursor data structure","summary":"<p>Cursor data structure</p>","constructors":[{"html_id":"from_string(cursor_string:String|Nil):Cursor-class-method","name":"from_string","doc":"Create a cursor from an encoded string","summary":"<p>Create a cursor from an encoded string</p>","abstract":false,"args":[{"name":"cursor_string","external_name":"cursor_string","restriction":"String | ::Nil"}],"args_string":"(cursor_string : String | Nil) : Cursor","args_html":"(cursor_string : String | Nil) : <a href=\"../../MocoPo/Pagination/Cursor.html\">Cursor</a>","location":{"filename":"src/mocopo/pagination.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L23"},"def":{"name":"from_string","args":[{"name":"cursor_string","external_name":"cursor_string","restriction":"String | ::Nil"}],"return_type":"Cursor","visibility":"Public","body":"if cursor_string.nil? || cursor_string.empty?\n  return new\nend\n\nbegin\n  decoded = Base64.decode_string(cursor_string)\n\n\n  json = JSON.parse(decoded)\n\n\n  page = json[\"page\"]?.try(&.as_i) || 0\n  page_size = json[\"page_size\"]?.try(&.as_i) || DEFAULT_PAGE_SIZE\n\n\n  new(page, page_size)\nrescue ex\n  new\nend\n"},"external_var":false},{"html_id":"new(page:Int32=0,page_size:Int32=DEFAULT_PAGE_SIZE)-class-method","name":"new","doc":"Initialize a new cursor","summary":"<p>Initialize a new cursor</p>","abstract":false,"args":[{"name":"page","default_value":"0","external_name":"page","restriction":"::Int32"},{"name":"page_size","default_value":"DEFAULT_PAGE_SIZE","external_name":"page_size","restriction":"::Int32"}],"args_string":"(page : Int32 = 0, page_size : Int32 = DEFAULT_PAGE_SIZE)","args_html":"(page : Int32 = <span class=\"n\">0</span>, page_size : Int32 = <span class=\"t\">DEFAULT_PAGE_SIZE</span>)","location":{"filename":"src/mocopo/pagination.cr","line_number":19,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L19"},"def":{"name":"new","args":[{"name":"page","default_value":"0","external_name":"page","restriction":"::Int32"},{"name":"page_size","default_value":"DEFAULT_PAGE_SIZE","external_name":"page_size","restriction":"::Int32"}],"visibility":"Public","body":"_ = allocate\n_.initialize(page, page_size)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"limit:Int32-instance-method","name":"limit","doc":"Get the limit for database queries","summary":"<p>Get the limit for database queries</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":68,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L68"},"def":{"name":"limit","return_type":"Int32","visibility":"Public","body":"@page_size"},"external_var":false},{"html_id":"next:Cursor-instance-method","name":"next","doc":"Get the next cursor","summary":"<p>Get the next cursor</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":58,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L58"},"def":{"name":"next","return_type":"Cursor","visibility":"Public","body":"Cursor.new(@page + 1, @page_size)"},"external_var":false},{"html_id":"offset:Int32-instance-method","name":"offset","doc":"Get the offset for database queries","summary":"<p>Get the offset for database queries</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":63,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L63"},"def":{"name":"offset","return_type":"Int32","visibility":"Public","body":"@page * @page_size"},"external_var":false},{"html_id":"page:Int32-instance-method","name":"page","doc":"Page number (0-based)","summary":"<p>Page number (0-based)</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":13,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L13"},"def":{"name":"page","return_type":"Int32","visibility":"Public","body":"@page"},"external_var":false},{"html_id":"page_size:Int32-instance-method","name":"page_size","doc":"Page size","summary":"<p>Page size</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L16"},"def":{"name":"page_size","return_type":"Int32","visibility":"Public","body":"@page_size"},"external_var":false},{"html_id":"to_string:String-instance-method","name":"to_string","doc":"Convert the cursor to an encoded string","summary":"<p>Convert the cursor to an encoded string</p>","abstract":false,"location":{"filename":"src/mocopo/pagination.cr","line_number":46,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/pagination.cr#L46"},"def":{"name":"to_string","return_type":"String","visibility":"Public","body":"json = {\"page\" => @page, \"page_size\" => @page_size}.to_json\n\n\nBase64.strict_encode(json)\n"},"external_var":false}]}]},{"html_id":"mocopo/MocoPo/Prompt","path":"MocoPo/Prompt.html","kind":"class","full_name":"MocoPo::Prompt","name":"Prompt","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":119,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L119"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Represents a prompt that provides structured messages for LLMs","summary":"<p>Represents a prompt that provides structured messages for LLMs</p>","constructors":[{"html_id":"new(name:String,description:String|Nil=nil,&callback:JsonObject|Nil->Array(PromptMessage))-class-method","name":"new","doc":"Initialize a new prompt","summary":"<p>Initialize a new prompt</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, description : String | Nil = nil, &callback : JsonObject | Nil -> Array(PromptMessage))","args_html":"(name : String, description : String | Nil = <span class=\"n\">nil</span>, &callback : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil -> Array(<a href=\"../MocoPo/PromptMessage.html\">PromptMessage</a>))","location":{"filename":"src/mocopo/prompts.cr","line_number":133,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L133"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"callback","external_name":"callback","restriction":"(JsonObject | ::Nil -> Array(PromptMessage))"},"visibility":"Public","body":"_ = allocate\n_.initialize(name, description, &callback) do |_arg0|\n  yield _arg0\nend\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(name:String,description:String|Nil=nil)-class-method","name":"new","doc":"Initialize a new prompt without callback","summary":"<p>Initialize a new prompt without callback</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, description : String | Nil = nil)","args_html":"(name : String, description : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/prompts.cr","line_number":139,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L139"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, description)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"add_argument(name:String,required:Bool=false,description:String|Nil=nil):Prompt-instance-method","name":"add_argument","doc":"Add an argument","summary":"<p>Add an argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Prompt","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Prompt.html\">Prompt</a>","location":{"filename":"src/mocopo/prompts.cr","line_number":151,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L151"},"def":{"name":"add_argument","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Prompt","visibility":"Public","body":"@arguments << (PromptArgument.new(name, required, description))\nself\n"},"external_var":false},{"html_id":"arguments:Array(PromptArgument)-instance-method","name":"arguments","doc":"Arguments for customization","summary":"<p>Arguments for customization</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":127,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L127"},"def":{"name":"arguments","return_type":"Array(PromptArgument)","visibility":"Public","body":"@arguments"},"external_var":false},{"html_id":"description:String|Nil-instance-method","name":"description","doc":"Human-readable description","summary":"<p>Human-readable description</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":124,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L124"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"execute(arguments:JsonObject|Nil):Array(PromptMessage)-instance-method","name":"execute","doc":"Execute the prompt with the given arguments","summary":"<p>Execute the prompt with the given arguments</p>","abstract":false,"args":[{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"}],"args_string":"(arguments : JsonObject | Nil) : Array(PromptMessage)","args_html":"(arguments : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil) : Array(<a href=\"../MocoPo/PromptMessage.html\">PromptMessage</a>)","location":{"filename":"src/mocopo/prompts.cr","line_number":157,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L157"},"def":{"name":"execute","args":[{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"}],"return_type":"Array(PromptMessage)","visibility":"Public","body":"if @callback\n  @callback.not_nil!.call(arguments)\nelse\n  [PromptMessage.new(\"user\", TextContent.new(\"Prompt execution not implemented for: #{@name}\"))]\nend"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Prompt name (unique identifier)","summary":"<p>Prompt name (unique identifier)</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":121,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L121"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"on_execute(&callback:JsonObject|Nil->Array(PromptMessage))-instance-method","name":"on_execute","doc":"Set the execution callback","summary":"<p>Set the execution callback</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":145,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L145"},"def":{"name":"on_execute","yields":1,"block_arity":1,"block_arg":{"name":"callback","external_name":"callback","restriction":"(JsonObject | ::Nil -> Array(PromptMessage))"},"visibility":"Public","body":"@callback = callback\nself\n"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":172,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L172"},"def":{"name":"to_json_object","visibility":"Public","body":"result = {\"name\" => @name} of String => String | Array(Hash(String, String | Bool | Nil)) | Nil\n\nresult[\"description\"] = @description\n\nif @arguments.empty?\nelse\n  args = @arguments.map(&.to_json_object)\n  result[\"arguments\"] = args\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/PromptArgument","path":"MocoPo/PromptArgument.html","kind":"class","full_name":"MocoPo::PromptArgument","name":"PromptArgument","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":91,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L91"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Prompt argument","summary":"<p>Prompt argument</p>","constructors":[{"html_id":"new(name:String,required:Bool=false,description:String|Nil=nil)-class-method","name":"new","doc":"Initialize a new prompt argument","summary":"<p>Initialize a new prompt argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil)","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/prompts.cr","line_number":102,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L102"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, required, description)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"description:String|Nil-instance-method","name":"description","doc":"Human-readable description","summary":"<p>Human-readable description</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L99"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Argument name","summary":"<p>Argument name</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":93,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L93"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"required:Bool-instance-method","name":"required","doc":"Whether the argument is required","summary":"<p>Whether the argument is required</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L96"},"def":{"name":"required","return_type":"Bool","visibility":"Public","body":"@required"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":106,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L106"},"def":{"name":"to_json_object","visibility":"Public","body":"result = {\"name\" => @name, \"required\" => @required} of String => String | Bool | Nil\n\nif @description\n  result[\"description\"] = @description\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/PromptManager","path":"MocoPo/PromptManager.html","kind":"class","full_name":"MocoPo::PromptManager","name":"PromptManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":189,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L189"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Manages prompts for an MCP server","summary":"<p>Manages prompts for an MCP server</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new prompt manager","summary":"<p>Initialize a new prompt manager</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":194,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L194"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"exists?(name:String):Bool-instance-method","name":"exists?","doc":"Check if a prompt exists","summary":"<p>Check if a prompt exists</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Bool","args_html":"(name : String) : Bool","location":{"filename":"src/mocopo/prompts.cr","line_number":226,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L226"},"def":{"name":"exists?","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@prompts.has_key?(name)"},"external_var":false},{"html_id":"get(name:String):Prompt|Nil-instance-method","name":"get","doc":"Get a prompt by name","summary":"<p>Get a prompt by name</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Prompt | Nil","args_html":"(name : String) : <a href=\"../MocoPo/Prompt.html\">Prompt</a> | Nil","location":{"filename":"src/mocopo/prompts.cr","line_number":216,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L216"},"def":{"name":"get","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Prompt | ::Nil","visibility":"Public","body":"@prompts[name]?"},"external_var":false},{"html_id":"list:Array(Prompt)-instance-method","name":"list","doc":"List all registered prompts","summary":"<p>List all registered prompts</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":221,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L221"},"def":{"name":"list","return_type":"Array(Prompt)","visibility":"Public","body":"@prompts.values"},"external_var":false},{"html_id":"register(prompt:Prompt)-instance-method","name":"register","doc":"Register a new prompt","summary":"<p>Register a new prompt</p>","abstract":false,"args":[{"name":"prompt","external_name":"prompt","restriction":"Prompt"}],"args_string":"(prompt : Prompt)","args_html":"(prompt : <a href=\"../MocoPo/Prompt.html\">Prompt</a>)","location":{"filename":"src/mocopo/prompts.cr","line_number":205,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L205"},"def":{"name":"register","args":[{"name":"prompt","external_name":"prompt","restriction":"Prompt"}],"visibility":"Public","body":"was_new = !(@prompts.has_key?(prompt.name))\n@prompts[prompt.name] = prompt\n\n\nif (was_new && (server = @server)) && (notification_manager = server.notification_manager)\n  notification_manager.prompts_list_changed\nend\n"},"external_var":false},{"html_id":"remove(name:String)-instance-method","name":"remove","doc":"Remove a prompt","summary":"<p>Remove a prompt</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/mocopo/prompts.cr","line_number":231,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L231"},"def":{"name":"remove","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"if @prompts.has_key?(name)\n  @prompts.delete(name)\n\n\n  if (server = @server) && (notification_manager = server.notification_manager)\n    notification_manager.prompts_list_changed\n  end\nend"},"external_var":false},{"html_id":"server=(server:Server)-instance-method","name":"server=","doc":"Set the server instance","summary":"<p>Set the server instance</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/prompts.cr","line_number":200,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L200"},"def":{"name":"server=","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"@server = server"},"external_var":false}]},{"html_id":"mocopo/MocoPo/PromptMessage","path":"MocoPo/PromptMessage.html","kind":"class","full_name":"MocoPo::PromptMessage","name":"PromptMessage","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":70,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L70"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Prompt message","summary":"<p>Prompt message</p>","constructors":[{"html_id":"new(role:String,content:MessageContent)-class-method","name":"new","doc":"Initialize a new prompt message","summary":"<p>Initialize a new prompt message</p>","abstract":false,"args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"MessageContent"}],"args_string":"(role : String, content : MessageContent)","args_html":"(role : String, content : <a href=\"../MocoPo/MessageContent.html\">MessageContent</a>)","location":{"filename":"src/mocopo/prompts.cr","line_number":78,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L78"},"def":{"name":"new","args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"MessageContent"}],"visibility":"Public","body":"_ = allocate\n_.initialize(role, content)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"content:MessageContent-instance-method","name":"content","doc":"Content of the message","summary":"<p>Content of the message</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":75,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L75"},"def":{"name":"content","return_type":"MessageContent","visibility":"Public","body":"@content"},"external_var":false},{"html_id":"role:String-instance-method","name":"role","doc":"Role of the message sender (user or assistant)","summary":"<p>Role of the message sender (user or assistant)</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":72,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L72"},"def":{"name":"role","return_type":"String","visibility":"Public","body":"@role"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":82,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L82"},"def":{"name":"to_json_object","visibility":"Public","body":"{\"role\" => @role, \"content\" => @content.to_json_object} of String => String | Hash(String, String | Hash(String, String | Nil))"},"external_var":false}]},{"html_id":"mocopo/MocoPo/PromptsHandler","path":"MocoPo/PromptsHandler.html","kind":"class","full_name":"MocoPo::PromptsHandler","name":"PromptsHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/prompts_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/prompts_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for prompts methods","summary":"<p>Handler for prompts methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/prompts_handler.cr","line_number":95,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/prompts_handler.cr#L95"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"PromptsHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_get(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_get","doc":"Handle prompts/get request","summary":"<p>Handle prompts/get request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/prompts_handler.cr","line_number":44,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/prompts_handler.cr#L44"},"def":{"name":"handle_get","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"name = get_string_param(params, \"name\")\narguments = get_hash_param(params, \"arguments\")\n\n\nif name && (@server.prompt_manager.exists?(name))\nelse\n  return error_response(-32602, \"Unknown prompt: #{name || \"missing name\"}\", id)\nend\n\n\nprompt = (@server.prompt_manager.get(name)).not_nil!\n\nbegin\n  json_args = arguments\n\n\n  messages = prompt.execute(json_args)\n\n\n  result = {} of String => JsonValue\n  result[\"description\"] = prompt.description\n\n\n  messages_array = [] of JsonValue\n  messages.each do |message|\n    message_json = message.to_json_object\n    message_json_str = message_json.to_json\n    message_json_value = (JSON.parse(message_json_str)).as_h\n\n\n    message_value = {} of String => JsonValue\n    message_json_value.each do |k, v|\n      message_value[k] = Utils.to_json_value(v)\n    end\n\n    messages_array << message_value\n  end\n  result[\"messages\"] = messages_array\n\n\n  success_response(id, result)\nrescue ex\n  error_response(-32603, \"Error executing prompt: #{ex.message}\", id)\nend\n"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle prompts/list request","summary":"<p>Handle prompts/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/prompts_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/prompts_handler.cr#L5"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"cursor = get_string_param(params, \"cursor\")\n\n\nprompts = @server.prompt_manager.list\n\n\npage_prompts, next_cursor = Pagination.paginate(prompts, cursor)\n\n\nresponse = {} of String => JsonValue\n\n\nprompts_array = [] of JsonValue\npage_prompts.each do |prompt|\n  prompt_json = prompt.to_json_object\n  prompt_json_str = prompt_json.to_json\n  prompt_json_value = (JSON.parse(prompt_json_str)).as_h\n\n\n  prompt_value = {} of String => JsonValue\n  prompt_json_value.each do |k, v|\n    prompt_value[k] = Utils.to_json_value(v)\n  end\n\n  prompts_array << prompt_value\nend\nresponse[\"prompts\"] = prompts_array\n\n\nif next_cursor\n  response[\"nextCursor\"] = next_cursor\nend\n\n\nsafe_success_response(id, response)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Resource","path":"MocoPo/Resource.html","kind":"class","full_name":"MocoPo::Resource","name":"Resource","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/resources.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Represents a resource that provides context to language models","summary":"<p>Represents a resource that provides context to language models</p>","constructors":[{"html_id":"new(uri:String,name:String,description:String|Nil=nil,mime_type:String|Nil=nil,size:Int64|Nil=nil,&content_callback:Context|Nil->ResourceContent)-class-method","name":"new","doc":"Initialize a new resource","summary":"<p>Initialize a new resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"args_string":"(uri : String, name : String, description : String | Nil = nil, mime_type : String | Nil = nil, size : Int64 | Nil = nil, &content_callback : Context | Nil -> ResourceContent)","args_html":"(uri : String, name : String, description : String | Nil = <span class=\"n\">nil</span>, mime_type : String | Nil = <span class=\"n\">nil</span>, size : Int64 | Nil = <span class=\"n\">nil</span>, &content_callback : <a href=\"../MocoPo/Context.html\">Context</a> | Nil -> <a href=\"../MocoPo/ResourceContent.html\">ResourceContent</a>)","location":{"filename":"src/mocopo/resources.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L23"},"def":{"name":"new","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"content_callback","external_name":"content_callback","restriction":"(Context | ::Nil -> ResourceContent)"},"visibility":"Public","body":"_ = allocate\n_.initialize(uri, name, description, mime_type, size, &content_callback) do |_arg0|\n  yield _arg0\nend\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(uri:String,name:String,description:String|Nil=nil,mime_type:String|Nil=nil,size:Int64|Nil=nil)-class-method","name":"new","doc":"Initialize a new resource without content callback","summary":"<p>Initialize a new resource without content callback</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"args_string":"(uri : String, name : String, description : String | Nil = nil, mime_type : String | Nil = nil, size : Int64 | Nil = nil)","args_html":"(uri : String, name : String, description : String | Nil = <span class=\"n\">nil</span>, mime_type : String | Nil = <span class=\"n\">nil</span>, size : Int64 | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/resources.cr","line_number":28,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L28"},"def":{"name":"new","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(uri, name, description, mime_type, size)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"description:String|Nil-instance-method","name":"description","doc":"Optional description","summary":"<p>Optional description</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L11"},"def":{"name":"description","return_type":"String | ::Nil","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"get_content(context:Context|Nil=nil):ResourceContent-instance-method","name":"get_content","doc":"Get the resource content","summary":"<p>Get the resource content</p>","abstract":false,"args":[{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"args_string":"(context : Context | Nil = nil) : ResourceContent","args_html":"(context : <a href=\"../MocoPo/Context.html\">Context</a> | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/ResourceContent.html\">ResourceContent</a>","location":{"filename":"src/mocopo/resources.cr","line_number":39,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L39"},"def":{"name":"get_content","args":[{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"return_type":"ResourceContent","visibility":"Public","body":"if @content_callback\n  @content_callback.not_nil!.call(context)\nelse\n  ResourceContent.text(uri: @uri, text: \"Resource content not implemented for: #{@uri}\", mime_type: @mime_type || \"text/plain\")\nend"},"external_var":false},{"html_id":"mime_type:String|Nil-instance-method","name":"mime_type","doc":"Optional MIME type","summary":"<p>Optional MIME type</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L14"},"def":{"name":"mime_type","return_type":"String | ::Nil","visibility":"Public","body":"@mime_type"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Human-readable name","summary":"<p>Human-readable name</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L8"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"on_read(&content_callback:Context|Nil->ResourceContent)-instance-method","name":"on_read","doc":"Set the content callback","summary":"<p>Set the content callback</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":33,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L33"},"def":{"name":"on_read","yields":1,"block_arity":1,"block_arg":{"name":"content_callback","external_name":"content_callback","restriction":"(Context | ::Nil -> ResourceContent)"},"visibility":"Public","body":"@content_callback = content_callback\nself\n"},"external_var":false},{"html_id":"size:Int64|Nil-instance-method","name":"size","doc":"Optional size in bytes","summary":"<p>Optional size in bytes</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L17"},"def":{"name":"size","return_type":"Int64 | ::Nil","visibility":"Public","body":"@size"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":53,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L53"},"def":{"name":"to_json_object","visibility":"Public","body":"result = {\"uri\" => @uri, \"name\" => @name} of String => String | Int64 | Nil\n\nresult[\"description\"] = @description\nresult[\"mimeType\"] = @mime_type\nresult[\"size\"] = @size\n\n\nresult.reject! do |_, v|\n  v.nil?\nend\n\nresult\n"},"external_var":false},{"html_id":"uri:String-instance-method","name":"uri","doc":"Resource URI (unique identifier)","summary":"<p>Resource URI (unique identifier)</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L5"},"def":{"name":"uri","return_type":"String","visibility":"Public","body":"@uri"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ResourceContent","path":"MocoPo/ResourceContent.html","kind":"class","full_name":"MocoPo::ResourceContent","name":"ResourceContent","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/resources.cr","line_number":71,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L71"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Represents resource content","summary":"<p>Represents resource content</p>","class_methods":[{"html_id":"binary(uri:String,blob:String,mime_type:String|Nil=nil)-class-method","name":"binary","doc":"Initialize a new binary resource content","summary":"<p>Initialize a new binary resource content</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"blob","external_name":"blob","restriction":"String"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"args_string":"(uri : String, blob : String, mime_type : String | Nil = nil)","args_html":"(uri : String, blob : String, mime_type : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/resources.cr","line_number":90,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L90"},"def":{"name":"binary","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"blob","external_name":"blob","restriction":"String"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"visibility":"Public","body":"new(uri, mime_type, nil, blob)"},"external_var":false},{"html_id":"text(uri:String,text:String,mime_type:String|Nil=nil)-class-method","name":"text","doc":"Initialize a new text resource content","summary":"<p>Initialize a new text resource content</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"text","external_name":"text","restriction":"String"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"args_string":"(uri : String, text : String, mime_type : String | Nil = nil)","args_html":"(uri : String, text : String, mime_type : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/resources.cr","line_number":85,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L85"},"def":{"name":"text","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"text","external_name":"text","restriction":"String"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"visibility":"Public","body":"new(uri, mime_type, text, nil)"},"external_var":false}],"constructors":[{"html_id":"new(uri:String,mime_type:String|Nil,text:String|Nil,blob:String|Nil)-class-method","name":"new","doc":"Initialize a new resource content","summary":"<p>Initialize a new resource content</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"text","external_name":"text","restriction":"String | ::Nil"},{"name":"blob","external_name":"blob","restriction":"String | ::Nil"}],"args_string":"(uri : String, mime_type : String | Nil, text : String | Nil, blob : String | Nil)","args_html":"(uri : String, mime_type : String | Nil, text : String | Nil, blob : String | Nil)","location":{"filename":"src/mocopo/resources.cr","line_number":95,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L95"},"def":{"name":"new","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"text","external_name":"text","restriction":"String | ::Nil"},{"name":"blob","external_name":"blob","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(uri, mime_type, text, blob)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"blob:String|Nil-instance-method","name":"blob","doc":"Binary content (if binary resource)","summary":"<p>Binary content (if binary resource)</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":82,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L82"},"def":{"name":"blob","return_type":"String | ::Nil","visibility":"Public","body":"@blob"},"external_var":false},{"html_id":"mime_type:String|Nil-instance-method","name":"mime_type","doc":"MIME type","summary":"<p>MIME type</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":76,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L76"},"def":{"name":"mime_type","return_type":"String | ::Nil","visibility":"Public","body":"@mime_type"},"external_var":false},{"html_id":"text:String|Nil-instance-method","name":"text","doc":"Text content (if text resource)","summary":"<p>Text content (if text resource)</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":79,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L79"},"def":{"name":"text","return_type":"String | ::Nil","visibility":"Public","body":"@text"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L99"},"def":{"name":"to_json_object","visibility":"Public","body":"result = {\"uri\" => @uri} of String => String | Nil\n\nresult[\"mimeType\"] = @mime_type\nresult[\"text\"] = @text\nresult[\"blob\"] = @blob\n\n\nresult.reject! do |_, v|\n  v.nil?\nend\n\nresult\n"},"external_var":false},{"html_id":"uri:String-instance-method","name":"uri","doc":"Resource URI","summary":"<p>Resource URI</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":73,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L73"},"def":{"name":"uri","return_type":"String","visibility":"Public","body":"@uri"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ResourceContentRef","path":"MocoPo/ResourceContentRef.html","kind":"class","full_name":"MocoPo::ResourceContentRef","name":"ResourceContentRef","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},"ancestors":[{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":49,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L49"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Resource content for messages","summary":"<p>Resource content for messages</p>","constructors":[{"html_id":"new(uri:String,resource:ResourceContent)-class-method","name":"new","doc":"Initialize a new resource content reference","summary":"<p>Initialize a new resource content reference</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"resource","external_name":"resource","restriction":"ResourceContent"}],"args_string":"(uri : String, resource : ResourceContent)","args_html":"(uri : String, resource : <a href=\"../MocoPo/ResourceContent.html\">ResourceContent</a>)","location":{"filename":"src/mocopo/prompts.cr","line_number":57,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L57"},"def":{"name":"new","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"resource","external_name":"resource","restriction":"ResourceContent"}],"visibility":"Public","body":"_ = allocate\n_.initialize(uri, resource)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"resource:ResourceContent-instance-method","name":"resource","doc":"Resource content","summary":"<p>Resource content</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":54,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L54"},"def":{"name":"resource","return_type":"ResourceContent","visibility":"Public","body":"@resource"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L61"},"def":{"name":"to_json_object","visibility":"Public","body":"{\"type\" => \"resource\", \"resource\" => @resource.to_json_object} of String => String | Hash(String, String | Nil)"},"external_var":false},{"html_id":"uri:String-instance-method","name":"uri","doc":"Resource URI","summary":"<p>Resource URI</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":51,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L51"},"def":{"name":"uri","return_type":"String","visibility":"Public","body":"@uri"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ResourceManager","path":"MocoPo/ResourceManager.html","kind":"class","full_name":"MocoPo::ResourceManager","name":"ResourceManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/resources.cr","line_number":114,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L114"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Manages resources for an MCP server","summary":"<p>Manages resources for an MCP server</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new resource manager","summary":"<p>Initialize a new resource manager</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":119,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L119"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"exists?(uri:String):Bool-instance-method","name":"exists?","doc":"Check if a resource exists","summary":"<p>Check if a resource exists</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String) : Bool","args_html":"(uri : String) : Bool","location":{"filename":"src/mocopo/resources.cr","line_number":152,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L152"},"def":{"name":"exists?","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@resources.has_key?(uri)"},"external_var":false},{"html_id":"get(uri:String):Resource|Nil-instance-method","name":"get","doc":"Get a resource by URI","summary":"<p>Get a resource by URI</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String) : Resource | Nil","args_html":"(uri : String) : <a href=\"../MocoPo/Resource.html\">Resource</a> | Nil","location":{"filename":"src/mocopo/resources.cr","line_number":142,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L142"},"def":{"name":"get","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"return_type":"Resource | ::Nil","visibility":"Public","body":"@resources[uri]?"},"external_var":false},{"html_id":"list:Array(Resource)-instance-method","name":"list","doc":"List all registered resources","summary":"<p>List all registered resources</p>","abstract":false,"location":{"filename":"src/mocopo/resources.cr","line_number":147,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L147"},"def":{"name":"list","return_type":"Array(Resource)","visibility":"Public","body":"@resources.values"},"external_var":false},{"html_id":"notify_resource_updated(uri:String)-instance-method","name":"notify_resource_updated","doc":"Notify subscribers that a resource has been updated","summary":"<p>Notify subscribers that a resource has been updated</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String)","args_html":"(uri : String)","location":{"filename":"src/mocopo/resources.cr","line_number":186,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L186"},"def":{"name":"notify_resource_updated","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"visibility":"Public","body":"if ((exists?(uri)) && (server = @server)) && (notification_manager = server.notification_manager)\n  notification_manager.resource_updated(uri)\nend"},"external_var":false},{"html_id":"register(resource:Resource)-instance-method","name":"register","doc":"Register a new resource","summary":"<p>Register a new resource</p>","abstract":false,"args":[{"name":"resource","external_name":"resource","restriction":"Resource"}],"args_string":"(resource : Resource)","args_html":"(resource : <a href=\"../MocoPo/Resource.html\">Resource</a>)","location":{"filename":"src/mocopo/resources.cr","line_number":131,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L131"},"def":{"name":"register","args":[{"name":"resource","external_name":"resource","restriction":"Resource"}],"visibility":"Public","body":"was_new = !(@resources.has_key?(resource.uri))\n@resources[resource.uri] = resource\n\n\nif (was_new && (server = @server)) && (notification_manager = server.notification_manager)\n  notification_manager.resources_list_changed\nend\n"},"external_var":false},{"html_id":"remove(uri:String)-instance-method","name":"remove","doc":"Remove a resource","summary":"<p>Remove a resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String)","args_html":"(uri : String)","location":{"filename":"src/mocopo/resources.cr","line_number":157,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L157"},"def":{"name":"remove","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"visibility":"Public","body":"if @resources.has_key?(uri)\n  @resources.delete(uri)\n\n\n  if (server = @server) && (notification_manager = server.notification_manager)\n    notification_manager.resources_list_changed\n  end\nend"},"external_var":false},{"html_id":"server=(server:Server)-instance-method","name":"server=","doc":"Set the server instance","summary":"<p>Set the server instance</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/resources.cr","line_number":126,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L126"},"def":{"name":"server=","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"@server = server"},"external_var":false},{"html_id":"subscribe(uri:String,subscriber_id:String)-instance-method","name":"subscribe","doc":"Subscribe to a resource","summary":"<p>Subscribe to a resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"subscriber_id","external_name":"subscriber_id","restriction":"String"}],"args_string":"(uri : String, subscriber_id : String)","args_html":"(uri : String, subscriber_id : String)","location":{"filename":"src/mocopo/resources.cr","line_number":169,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L169"},"def":{"name":"subscribe","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"subscriber_id","external_name":"subscriber_id","restriction":"String"}],"visibility":"Public","body":"__temp_181 = uri\n@subscribers[__temp_181]? || (@subscribers[__temp_181] = Set(String).new)\n@subscribers[uri].add(subscriber_id)\n"},"external_var":false},{"html_id":"subscribers(uri:String):Set(String)-instance-method","name":"subscribers","doc":"Get subscribers for a resource","summary":"<p>Get subscribers for a resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"}],"args_string":"(uri : String) : Set(String)","args_html":"(uri : String) : Set(String)","location":{"filename":"src/mocopo/resources.cr","line_number":181,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L181"},"def":{"name":"subscribers","args":[{"name":"uri","external_name":"uri","restriction":"String"}],"return_type":"Set(String)","visibility":"Public","body":"@subscribers[uri]? || Set(String).new"},"external_var":false},{"html_id":"unsubscribe(uri:String,subscriber_id:String)-instance-method","name":"unsubscribe","doc":"Unsubscribe from a resource","summary":"<p>Unsubscribe from a resource</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"subscriber_id","external_name":"subscriber_id","restriction":"String"}],"args_string":"(uri : String, subscriber_id : String)","args_html":"(uri : String, subscriber_id : String)","location":{"filename":"src/mocopo/resources.cr","line_number":175,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/resources.cr#L175"},"def":{"name":"unsubscribe","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"subscriber_id","external_name":"subscriber_id","restriction":"String"}],"visibility":"Public","body":"if @subscribers[uri]?\nelse\n  return\nend\n@subscribers[uri].delete(subscriber_id)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ResourcesHandler","path":"MocoPo/ResourcesHandler.html","kind":"class","full_name":"MocoPo::ResourcesHandler","name":"ResourcesHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for resources methods","summary":"<p>Handler for resources methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":118,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L118"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"ResourcesHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle resources/list request","summary":"<p>Handle resources/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L5"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"cursor = get_string_param(params, \"cursor\")\n\n\nresources = @server.resource_manager.list\n\n\npage_resources, next_cursor = Pagination.paginate(resources, cursor)\n\n\nresponse = {} of String => JsonValue\n\n\nresources_array = [] of JsonValue\npage_resources.each do |resource|\n  resource_json = resource.to_json_object\n  resource_json_str = resource_json.to_json\n  resource_json_value = (JSON.parse(resource_json_str)).as_h\n\n\n  resource_value = {} of String => JsonValue\n  resource_json_value.each do |k, v|\n    resource_value[k] = Utils.to_json_value(v)\n  end\n\n  resources_array << resource_value\nend\nresponse[\"resources\"] = resources_array\n\n\nif next_cursor\n  response[\"nextCursor\"] = next_cursor\nend\n\n\nsafe_success_response(id, response)\n"},"external_var":false},{"html_id":"handle_read(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_read","doc":"Handle resources/read request","summary":"<p>Handle resources/read request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":44,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L44"},"def":{"name":"handle_read","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"uri = get_string_param(params, \"uri\")\n\n\nif uri && (@server.resource_manager.exists?(uri))\nelse\n  return error_response(-32002, \"Resource not found: #{uri || \"missing uri\"}\", id)\nend\n\nbegin\n  resource = (@server.resource_manager.get(uri)).not_nil!\n\n\n  request_id = id.to_s\n  client_id = \"client-#{Random.new.hex(4)}\"\n  context = Context.new(request_id, client_id, @server)\n\n\n  content = resource.get_content(context)\n\n\n  response = {} of String => JsonValue\n\n\n  contents_array = [] of JsonValue\n\n\n  content_json = content.to_json_object\n  content_json_str = content_json.to_json\n  content_json_value = (JSON.parse(content_json_str)).as_h\n\n\n  content_value = {} of String => JsonValue\n  content_json_value.each do |k, v|\n    content_value[k] = Utils.to_json_value(v)\n  end\n\n  contents_array << content_value\n  response[\"contents\"] = contents_array\n\n\n  success_response(id, response)\nrescue ex\n  error_response(-32603, \"Error retrieving resource content: #{ex.message}\", id)\nend\n"},"external_var":false},{"html_id":"handle_subscribe(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_subscribe","doc":"Handle resources/subscribe request","summary":"<p>Handle resources/subscribe request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/resources_handler.cr","line_number":94,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/resources_handler.cr#L94"},"def":{"name":"handle_subscribe","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"uri = get_string_param(params, \"uri\")\n\n\nif uri && (@server.resource_manager.exists?(uri))\nelse\n  return error_response(-32002, \"Resource not found: #{uri || \"missing uri\"}\", id)\nend\n\n\nsubscriber_id = Random.new.hex(8)\n\n\n@server.resource_manager.subscribe(uri, subscriber_id)\n\n\nresponse = {} of String => JsonValue\nresponse[\"subscribed\"] = true\n\n\nsuccess_response(id, response)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Root","path":"MocoPo/Root.html","kind":"class","full_name":"MocoPo::Root","name":"Root","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L6"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root class for file system access","summary":"<p>Root class for file system access</p>","constructors":[{"html_id":"new(id:String,name:String,description:String,path:String,read_only:Bool=true)-class-method","name":"new","doc":"Initialize a new root","summary":"<p>Initialize a new root</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"args_string":"(id : String, name : String, description : String, path : String, read_only : Bool = true)","args_html":"(id : String, name : String, description : String, path : String, read_only : Bool = <span class=\"n\">true</span>)","location":{"filename":"src/mocopo/roots.cr","line_number":23,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L23"},"def":{"name":"new","args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"visibility":"Public","body":"_ = allocate\n_.initialize(id, name, description, path, read_only)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"absolute_path(relative_path:String):String-instance-method","name":"absolute_path","doc":"Get the absolute path from a relative path","summary":"<p>Get the absolute path from a relative path</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : String","args_html":"(relative_path : String) : String","location":{"filename":"src/mocopo/roots.cr","line_number":77,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L77"},"def":{"name":"absolute_path","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"String","visibility":"Public","body":"if relative_path.starts_with?(\"/\")\n  relative_path = relative_path[1..-1]\nend\n\n\npath = (Path.new(@path)).join(relative_path)\n(Path.posix(path)).to_s\n"},"external_var":false},{"html_id":"contains?(path:String):Bool-instance-method","name":"contains?","doc":"Check if a path is within this root","summary":"<p>Check if a path is within this root</p>","abstract":false,"args":[{"name":"path","external_name":"path","restriction":"String"}],"args_string":"(path : String) : Bool","args_html":"(path : String) : Bool","location":{"filename":"src/mocopo/roots.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L48"},"def":{"name":"contains?","args":[{"name":"path","external_name":"path","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"normalized_path = (Path.new(path)).expand\nnormalized_root = (Path.new(@path)).expand\n\n\nnormalized_path.to_s.starts_with?(normalized_root.to_s)\n"},"external_var":false},{"html_id":"create_directory(relative_path:String):Nil-instance-method","name":"create_directory","doc":"Create a directory","summary":"<p>Create a directory</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Nil","args_html":"(relative_path : String) : Nil","location":{"filename":"src/mocopo/roots.cr","line_number":170,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L170"},"def":{"name":"create_directory","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Nil","visibility":"Public","body":"if @read_only\n  raise(ArgumentError.new(\"Root is read-only: #{@id}\"))\nend\n\n\npath = Path.new(absolute_path(relative_path))\n\n\nFileUtils.mkdir_p(path.to_s)\n"},"external_var":false},{"html_id":"delete_directory(relative_path:String):Nil-instance-method","name":"delete_directory","doc":"Delete a directory","summary":"<p>Delete a directory</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Nil","args_html":"(relative_path : String) : Nil","location":{"filename":"src/mocopo/roots.cr","line_number":184,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L184"},"def":{"name":"delete_directory","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Nil","visibility":"Public","body":"if @read_only\n  raise(ArgumentError.new(\"Root is read-only: #{@id}\"))\nend\n\n\npath = Path.new(absolute_path(relative_path))\n\n\nif Dir.exists?(path.to_s)\nelse\n  raise(ArgumentError.new(\"Directory does not exist: #{relative_path}\"))\nend\n\n\nFileUtils.rm_rf(path.to_s)\n"},"external_var":false},{"html_id":"delete_file(relative_path:String):Nil-instance-method","name":"delete_file","doc":"Delete a file","summary":"<p>Delete a file</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Nil","args_html":"(relative_path : String) : Nil","location":{"filename":"src/mocopo/roots.cr","line_number":151,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L151"},"def":{"name":"delete_file","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Nil","visibility":"Public","body":"if @read_only\n  raise(ArgumentError.new(\"Root is read-only: #{@id}\"))\nend\n\n\npath = Path.new(absolute_path(relative_path))\n\n\nif (File.exists?(path.to_s)) && !(Dir.exists?(path.to_s))\nelse\n  raise(ArgumentError.new(\"File does not exist: #{relative_path}\"))\nend\n\n\nFile.delete(path.to_s)\n"},"external_var":false},{"html_id":"description:String-instance-method","name":"description","doc":"Root description","summary":"<p>Root description</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L14"},"def":{"name":"description","return_type":"String","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"directory_exists?(relative_path:String):Bool-instance-method","name":"directory_exists?","doc":"Check if a directory exists","summary":"<p>Check if a directory exists</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Bool","args_html":"(relative_path : String) : Bool","location":{"filename":"src/mocopo/roots.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L96"},"def":{"name":"directory_exists?","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"path = Path.new(absolute_path(relative_path))\n\n\nDir.exists?(path.to_s)\n"},"external_var":false},{"html_id":"file_exists?(relative_path:String):Bool-instance-method","name":"file_exists?","doc":"Check if a file exists","summary":"<p>Check if a file exists</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Bool","args_html":"(relative_path : String) : Bool","location":{"filename":"src/mocopo/roots.cr","line_number":87,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L87"},"def":{"name":"file_exists?","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"path = Path.new(absolute_path(relative_path))\n\n\n(File.exists?(path.to_s)) && !(Dir.exists?(path.to_s))\n"},"external_var":false},{"html_id":"id:String-instance-method","name":"id","doc":"Root ID","summary":"<p>Root ID</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L8"},"def":{"name":"id","return_type":"String","visibility":"Public","body":"@id"},"external_var":false},{"html_id":"list_directory(relative_path:String):Array(String)-instance-method","name":"list_directory","doc":"List files in a directory","summary":"<p>List files in a directory</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : Array(String)","args_html":"(relative_path : String) : Array(String)","location":{"filename":"src/mocopo/roots.cr","line_number":105,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L105"},"def":{"name":"list_directory","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"Array(String)","visibility":"Public","body":"path = Path.new(absolute_path(relative_path))\n\n\nif Dir.exists?(path.to_s)\nelse\n  raise(ArgumentError.new(\"Directory does not exist: #{relative_path}\"))\nend\n\n\n(Dir.entries(path.to_s)).reject do |entry|\n  (entry == \".\") || (entry == \"..\")\nend\n"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Root name","summary":"<p>Root name</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L11"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"path:String-instance-method","name":"path","doc":"Root path","summary":"<p>Root path</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L17"},"def":{"name":"path","return_type":"String","visibility":"Public","body":"@path"},"external_var":false},{"html_id":"read_file(relative_path:String):String-instance-method","name":"read_file","doc":"Read a file","summary":"<p>Read a file</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(relative_path : String) : String","args_html":"(relative_path : String) : String","location":{"filename":"src/mocopo/roots.cr","line_number":119,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L119"},"def":{"name":"read_file","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"String","visibility":"Public","body":"path = Path.new(absolute_path(relative_path))\n\n\nif (File.exists?(path.to_s)) && !(Dir.exists?(path.to_s))\nelse\n  raise(ArgumentError.new(\"File does not exist: #{relative_path}\"))\nend\n\n\nFile.read(path.to_s)\n"},"external_var":false},{"html_id":"read_only:Bool-instance-method","name":"read_only","doc":"Root read-only flag","summary":"<p>Root read-only flag</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":20,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L20"},"def":{"name":"read_only","return_type":"Bool","visibility":"Public","body":"@read_only"},"external_var":false},{"html_id":"relative_path(path:String):String-instance-method","name":"relative_path","doc":"Get the relative path from this root","summary":"<p>Get the relative path from this root</p>","abstract":false,"args":[{"name":"path","external_name":"path","restriction":"String"}],"args_string":"(path : String) : String","args_html":"(path : String) : String","location":{"filename":"src/mocopo/roots.cr","line_number":58,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L58"},"def":{"name":"relative_path","args":[{"name":"path","external_name":"path","restriction":"String"}],"return_type":"String","visibility":"Public","body":"normalized_path = (Path.new(path)).expand\nnormalized_root = (Path.new(@path)).expand\n\nif normalized_path.to_s.starts_with?(normalized_root.to_s)\nelse\n  raise(ArgumentError.new(\"Path is not within root: #{path}\"))\nend\n\n\nrel_path = normalized_path.to_s[normalized_root.to_s.size..-1]\n\n\nposix_path = (Path.posix(rel_path)).to_s\nposix_path = \"/\" + (posix_path.lstrip('/'))\nposix_path\n"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":38,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L38"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"id\" => @id, \"name\" => @name, \"description\" => @description, \"readOnly\" => @read_only} of String => JsonValue"},"external_var":false},{"html_id":"write_file(relative_path:String,content:String):Nil-instance-method","name":"write_file","doc":"Write a file","summary":"<p>Write a file</p>","abstract":false,"args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"},{"name":"content","external_name":"content","restriction":"String"}],"args_string":"(relative_path : String, content : String) : Nil","args_html":"(relative_path : String, content : String) : Nil","location":{"filename":"src/mocopo/roots.cr","line_number":133,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L133"},"def":{"name":"write_file","args":[{"name":"relative_path","external_name":"relative_path","restriction":"String"},{"name":"content","external_name":"content","restriction":"String"}],"return_type":"Nil","visibility":"Public","body":"if @read_only\n  raise(ArgumentError.new(\"Root is read-only: #{@id}\"))\nend\n\n\npath = Path.new(absolute_path(relative_path))\n\n\nparent_dir = path.parent\nFileUtils.mkdir_p(parent_dir.to_s)\n\n\nFile.write(path.to_s, content)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootDirectoryListing","path":"MocoPo/RootDirectoryListing.html","kind":"class","full_name":"MocoPo::RootDirectoryListing","name":"RootDirectoryListing","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":350,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L350"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root directory listing class","summary":"<p>Root directory listing class</p>","constructors":[{"html_id":"new(root_id:String,path:String,files:Array(RootFileInfo))-class-method","name":"new","doc":"Initialize a new directory listing","summary":"<p>Initialize a new directory listing</p>","abstract":false,"args":[{"name":"root_id","external_name":"root_id","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"files","external_name":"files","restriction":"Array(RootFileInfo)"}],"args_string":"(root_id : String, path : String, files : Array(RootFileInfo))","args_html":"(root_id : String, path : String, files : Array(<a href=\"../MocoPo/RootFileInfo.html\">RootFileInfo</a>))","location":{"filename":"src/mocopo/roots.cr","line_number":361,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L361"},"def":{"name":"new","args":[{"name":"root_id","external_name":"root_id","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"files","external_name":"files","restriction":"Array(RootFileInfo)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(root_id, path, files)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"files:Array(RootFileInfo)-instance-method","name":"files","doc":"Files","summary":"<p>Files</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":358,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L358"},"def":{"name":"files","return_type":"Array(RootFileInfo)","visibility":"Public","body":"@files"},"external_var":false},{"html_id":"path:String-instance-method","name":"path","doc":"Directory path","summary":"<p>Directory path</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":355,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L355"},"def":{"name":"path","return_type":"String","visibility":"Public","body":"@path"},"external_var":false},{"html_id":"root_id:String-instance-method","name":"root_id","doc":"Root ID","summary":"<p>Root ID</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":352,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L352"},"def":{"name":"root_id","return_type":"String","visibility":"Public","body":"@root_id"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":365,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L365"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"files_array = [] of JsonValue\n@files.each do |file|\n  files_array << file.to_json_object\nend\n\n{\"rootId\" => @root_id, \"path\" => @path, \"files\" => files_array} of String => JsonValue\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootError","path":"MocoPo/RootError.html","kind":"class","full_name":"MocoPo::RootError","name":"RootError","abstract":false,"superclass":{"html_id":"mocopo/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"mocopo/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":288,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L288"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root error class","summary":"<p>Root error class</p>","constructors":[{"html_id":"new(code:Int32,message:String)-class-method","name":"new","doc":"Initialize a new root error","summary":"<p>Initialize a new root error</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"Int32"},{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(code : Int32, message : String)","args_html":"(code : Int32, message : String)","location":{"filename":"src/mocopo/roots.cr","line_number":293,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L293"},"def":{"name":"new","args":[{"name":"code","external_name":"code","restriction":"Int32"},{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(code, message)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"code:Int32-instance-method","name":"code","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":290,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L290"},"def":{"name":"code","return_type":"Int32","visibility":"Public","body":"@code"},"external_var":false},{"html_id":"code=(code:Int32)-instance-method","name":"code=","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"Int32"}],"args_string":"(code : Int32)","args_html":"(code : Int32)","location":{"filename":"src/mocopo/roots.cr","line_number":290,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L290"},"def":{"name":"code=","args":[{"name":"code","external_name":"code","restriction":"Int32"}],"visibility":"Public","body":"@code = code"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootFileContent","path":"MocoPo/RootFileContent.html","kind":"class","full_name":"MocoPo::RootFileContent","name":"RootFileContent","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":380,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L380"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root file content class","summary":"<p>Root file content class</p>","constructors":[{"html_id":"new(root_id:String,path:String,content:String)-class-method","name":"new","doc":"Initialize a new file content","summary":"<p>Initialize a new file content</p>","abstract":false,"args":[{"name":"root_id","external_name":"root_id","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"content","external_name":"content","restriction":"String"}],"args_string":"(root_id : String, path : String, content : String)","args_html":"(root_id : String, path : String, content : String)","location":{"filename":"src/mocopo/roots.cr","line_number":391,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L391"},"def":{"name":"new","args":[{"name":"root_id","external_name":"root_id","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"content","external_name":"content","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(root_id, path, content)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"content:String-instance-method","name":"content","doc":"File content","summary":"<p>File content</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":388,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L388"},"def":{"name":"content","return_type":"String","visibility":"Public","body":"@content"},"external_var":false},{"html_id":"path:String-instance-method","name":"path","doc":"File path","summary":"<p>File path</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":385,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L385"},"def":{"name":"path","return_type":"String","visibility":"Public","body":"@path"},"external_var":false},{"html_id":"root_id:String-instance-method","name":"root_id","doc":"Root ID","summary":"<p>Root ID</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":382,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L382"},"def":{"name":"root_id","return_type":"String","visibility":"Public","body":"@root_id"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":395,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L395"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"rootId\" => @root_id, \"path\" => @path, \"content\" => @content} of String => JsonValue"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootFileInfo","path":"MocoPo/RootFileInfo.html","kind":"class","full_name":"MocoPo::RootFileInfo","name":"RootFileInfo","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":299,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L299"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root file info class","summary":"<p>Root file info class</p>","constructors":[{"html_id":"from_file(path:String,relative_path:String):RootFileInfo-class-method","name":"from_file","doc":"Create from a file path","summary":"<p>Create from a file path</p>","abstract":false,"args":[{"name":"path","external_name":"path","restriction":"String"},{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"args_string":"(path : String, relative_path : String) : RootFileInfo","args_html":"(path : String, relative_path : String) : <a href=\"../MocoPo/RootFileInfo.html\">RootFileInfo</a>","location":{"filename":"src/mocopo/roots.cr","line_number":331,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L331"},"def":{"name":"from_file","args":[{"name":"path","external_name":"path","restriction":"String"},{"name":"relative_path","external_name":"relative_path","restriction":"String"}],"return_type":"RootFileInfo","visibility":"Public","body":"stat = File.info(path)\n\n\ntype = stat.directory? ? \"directory\" : \"file\"\n\n\nnew(name: File.basename(path), path: relative_path, type: type, size: stat.size, modified: stat.modification_time)\n"},"external_var":false},{"html_id":"new(name:String,path:String,type:String,size:Int64,modified:Time)-class-method","name":"new","doc":"Initialize a new file info","summary":"<p>Initialize a new file info</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"type","external_name":"type","restriction":"String"},{"name":"size","external_name":"size","restriction":"Int64"},{"name":"modified","external_name":"modified","restriction":"Time"}],"args_string":"(name : String, path : String, type : String, size : Int64, modified : Time)","args_html":"(name : String, path : String, type : String, size : Int64, modified : Time)","location":{"filename":"src/mocopo/roots.cr","line_number":316,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L316"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"type","external_name":"type","restriction":"String"},{"name":"size","external_name":"size","restriction":"Int64"},{"name":"modified","external_name":"modified","restriction":"Time"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, path, type, size, modified)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"modified:Time-instance-method","name":"modified","doc":"File modification time","summary":"<p>File modification time</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":313,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L313"},"def":{"name":"modified","return_type":"Time","visibility":"Public","body":"@modified"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"File name","summary":"<p>File name</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":301,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L301"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"path:String-instance-method","name":"path","doc":"File path","summary":"<p>File path</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":304,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L304"},"def":{"name":"path","return_type":"String","visibility":"Public","body":"@path"},"external_var":false},{"html_id":"size:Int64-instance-method","name":"size","doc":"File size","summary":"<p>File size</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":310,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L310"},"def":{"name":"size","return_type":"Int64","visibility":"Public","body":"@size"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":320,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L320"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"name\" => @name, \"path\" => @path, \"type\" => @type, \"size\" => @size.to_i32, \"modified\" => @modified.to_unix.to_i32} of String => JsonValue"},"external_var":false},{"html_id":"type:String-instance-method","name":"type","doc":"File type","summary":"<p>File type</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":307,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L307"},"def":{"name":"type","return_type":"String","visibility":"Public","body":"@type"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootManager","path":"MocoPo/RootManager.html","kind":"class","full_name":"MocoPo::RootManager","name":"RootManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/roots.cr","line_number":204,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L204"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Root manager","summary":"<p>Root manager</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new root manager","summary":"<p>Initialize a new root manager</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":209,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L209"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"exists?(id:String):Bool-instance-method","name":"exists?","doc":"Check if a root exists","summary":"<p>Check if a root exists</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","args_html":"(id : String) : Bool","location":{"filename":"src/mocopo/roots.cr","line_number":248,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L248"},"def":{"name":"exists?","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@roots.has_key?(id)"},"external_var":false},{"html_id":"find_root_for_path(path:String):Root|Nil-instance-method","name":"find_root_for_path","doc":"Find a root that contains a path","summary":"<p>Find a root that contains a path</p>","abstract":false,"args":[{"name":"path","external_name":"path","restriction":"String"}],"args_string":"(path : String) : Root | Nil","args_html":"(path : String) : <a href=\"../MocoPo/Root.html\">Root</a> | Nil","location":{"filename":"src/mocopo/roots.cr","line_number":263,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L263"},"def":{"name":"find_root_for_path","args":[{"name":"path","external_name":"path","restriction":"String"}],"return_type":"Root | ::Nil","visibility":"Public","body":"normalized_path = (Path.new(path)).expand\n\n\n@roots.values.find do |root|\n  root.contains?(normalized_path.to_s)\nend\n"},"external_var":false},{"html_id":"get(id:String):Root|Nil-instance-method","name":"get","doc":"Get a root","summary":"<p>Get a root</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Root | Nil","args_html":"(id : String) : <a href=\"../MocoPo/Root.html\">Root</a> | Nil","location":{"filename":"src/mocopo/roots.cr","line_number":253,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L253"},"def":{"name":"get","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Root | ::Nil","visibility":"Public","body":"@roots[id]?"},"external_var":false},{"html_id":"get_root_and_relative_path(path:String):Tuple(Root,String)|Nil-instance-method","name":"get_root_and_relative_path","doc":"Get the root and relative path for a path","summary":"<p>Get the root and relative path for a path</p>","abstract":false,"args":[{"name":"path","external_name":"path","restriction":"String"}],"args_string":"(path : String) : Tuple(Root, String) | Nil","args_html":"(path : String) : Tuple(<a href=\"../MocoPo/Root.html\">Root</a>, String) | Nil","location":{"filename":"src/mocopo/roots.cr","line_number":272,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L272"},"def":{"name":"get_root_and_relative_path","args":[{"name":"path","external_name":"path","restriction":"String"}],"return_type":"::Tuple(Root, String) | ::Nil","visibility":"Public","body":"root = find_root_for_path(path)\n\n\nif root\nelse\n  return nil\nend\n\n\nrelative_path = root.relative_path(path)\n\n\n{root, relative_path}\n"},"external_var":false},{"html_id":"list:Array(Root)-instance-method","name":"list","doc":"List all roots","summary":"<p>List all roots</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":258,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L258"},"def":{"name":"list","return_type":"Array(Root)","visibility":"Public","body":"@roots.values"},"external_var":false},{"html_id":"register(id:String,name:String,description:String,path:String,read_only:Bool=true):Root-instance-method","name":"register","doc":"Register a root with parameters","summary":"<p>Register a root with parameters</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"args_string":"(id : String, name : String, description : String, path : String, read_only : Bool = true) : Root","args_html":"(id : String, name : String, description : String, path : String, read_only : Bool = <span class=\"n\">true</span>) : <a href=\"../MocoPo/Root.html\">Root</a>","location":{"filename":"src/mocopo/roots.cr","line_number":228,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L228"},"def":{"name":"register","args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"return_type":"Root","visibility":"Public","body":"root = Root.new(id, name, description, path, read_only)\n\n\nregister(root)\n"},"external_var":false},{"html_id":"register(root:Root):Root-instance-method","name":"register","doc":"Register a root","summary":"<p>Register a root</p>","abstract":false,"args":[{"name":"root","external_name":"root","restriction":"Root"}],"args_string":"(root : Root) : Root","args_html":"(root : <a href=\"../MocoPo/Root.html\">Root</a>) : <a href=\"../MocoPo/Root.html\">Root</a>","location":{"filename":"src/mocopo/roots.cr","line_number":214,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L214"},"def":{"name":"register","args":[{"name":"root","external_name":"root","restriction":"Root"}],"return_type":"Root","visibility":"Public","body":"if @roots.has_key?(root.id)\n  raise(ArgumentError.new(\"Root ID already exists: #{root.id}\"))\nend\n\n\n@roots[root.id] = root\n\n\nroot\n"},"external_var":false},{"html_id":"unregister(id:String):Nil-instance-method","name":"unregister","doc":"Unregister a root","summary":"<p>Unregister a root</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Nil","args_html":"(id : String) : Nil","location":{"filename":"src/mocopo/roots.cr","line_number":237,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L237"},"def":{"name":"unregister","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Nil","visibility":"Public","body":"if @roots.has_key?(id)\nelse\n  raise(ArgumentError.new(\"Root does not exist: #{id}\"))\nend\n\n\n@roots.delete(id)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/RootsHandler","path":"MocoPo/RootsHandler.html","kind":"class","full_name":"MocoPo::RootsHandler","name":"RootsHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for roots methods","summary":"<p>Handler for roots methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,method:String,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request with method","summary":"<p>Handle a JSON-RPC request with method</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"method","external_name":"method","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, method : String, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, method : String, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":302,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L302"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"method","external_name":"method","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"case method\nwhen \"roots/list\"\n  handle_list(id, params)\nwhen \"roots/listDirectory\"\n  handle_list_directory(id, params)\nwhen \"roots/readFile\"\n  handle_read_file(id, params)\nwhen \"roots/writeFile\"\n  handle_write_file(id, params)\nwhen \"roots/deleteFile\"\n  handle_delete_file(id, params)\nwhen \"roots/createDirectory\"\n  handle_create_directory(id, params)\nwhen \"roots/deleteDirectory\"\n  handle_delete_directory(id, params)\nelse\n  error_response(-32601, \"Method not found: #{method}\", id)\nend"},"external_var":false},{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":296,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L296"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"RootsHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_create_directory(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_create_directory","doc":"Handle roots/createDirectory request","summary":"<p>Handle roots/createDirectory request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":218,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L218"},"def":{"name":"handle_create_directory","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  root.create_directory(path)\n\n\n  success_response(id, {} of String => JsonValue)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error creating directory: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_delete_directory(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_delete_directory","doc":"Handle roots/deleteDirectory request","summary":"<p>Handle roots/deleteDirectory request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":257,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L257"},"def":{"name":"handle_delete_directory","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  root.delete_directory(path)\n\n\n  success_response(id, {} of String => JsonValue)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error deleting directory: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_delete_file(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_delete_file","doc":"Handle roots/deleteFile request","summary":"<p>Handle roots/deleteFile request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":179,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L179"},"def":{"name":"handle_delete_file","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  root.delete_file(path)\n\n\n  success_response(id, {} of String => JsonValue)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error deleting file: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle roots/list request","summary":"<p>Handle roots/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L5"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"roots = @server.root_manager.list\n\n\nroots_array = [] of JsonValue\nroots.each do |root|\n  roots_array << root.to_json_object\nend\n\n\nresult = {} of String => JsonValue\nresult[\"roots\"] = roots_array\nsuccess_response(id, result)\n"},"external_var":false},{"html_id":"handle_list_directory(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list_directory","doc":"Handle roots/listDirectory request","summary":"<p>Handle roots/listDirectory request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L22"},"def":{"name":"handle_list_directory","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  if root.directory_exists?(path)\n  else\n    return error_response(-32602, \"Directory does not exist: #{path}\", id)\n  end\n\n\n  absolute_path = root.absolute_path(path)\n\n\n  entries = root.list_directory(path)\n\n\n  files = [] of RootFileInfo\n  entries.each do |entry|\n    entry_path = File.join(path, entry)\n    if entry_path.starts_with?(\"//\")\n      entry_path = entry_path[1..-1]\n    end\n    if entry_path.starts_with?(\"/\")\n    else\n      entry_path = \"/#{entry_path}\"\n    end\n\n\n    absolute_entry_path = root.absolute_path(entry_path)\n\n\n    files << (RootFileInfo.from_file(absolute_entry_path, entry_path))\n  end\n\n\n  listing = RootDirectoryListing.new(root_id, path, files)\n\n\n  success_response(id, listing.to_json_object)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error listing directory: #{ex.message}\", id)\nend"},"external_var":false},{"html_id":"handle_read_file(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_read_file","doc":"Handle roots/readFile request","summary":"<p>Handle roots/readFile request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":87,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L87"},"def":{"name":"handle_read_file","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  if root.file_exists?(path)\n  else\n    return error_response(-32602, \"File does not exist: #{path}\", id)\n  end\n\n\n  content = root.read_file(path)\n\n\n  file_content = RootFileContent.new(root_id, path, content)\n\n\n  success_response(id, file_content.to_json_object)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error reading file: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false},{"html_id":"handle_write_file(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_write_file","doc":"Handle roots/writeFile request","summary":"<p>Handle roots/writeFile request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/roots_handler.cr","line_number":134,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/roots_handler.cr#L134"},"def":{"name":"handle_write_file","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  root_id = MocoPo.safe_string(params[\"rootId\"]?)\n  path = MocoPo.safe_string(params[\"path\"]?)\n  content = MocoPo.safe_string(params[\"content\"]?)\n\n\n  if root_id && (@server.root_manager.exists?(root_id))\n  else\n    return error_response(-32602, \"Unknown root ID: #{root_id || \"missing root ID\"}\", id)\n  end\n\n\n  root = (@server.root_manager.get(root_id)).not_nil!\n\n\n  if path\n  else\n    return error_response(-32602, \"Missing path parameter\", id)\n  end\n\n\n  if content\n  else\n    return error_response(-32602, \"Missing content parameter\", id)\n  end\n\n\n  root.write_file(path, content)\n\n\n  success_response(id, {} of String => JsonValue)\nrescue ex : ArgumentError\n  error_response(-32602, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error writing file: #{ex.message || \"Unknown error\"}\", id)\nend"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingError","path":"MocoPo/SamplingError.html","kind":"class","full_name":"MocoPo::SamplingError","name":"SamplingError","abstract":false,"superclass":{"html_id":"mocopo/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"mocopo/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":626,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L626"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Sampling error class","summary":"<p>Sampling error class</p>","constructors":[{"html_id":"new(code:Int32,message:String)-class-method","name":"new","doc":"Initialize a new sampling error","summary":"<p>Initialize a new sampling error</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"Int32"},{"name":"message","external_name":"message","restriction":"String"}],"args_string":"(code : Int32, message : String)","args_html":"(code : Int32, message : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":631,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L631"},"def":{"name":"new","args":[{"name":"code","external_name":"code","restriction":"Int32"},{"name":"message","external_name":"message","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(code, message)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"code:Int32-instance-method","name":"code","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":628,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L628"},"def":{"name":"code","return_type":"Int32","visibility":"Public","body":"@code"},"external_var":false},{"html_id":"code=(code:Int32)-instance-method","name":"code=","doc":"Error code","summary":"<p>Error code</p>","abstract":false,"args":[{"name":"code","external_name":"code","restriction":"Int32"}],"args_string":"(code : Int32)","args_html":"(code : Int32)","location":{"filename":"src/mocopo/sampling.cr","line_number":628,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L628"},"def":{"name":"code=","args":[{"name":"code","external_name":"code","restriction":"Int32"}],"visibility":"Public","body":"@code = code"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingHandler","path":"MocoPo/SamplingHandler.html","kind":"class","full_name":"MocoPo::SamplingHandler","name":"SamplingHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for sampling methods","summary":"<p>Handler for sampling methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":128,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L128"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"SamplingHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_create_message(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_create_message","doc":"Handle sampling/createMessage request","summary":"<p>Handle sampling/createMessage request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":61,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L61"},"def":{"name":"handle_create_message","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"begin\n  if params\n  else\n    return error_response(-32602, \"Missing parameters\", id)\n  end\n\n\n  request = SamplingRequest.from_json_object(params)\n\n\n  validation_error = validate_request(request)\n  if validation_error\n    return error_response(-32602, validation_error, id)\n  end\n\n\n  request_id = id.to_s\n  client_id = \"client-#{Random.new.hex(4)}\"\n  context = Context.new(request_id, client_id, @server)\n\n\n  context.info(\"Processing sampling/createMessage request\")\n\n\n  response = @server.sampling_manager.create_message(request, context)\n\n\n  success_response(id, response.to_json_object.as(JsonValue))\nrescue ex : SamplingError\n  error_response(ex.code, ex.message || \"Unknown error\", id)\nrescue ex\n  error_response(-32603, \"Error creating message: #{ex.message}\", id)\nend"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle sampling/list request","summary":"<p>Handle sampling/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L5"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"methods = @server.sampling_manager.list\n\n\nmethods_array = [] of JsonValue\nmethods.each do |method|\n  methods_array << (method.to_json_object.as(JsonValue))\nend\n\n\nresult = {} of String => JsonValue\nresult[\"methods\"] = methods_array\nsuccess_response(id, result)\n"},"external_var":false},{"html_id":"handle_sample(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_sample","doc":"Handle sampling/sample request","summary":"<p>Handle sampling/sample request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/sampling_handler.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/sampling_handler.cr#L22"},"def":{"name":"handle_sample","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"method_name = MocoPo.safe_string(params.try(&.[]?(\"method\")))\ntext = MocoPo.safe_string(params.try(&.[]?(\"text\")))\nparameters = MocoPo.safe_hash(params.try(&.[]?(\"parameters\")))\n\n\nif method_name && (@server.sampling_manager.exists?(method_name))\nelse\n  return error_response(-32602, \"Unknown sampling method: #{method_name || \"missing method\"}\", id)\nend\n\nif text\nelse\n  return error_response(-32602, \"Missing text parameter\", id)\nend\n\n\nmethod = (@server.sampling_manager.get(method_name)).not_nil!\n\nbegin\n  request_id = id.to_s\n  client_id = \"client-#{Random.new.hex(4)}\"\n  context = Context.new(request_id, client_id, @server)\n\n\n  raw_result = method.sample(text, parameters, context)\n\n\n  result = Utils.ensure_json_value(raw_result)\n\n\n  success_response(id, result)\nrescue ex\n  error_response(-32603, \"Error sampling: #{ex.message}\", id)\nend\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingManager","path":"MocoPo/SamplingManager.html","kind":"class","full_name":"MocoPo::SamplingManager","name":"SamplingManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":637,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L637"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Sampling manager","summary":"<p>Sampling manager</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new sampling manager","summary":"<p>Initialize a new sampling manager</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":642,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L642"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"create_message(request:SamplingRequest,context:Context):SamplingResponse-instance-method","name":"create_message","doc":"Create a message (dummy implementation)","summary":"<p>Create a message (dummy implementation)</p>","abstract":false,"args":[{"name":"request","external_name":"request","restriction":"SamplingRequest"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(request : SamplingRequest, context : Context) : SamplingResponse","args_html":"(request : <a href=\"../MocoPo/SamplingRequest.html\">SamplingRequest</a>, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/SamplingResponse.html\">SamplingResponse</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":673,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L673"},"def":{"name":"create_message","args":[{"name":"request","external_name":"request","restriction":"SamplingRequest"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"SamplingResponse","visibility":"Public","body":"if request.messages.empty?\n  raise(SamplingError.new(-32602, \"No messages provided\"))\nend\n\n\nlast_message = request.messages.last\n\n\nresponse_text = \"This is a dummy response to: #{last_message.content.text}\"\n\n\nSamplingResponse.new(\"assistant\", SamplingMessageContent.text(response_text), \"dummy-model-v1\", \"endTurn\")\n"},"external_var":false},{"html_id":"exists?(name:String):Bool-instance-method","name":"exists?","doc":"Check if a sampling method exists","summary":"<p>Check if a sampling method exists</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Bool","args_html":"(name : String) : Bool","location":{"filename":"src/mocopo/sampling.cr","line_number":658,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L658"},"def":{"name":"exists?","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@methods.has_key?(name)"},"external_var":false},{"html_id":"get(name:String):SamplingMethod|Nil-instance-method","name":"get","doc":"Get a sampling method","summary":"<p>Get a sampling method</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : SamplingMethod | Nil","args_html":"(name : String) : <a href=\"../MocoPo/SamplingMethod.html\">SamplingMethod</a> | Nil","location":{"filename":"src/mocopo/sampling.cr","line_number":663,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L663"},"def":{"name":"get","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"SamplingMethod | ::Nil","visibility":"Public","body":"@methods[name]?"},"external_var":false},{"html_id":"list:Array(SamplingMethod)-instance-method","name":"list","doc":"Get all sampling methods","summary":"<p>Get all sampling methods</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":668,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L668"},"def":{"name":"list","return_type":"Array(SamplingMethod)","visibility":"Public","body":"@methods.values"},"external_var":false},{"html_id":"register(method:SamplingMethod)-instance-method","name":"register","doc":"Register a sampling method","summary":"<p>Register a sampling method</p>","abstract":false,"args":[{"name":"method","external_name":"method","restriction":"SamplingMethod"}],"args_string":"(method : SamplingMethod)","args_html":"(method : <a href=\"../MocoPo/SamplingMethod.html\">SamplingMethod</a>)","location":{"filename":"src/mocopo/sampling.cr","line_number":653,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L653"},"def":{"name":"register","args":[{"name":"method","external_name":"method","restriction":"SamplingMethod"}],"visibility":"Public","body":"@methods[method.name] = method"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingMessage","path":"MocoPo/SamplingMessage.html","kind":"class","full_name":"MocoPo::SamplingMessage","name":"SamplingMessage","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":161,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L161"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Message class for sampling","summary":"<p>Message class for sampling</p>","constructors":[{"html_id":"assistant_text(text:String):SamplingMessage-class-method","name":"assistant_text","doc":"Create an assistant message with text content","summary":"<p>Create an assistant message with text content</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"}],"args_string":"(text : String) : SamplingMessage","args_html":"(text : String) : <a href=\"../MocoPo/SamplingMessage.html\">SamplingMessage</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":178,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L178"},"def":{"name":"assistant_text","args":[{"name":"text","external_name":"text","restriction":"String"}],"return_type":"SamplingMessage","visibility":"Public","body":"new(\"assistant\", SamplingMessageContent.text(text))"},"external_var":false},{"html_id":"from_json_object(json:JsonObject):SamplingMessage-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : SamplingMessage","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/SamplingMessage.html\">SamplingMessage</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":191,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L191"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"SamplingMessage","visibility":"Public","body":"begin\n  role = (MocoPo.safe_string(json[\"role\"]?)) || \"user\"\n\n  content_json = (MocoPo.safe_hash(json[\"content\"]?)) || ({} of String => JsonValue)\n  content = SamplingMessageContent.from_json_object(content_json)\n\n  new(role, content)\nrescue ex\n  user_text(\"\")\nend"},"external_var":false},{"html_id":"new(role:String,content:SamplingMessageContent)-class-method","name":"new","doc":"Initialize a new message","summary":"<p>Initialize a new message</p>","abstract":false,"args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"args_string":"(role : String, content : SamplingMessageContent)","args_html":"(role : String, content : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>)","location":{"filename":"src/mocopo/sampling.cr","line_number":169,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L169"},"def":{"name":"new","args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"visibility":"Public","body":"_ = allocate\n_.initialize(role, content)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"user_text(text:String):SamplingMessage-class-method","name":"user_text","doc":"Create a user message with text content","summary":"<p>Create a user message with text content</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"}],"args_string":"(text : String) : SamplingMessage","args_html":"(text : String) : <a href=\"../MocoPo/SamplingMessage.html\">SamplingMessage</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":173,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L173"},"def":{"name":"user_text","args":[{"name":"text","external_name":"text","restriction":"String"}],"return_type":"SamplingMessage","visibility":"Public","body":"new(\"user\", SamplingMessageContent.text(text))"},"external_var":false}],"instance_methods":[{"html_id":"content:SamplingMessageContent-instance-method","name":"content","doc":"Content","summary":"<p>Content</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":166,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L166"},"def":{"name":"content","return_type":"SamplingMessageContent","visibility":"Public","body":"@content"},"external_var":false},{"html_id":"content=(content:SamplingMessageContent)-instance-method","name":"content=","doc":"Content","summary":"<p>Content</p>","abstract":false,"args":[{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"args_string":"(content : SamplingMessageContent)","args_html":"(content : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>)","location":{"filename":"src/mocopo/sampling.cr","line_number":166,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L166"},"def":{"name":"content=","args":[{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"visibility":"Public","body":"@content = content"},"external_var":false},{"html_id":"role:String-instance-method","name":"role","doc":"Role (user or assistant)","summary":"<p>Role (user or assistant)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":163,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L163"},"def":{"name":"role","return_type":"String","visibility":"Public","body":"@role"},"external_var":false},{"html_id":"role=(role:String)-instance-method","name":"role=","doc":"Role (user or assistant)","summary":"<p>Role (user or assistant)</p>","abstract":false,"args":[{"name":"role","external_name":"role","restriction":"String"}],"args_string":"(role : String)","args_html":"(role : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":163,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L163"},"def":{"name":"role=","args":[{"name":"role","external_name":"role","restriction":"String"}],"visibility":"Public","body":"@role = role"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":183,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L183"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"{\"role\" => @role, \"content\" => @content.to_json_object} of String => JsonValue"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingMessageContent","path":"MocoPo/SamplingMessageContent.html","kind":"class","full_name":"MocoPo::SamplingMessageContent","name":"SamplingMessageContent","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":88,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L88"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Message content class for sampling","summary":"<p>Message content class for sampling</p>","constructors":[{"html_id":"audio(data:String,mime_type:String):SamplingMessageContent-class-method","name":"audio","doc":"Create an audio content","summary":"<p>Create an audio content</p>","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"args_string":"(data : String, mime_type : String) : SamplingMessageContent","args_html":"(data : String, mime_type : String) : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":116,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L116"},"def":{"name":"audio","args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"return_type":"SamplingMessageContent","visibility":"Public","body":"new(\"audio\", nil, data, mime_type)"},"external_var":false},{"html_id":"from_json_object(json:JsonObject):SamplingMessageContent-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : SamplingMessageContent","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":136,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L136"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"SamplingMessageContent","visibility":"Public","body":"begin\n  type = (MocoPo.safe_string(json[\"type\"]?)) || \"text\"\n\n  case type\n  when \"text\"\n    text = (MocoPo.safe_string(json[\"text\"]?)) || \"\"\n    SamplingMessageContent.text(text)\n  when \"image\"\n    data = (MocoPo.safe_string(json[\"data\"]?)) || \"\"\n    mime_type = (MocoPo.safe_string(json[\"mimeType\"]?)) || \"image/jpeg\"\n    SamplingMessageContent.image(data, mime_type)\n  when \"audio\"\n    data = (MocoPo.safe_string(json[\"data\"]?)) || \"\"\n    mime_type = (MocoPo.safe_string(json[\"mimeType\"]?)) || \"audio/wav\"\n    SamplingMessageContent.audio(data, mime_type)\n  else\n    SamplingMessageContent.text(\"\")\n  end\nrescue ex\n  SamplingMessageContent.text(\"\")\nend"},"external_var":false},{"html_id":"image(data:String,mime_type:String):SamplingMessageContent-class-method","name":"image","doc":"Create an image content","summary":"<p>Create an image content</p>","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"args_string":"(data : String, mime_type : String) : SamplingMessageContent","args_html":"(data : String, mime_type : String) : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":111,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L111"},"def":{"name":"image","args":[{"name":"data","external_name":"data","restriction":"String"},{"name":"mime_type","external_name":"mime_type","restriction":"String"}],"return_type":"SamplingMessageContent","visibility":"Public","body":"new(\"image\", nil, data, mime_type)"},"external_var":false},{"html_id":"new(type:String,text:String|Nil=nil,data:String|Nil=nil,mime_type:String|Nil=nil)-class-method","name":"new","doc":"Initialize a new message content","summary":"<p>Initialize a new message content</p>","abstract":false,"args":[{"name":"type","external_name":"type","restriction":"String"},{"name":"text","default_value":"nil","external_name":"text","restriction":"String | ::Nil"},{"name":"data","default_value":"nil","external_name":"data","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"args_string":"(type : String, text : String | Nil = nil, data : String | Nil = nil, mime_type : String | Nil = nil)","args_html":"(type : String, text : String | Nil = <span class=\"n\">nil</span>, data : String | Nil = <span class=\"n\">nil</span>, mime_type : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/sampling.cr","line_number":102,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L102"},"def":{"name":"new","args":[{"name":"type","external_name":"type","restriction":"String"},{"name":"text","default_value":"nil","external_name":"text","restriction":"String | ::Nil"},{"name":"data","default_value":"nil","external_name":"data","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(type, text, data, mime_type)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"text(text:String):SamplingMessageContent-class-method","name":"text","doc":"Create a text content","summary":"<p>Create a text content</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"}],"args_string":"(text : String) : SamplingMessageContent","args_html":"(text : String) : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":106,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L106"},"def":{"name":"text","args":[{"name":"text","external_name":"text","restriction":"String"}],"return_type":"SamplingMessageContent","visibility":"Public","body":"new(\"text\", text)"},"external_var":false}],"instance_methods":[{"html_id":"data:String|Nil-instance-method","name":"data","doc":"Binary data (for image/audio types, base64 encoded)","summary":"<p>Binary data (for image/audio types, base64 encoded)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L96"},"def":{"name":"data","return_type":"String | ::Nil","visibility":"Public","body":"@data"},"external_var":false},{"html_id":"data=(data:String|Nil)-instance-method","name":"data=","doc":"Binary data (for image/audio types, base64 encoded)","summary":"<p>Binary data (for image/audio types, base64 encoded)</p>","abstract":false,"args":[{"name":"data","external_name":"data","restriction":"String | ::Nil"}],"args_string":"(data : String | Nil)","args_html":"(data : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":96,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L96"},"def":{"name":"data=","args":[{"name":"data","external_name":"data","restriction":"String | ::Nil"}],"visibility":"Public","body":"@data = data"},"external_var":false},{"html_id":"mime_type:String|Nil-instance-method","name":"mime_type","doc":"MIME type (for image/audio types)","summary":"<p>MIME type (for image/audio types)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L99"},"def":{"name":"mime_type","return_type":"String | ::Nil","visibility":"Public","body":"@mime_type"},"external_var":false},{"html_id":"mime_type=(mime_type:String|Nil)-instance-method","name":"mime_type=","doc":"MIME type (for image/audio types)","summary":"<p>MIME type (for image/audio types)</p>","abstract":false,"args":[{"name":"mime_type","external_name":"mime_type","restriction":"String | ::Nil"}],"args_string":"(mime_type : String | Nil)","args_html":"(mime_type : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":99,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L99"},"def":{"name":"mime_type=","args":[{"name":"mime_type","external_name":"mime_type","restriction":"String | ::Nil"}],"visibility":"Public","body":"@mime_type = mime_type"},"external_var":false},{"html_id":"text:String|Nil-instance-method","name":"text","doc":"Text content (for text type)","summary":"<p>Text content (for text type)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":93,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L93"},"def":{"name":"text","return_type":"String | ::Nil","visibility":"Public","body":"@text"},"external_var":false},{"html_id":"text=(text:String|Nil)-instance-method","name":"text=","doc":"Text content (for text type)","summary":"<p>Text content (for text type)</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String | ::Nil"}],"args_string":"(text : String | Nil)","args_html":"(text : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":93,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L93"},"def":{"name":"text=","args":[{"name":"text","external_name":"text","restriction":"String | ::Nil"}],"visibility":"Public","body":"@text = text"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":121,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L121"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {\"type\" => @type} of String => JsonValue\n\ncase @type\nwhen \"text\"\n  result[\"text\"] = @text\nwhen \"image\", \"audio\"\n  result[\"data\"] = @data\n  result[\"mimeType\"] = @mime_type\nend\nresult\n"},"external_var":false},{"html_id":"type:String-instance-method","name":"type","doc":"Content type","summary":"<p>Content type</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":90,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L90"},"def":{"name":"type","return_type":"String","visibility":"Public","body":"@type"},"external_var":false},{"html_id":"type=(type:String)-instance-method","name":"type=","doc":"Content type","summary":"<p>Content type</p>","abstract":false,"args":[{"name":"type","external_name":"type","restriction":"String"}],"args_string":"(type : String)","args_html":"(type : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":90,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L90"},"def":{"name":"type=","args":[{"name":"type","external_name":"type","restriction":"String"}],"visibility":"Public","body":"@type = type"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingMetadata","path":"MocoPo/SamplingMetadata.html","kind":"alias","full_name":"MocoPo::SamplingMetadata","name":"SamplingMetadata","abstract":false,"locations":[{"filename":"src/mocopo/sampling.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"Hash(String, String)","aliased_html":"Hash(String, String)","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Type aliases for sampling","summary":"<p>Type aliases for sampling</p>"},{"html_id":"mocopo/MocoPo/SamplingMethod","path":"MocoPo/SamplingMethod.html","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod","abstract":true,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":459,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L459"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/GreedySamplingMethod","kind":"class","full_name":"MocoPo::GreedySamplingMethod","name":"GreedySamplingMethod"},{"html_id":"mocopo/MocoPo/TemperatureSamplingMethod","kind":"class","full_name":"MocoPo::TemperatureSamplingMethod","name":"TemperatureSamplingMethod"},{"html_id":"mocopo/MocoPo/TopKSamplingMethod","kind":"class","full_name":"MocoPo::TopKSamplingMethod","name":"TopKSamplingMethod"},{"html_id":"mocopo/MocoPo/TopPSamplingMethod","kind":"class","full_name":"MocoPo::TopPSamplingMethod","name":"TopPSamplingMethod"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Base class for all sampling methods","summary":"<p>Base class for all sampling methods</p>","constructors":[{"html_id":"new(name:String,description:String)-class-method","name":"new","doc":"Initialize a new sampling method","summary":"<p>Initialize a new sampling method</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"args_string":"(name : String, description : String)","args_html":"(name : String, description : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":467,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L467"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, description)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"description:String-instance-method","name":"description","doc":"Description of the sampling method","summary":"<p>Description of the sampling method</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":464,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L464"},"def":{"name":"description","return_type":"String","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Name of the sampling method","summary":"<p>Name of the sampling method</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":461,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L461"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"parameters_schema:JsonObject-instance-method","name":"parameters_schema","doc":"Return the parameters schema","summary":"<p>Return the parameters schema</p>","abstract":true,"location":{"filename":"src/mocopo/sampling.cr","line_number":483,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L483"},"def":{"name":"parameters_schema","return_type":"JsonObject","visibility":"Public","body":""},"external_var":false},{"html_id":"sample(text:String,params:JsonObject|Nil,context:Context):JsonObject-instance-method","name":"sample","doc":"Execute sampling","summary":"<p>Execute sampling</p>","abstract":true,"args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(text : String, params : JsonObject | Nil, context : Context) : JsonObject","args_html":"(text : String, params : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":486,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L486"},"def":{"name":"sample","args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"JsonObject","visibility":"Public","body":""},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":471,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L471"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {} of String => JsonValue\n\n\nresult[\"name\"] = @name\nresult[\"description\"] = @description\nresult[\"parameters\"] = parameters_schema\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingRequest","path":"MocoPo/SamplingRequest.html","kind":"class","full_name":"MocoPo::SamplingRequest","name":"SamplingRequest","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":291,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L291"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Sampling request class","summary":"<p>Sampling request class</p>","constructors":[{"html_id":"from_json_object(json:JsonObject):SamplingRequest-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : SamplingRequest","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/SamplingRequest.html\">SamplingRequest</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":362,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L362"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"SamplingRequest","visibility":"Public","body":"begin\n  messages = [] of SamplingMessage\n\n  messages_array = MocoPo.safe_array(json[\"messages\"]?)\n  if messages_array\n    messages = messages_array.compact_map do |message_json|\n      message_hash = MocoPo.safe_hash(message_json)\n      message_hash ? SamplingMessage.from_json_object(message_hash) : nil\n    end\n  end\n\n  model_preferences = nil\n  model_prefs_hash = MocoPo.safe_hash(json[\"modelPreferences\"]?)\n  if model_prefs_hash\n    model_preferences = ModelPreferences.from_json_object(model_prefs_hash)\n  end\n\n  system_prompt = MocoPo.safe_string(json[\"systemPrompt\"]?)\n  include_context = MocoPo.safe_string(json[\"includeContext\"]?)\n  temperature = MocoPo.safe_float(json[\"temperature\"]?)\n  max_tokens = (MocoPo.safe_int(json[\"maxTokens\"]?)) || 100\n\n  stop_sequences = nil\n  stop_sequences_array = MocoPo.safe_array(json[\"stopSequences\"]?)\n  if stop_sequences_array\n    stop_sequences = stop_sequences_array.compact_map do |seq|\n      MocoPo.safe_string(seq)\n    end\n  end\n\n  metadata = nil\n  metadata_hash = MocoPo.safe_hash(json[\"metadata\"]?)\n  if metadata_hash\n    metadata = {} of String => String\n    metadata_hash.each do |key, value|\n      if str_value = MocoPo.safe_string(value)\n        metadata[key] = str_value\n      end\n    end\n  end\n\n  new(messages, model_preferences, system_prompt, include_context, temperature, max_tokens, stop_sequences, metadata)\nrescue ex\n  new\nend"},"external_var":false},{"html_id":"new(messages:Array(MocoPo::SamplingMessage)=[]ofSamplingMessage,model_preferences:Nil|MocoPo::ModelPreferences=nil,system_prompt:Nil|String=nil,include_context:Nil|String=nil,temperature:Float64|Nil=nil,max_tokens:Int32=100,stop_sequences:Nil|Array(String)=nil,metadata:Nil|Hash(String,String)=nil)-class-method","name":"new","doc":"Initialize a new sampling request","summary":"<p>Initialize a new sampling request</p>","abstract":false,"args":[{"name":"messages","default_value":"[] of SamplingMessage","external_name":"messages","restriction":"::Array(::MocoPo::SamplingMessage)"},{"name":"model_preferences","default_value":"nil","external_name":"model_preferences","restriction":"::Nil | ::MocoPo::ModelPreferences"},{"name":"system_prompt","default_value":"nil","external_name":"system_prompt","restriction":"::Nil | ::String"},{"name":"include_context","default_value":"nil","external_name":"include_context","restriction":"::Nil | ::String"},{"name":"temperature","default_value":"nil","external_name":"temperature","restriction":"::Float64 | ::Nil"},{"name":"max_tokens","default_value":"100","external_name":"max_tokens","restriction":"::Int32"},{"name":"stop_sequences","default_value":"nil","external_name":"stop_sequences","restriction":"::Nil | ::Array(::String)"},{"name":"metadata","default_value":"nil","external_name":"metadata","restriction":"::Nil | ::Hash(::String, ::String)"}],"args_string":"(messages : Array(MocoPo::SamplingMessage) = [] of SamplingMessage, model_preferences : Nil | MocoPo::ModelPreferences = nil, system_prompt : Nil | String = nil, include_context : Nil | String = nil, temperature : Float64 | Nil = nil, max_tokens : Int32 = 100, stop_sequences : Nil | Array(String) = nil, metadata : Nil | Hash(String, String) = nil)","args_html":"(messages : Array(<a href=\"../MocoPo/SamplingMessage.html\">MocoPo::SamplingMessage</a>) = <span class=\"o\">[]</span> <span class=\"k\">of</span> <span class=\"t\">SamplingMessage</span>, model_preferences : Nil | <a href=\"../MocoPo/ModelPreferences.html\">MocoPo::ModelPreferences</a> = <span class=\"n\">nil</span>, system_prompt : Nil | String = <span class=\"n\">nil</span>, include_context : Nil | String = <span class=\"n\">nil</span>, temperature : Float64 | Nil = <span class=\"n\">nil</span>, max_tokens : Int32 = <span class=\"n\">100</span>, stop_sequences : Nil | Array(String) = <span class=\"n\">nil</span>, metadata : Nil | Hash(String, String) = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/sampling.cr","line_number":317,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L317"},"def":{"name":"new","args":[{"name":"messages","default_value":"[] of SamplingMessage","external_name":"messages","restriction":"::Array(::MocoPo::SamplingMessage)"},{"name":"model_preferences","default_value":"nil","external_name":"model_preferences","restriction":"::Nil | ::MocoPo::ModelPreferences"},{"name":"system_prompt","default_value":"nil","external_name":"system_prompt","restriction":"::Nil | ::String"},{"name":"include_context","default_value":"nil","external_name":"include_context","restriction":"::Nil | ::String"},{"name":"temperature","default_value":"nil","external_name":"temperature","restriction":"::Float64 | ::Nil"},{"name":"max_tokens","default_value":"100","external_name":"max_tokens","restriction":"::Int32"},{"name":"stop_sequences","default_value":"nil","external_name":"stop_sequences","restriction":"::Nil | ::Array(::String)"},{"name":"metadata","default_value":"nil","external_name":"metadata","restriction":"::Nil | ::Hash(::String, ::String)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(messages, model_preferences, system_prompt, include_context, temperature, max_tokens, stop_sequences, metadata)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"include_context:String|Nil-instance-method","name":"include_context","doc":"Include context","summary":"<p>Include context</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":302,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L302"},"def":{"name":"include_context","return_type":"String | ::Nil","visibility":"Public","body":"@include_context"},"external_var":false},{"html_id":"include_context=(include_context:String|Nil)-instance-method","name":"include_context=","doc":"Include context","summary":"<p>Include context</p>","abstract":false,"args":[{"name":"include_context","external_name":"include_context","restriction":"String | ::Nil"}],"args_string":"(include_context : String | Nil)","args_html":"(include_context : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":302,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L302"},"def":{"name":"include_context=","args":[{"name":"include_context","external_name":"include_context","restriction":"String | ::Nil"}],"visibility":"Public","body":"@include_context = include_context"},"external_var":false},{"html_id":"max_tokens:Int32-instance-method","name":"max_tokens","doc":"Maximum tokens","summary":"<p>Maximum tokens</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":308,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L308"},"def":{"name":"max_tokens","return_type":"Int32","visibility":"Public","body":"@max_tokens"},"external_var":false},{"html_id":"max_tokens=(max_tokens:Int32)-instance-method","name":"max_tokens=","doc":"Maximum tokens","summary":"<p>Maximum tokens</p>","abstract":false,"args":[{"name":"max_tokens","external_name":"max_tokens","restriction":"Int32"}],"args_string":"(max_tokens : Int32)","args_html":"(max_tokens : Int32)","location":{"filename":"src/mocopo/sampling.cr","line_number":308,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L308"},"def":{"name":"max_tokens=","args":[{"name":"max_tokens","external_name":"max_tokens","restriction":"Int32"}],"visibility":"Public","body":"@max_tokens = max_tokens"},"external_var":false},{"html_id":"messages:Array(SamplingMessage)-instance-method","name":"messages","doc":"Messages","summary":"<p>Messages</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":293,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L293"},"def":{"name":"messages","return_type":"Array(SamplingMessage)","visibility":"Public","body":"@messages"},"external_var":false},{"html_id":"messages=(messages:Array(SamplingMessage))-instance-method","name":"messages=","doc":"Messages","summary":"<p>Messages</p>","abstract":false,"args":[{"name":"messages","external_name":"messages","restriction":"Array(SamplingMessage)"}],"args_string":"(messages : Array(SamplingMessage))","args_html":"(messages : Array(<a href=\"../MocoPo/SamplingMessage.html\">SamplingMessage</a>))","location":{"filename":"src/mocopo/sampling.cr","line_number":293,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L293"},"def":{"name":"messages=","args":[{"name":"messages","external_name":"messages","restriction":"Array(SamplingMessage)"}],"visibility":"Public","body":"@messages = messages"},"external_var":false},{"html_id":"metadata:SamplingMetadata|Nil-instance-method","name":"metadata","doc":"Metadata","summary":"<p>Metadata</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":314,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L314"},"def":{"name":"metadata","return_type":"SamplingMetadata | ::Nil","visibility":"Public","body":"@metadata"},"external_var":false},{"html_id":"metadata=(metadata:SamplingMetadata|Nil)-instance-method","name":"metadata=","doc":"Metadata","summary":"<p>Metadata</p>","abstract":false,"args":[{"name":"metadata","external_name":"metadata","restriction":"SamplingMetadata | ::Nil"}],"args_string":"(metadata : SamplingMetadata | Nil)","args_html":"(metadata : <a href=\"../MocoPo/SamplingMetadata.html\">SamplingMetadata</a> | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":314,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L314"},"def":{"name":"metadata=","args":[{"name":"metadata","external_name":"metadata","restriction":"SamplingMetadata | ::Nil"}],"visibility":"Public","body":"@metadata = metadata"},"external_var":false},{"html_id":"model_preferences:ModelPreferences|Nil-instance-method","name":"model_preferences","doc":"Model preferences","summary":"<p>Model preferences</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":296,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L296"},"def":{"name":"model_preferences","return_type":"ModelPreferences | ::Nil","visibility":"Public","body":"@model_preferences"},"external_var":false},{"html_id":"model_preferences=(model_preferences:ModelPreferences|Nil)-instance-method","name":"model_preferences=","doc":"Model preferences","summary":"<p>Model preferences</p>","abstract":false,"args":[{"name":"model_preferences","external_name":"model_preferences","restriction":"ModelPreferences | ::Nil"}],"args_string":"(model_preferences : ModelPreferences | Nil)","args_html":"(model_preferences : <a href=\"../MocoPo/ModelPreferences.html\">ModelPreferences</a> | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":296,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L296"},"def":{"name":"model_preferences=","args":[{"name":"model_preferences","external_name":"model_preferences","restriction":"ModelPreferences | ::Nil"}],"visibility":"Public","body":"@model_preferences = model_preferences"},"external_var":false},{"html_id":"stop_sequences:SamplingStopSequences|Nil-instance-method","name":"stop_sequences","doc":"Stop sequences","summary":"<p>Stop sequences</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":311,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L311"},"def":{"name":"stop_sequences","return_type":"SamplingStopSequences | ::Nil","visibility":"Public","body":"@stop_sequences"},"external_var":false},{"html_id":"stop_sequences=(stop_sequences:SamplingStopSequences|Nil)-instance-method","name":"stop_sequences=","doc":"Stop sequences","summary":"<p>Stop sequences</p>","abstract":false,"args":[{"name":"stop_sequences","external_name":"stop_sequences","restriction":"SamplingStopSequences | ::Nil"}],"args_string":"(stop_sequences : SamplingStopSequences | Nil)","args_html":"(stop_sequences : <a href=\"../MocoPo/SamplingStopSequences.html\">SamplingStopSequences</a> | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":311,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L311"},"def":{"name":"stop_sequences=","args":[{"name":"stop_sequences","external_name":"stop_sequences","restriction":"SamplingStopSequences | ::Nil"}],"visibility":"Public","body":"@stop_sequences = stop_sequences"},"external_var":false},{"html_id":"system_prompt:String|Nil-instance-method","name":"system_prompt","doc":"System prompt","summary":"<p>System prompt</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":299,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L299"},"def":{"name":"system_prompt","return_type":"String | ::Nil","visibility":"Public","body":"@system_prompt"},"external_var":false},{"html_id":"system_prompt=(system_prompt:String|Nil)-instance-method","name":"system_prompt=","doc":"System prompt","summary":"<p>System prompt</p>","abstract":false,"args":[{"name":"system_prompt","external_name":"system_prompt","restriction":"String | ::Nil"}],"args_string":"(system_prompt : String | Nil)","args_html":"(system_prompt : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":299,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L299"},"def":{"name":"system_prompt=","args":[{"name":"system_prompt","external_name":"system_prompt","restriction":"String | ::Nil"}],"visibility":"Public","body":"@system_prompt = system_prompt"},"external_var":false},{"html_id":"temperature:Float64|Nil-instance-method","name":"temperature","doc":"Temperature","summary":"<p>Temperature</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":305,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L305"},"def":{"name":"temperature","return_type":"Float64 | ::Nil","visibility":"Public","body":"@temperature"},"external_var":false},{"html_id":"temperature=(temperature:Float64|Nil)-instance-method","name":"temperature=","doc":"Temperature","summary":"<p>Temperature</p>","abstract":false,"args":[{"name":"temperature","external_name":"temperature","restriction":"Float64 | ::Nil"}],"args_string":"(temperature : Float64 | Nil)","args_html":"(temperature : Float64 | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":305,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L305"},"def":{"name":"temperature=","args":[{"name":"temperature","external_name":"temperature","restriction":"Float64 | ::Nil"}],"visibility":"Public","body":"@temperature = temperature"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":321,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L321"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {} of String => JsonValue\n\n\nmessages_array = [] of JsonValue\n@messages.each do |message|\n  messages_array << message.to_json_object\nend\nresult[\"messages\"] = messages_array\n\n\nresult[\"maxTokens\"] = @max_tokens\n\n\nif @model_preferences\n  result[\"modelPreferences\"] = @model_preferences.not_nil!.to_json_object\nend\nif @system_prompt\n  result[\"systemPrompt\"] = @system_prompt\nend\nif @include_context\n  result[\"includeContext\"] = @include_context\nend\nif @temperature\n  result[\"temperature\"] = @temperature\nend\n\n\nif @stop_sequences && !@stop_sequences.not_nil!.empty?\n  stop_sequences_array = [] of JsonValue\n  @stop_sequences.not_nil!.each do |seq|\n    stop_sequences_array << seq\n  end\n  result[\"stopSequences\"] = stop_sequences_array\nend\n\n\nif @metadata && !@metadata.not_nil!.empty?\n  metadata_json = {} of String => JsonValue\n  @metadata.not_nil!.each do |key, value|\n    metadata_json[key] = value\n  end\n  result[\"metadata\"] = metadata_json\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingResponse","path":"MocoPo/SamplingResponse.html","kind":"class","full_name":"MocoPo::SamplingResponse","name":"SamplingResponse","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":409,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L409"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Sampling response class","summary":"<p>Sampling response class</p>","constructors":[{"html_id":"from_json_object(json:JsonObject):SamplingResponse-class-method","name":"from_json_object","doc":"Create from JSON-compatible Hash","summary":"<p>Create from JSON-compatible Hash</p>","abstract":false,"args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"args_string":"(json : JsonObject) : SamplingResponse","args_html":"(json : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : <a href=\"../MocoPo/SamplingResponse.html\">SamplingResponse</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":442,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L442"},"def":{"name":"from_json_object","args":[{"name":"json","external_name":"json","restriction":"JsonObject"}],"return_type":"SamplingResponse","visibility":"Public","body":"begin\n  role = (MocoPo.safe_string(json[\"role\"]?)) || \"assistant\"\n\n  content_json = (MocoPo.safe_hash(json[\"content\"]?)) || ({} of String => JsonValue)\n  content = SamplingMessageContent.from_json_object(content_json)\n\n  model = (MocoPo.safe_string(json[\"model\"]?)) || \"unknown\"\n  stop_reason = MocoPo.safe_string(json[\"stopReason\"]?)\n\n  new(role, content, model, stop_reason)\nrescue ex\n  new(\"assistant\", SamplingMessageContent.text(\"\"), \"unknown\")\nend"},"external_var":false},{"html_id":"new(role:String,content:SamplingMessageContent,model:String,stop_reason:Nil|String=nil)-class-method","name":"new","doc":"Initialize a new sampling response","summary":"<p>Initialize a new sampling response</p>","abstract":false,"args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"SamplingMessageContent"},{"name":"model","external_name":"model","restriction":"String"},{"name":"stop_reason","default_value":"nil","external_name":"stop_reason","restriction":"::Nil | ::String"}],"args_string":"(role : String, content : SamplingMessageContent, model : String, stop_reason : Nil | String = nil)","args_html":"(role : String, content : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>, model : String, stop_reason : Nil | String = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo/sampling.cr","line_number":423,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L423"},"def":{"name":"new","args":[{"name":"role","external_name":"role","restriction":"String"},{"name":"content","external_name":"content","restriction":"SamplingMessageContent"},{"name":"model","external_name":"model","restriction":"String"},{"name":"stop_reason","default_value":"nil","external_name":"stop_reason","restriction":"::Nil | ::String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(role, content, model, stop_reason)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"content:SamplingMessageContent-instance-method","name":"content","doc":"Content","summary":"<p>Content</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":414,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L414"},"def":{"name":"content","return_type":"SamplingMessageContent","visibility":"Public","body":"@content"},"external_var":false},{"html_id":"content=(content:SamplingMessageContent)-instance-method","name":"content=","doc":"Content","summary":"<p>Content</p>","abstract":false,"args":[{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"args_string":"(content : SamplingMessageContent)","args_html":"(content : <a href=\"../MocoPo/SamplingMessageContent.html\">SamplingMessageContent</a>)","location":{"filename":"src/mocopo/sampling.cr","line_number":414,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L414"},"def":{"name":"content=","args":[{"name":"content","external_name":"content","restriction":"SamplingMessageContent"}],"visibility":"Public","body":"@content = content"},"external_var":false},{"html_id":"model:String-instance-method","name":"model","doc":"Model used","summary":"<p>Model used</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":417,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L417"},"def":{"name":"model","return_type":"String","visibility":"Public","body":"@model"},"external_var":false},{"html_id":"model=(model:String)-instance-method","name":"model=","doc":"Model used","summary":"<p>Model used</p>","abstract":false,"args":[{"name":"model","external_name":"model","restriction":"String"}],"args_string":"(model : String)","args_html":"(model : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":417,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L417"},"def":{"name":"model=","args":[{"name":"model","external_name":"model","restriction":"String"}],"visibility":"Public","body":"@model = model"},"external_var":false},{"html_id":"role:String-instance-method","name":"role","doc":"Role (usually \"assistant\")","summary":"<p>Role (usually &quot;assistant&quot;)</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":411,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L411"},"def":{"name":"role","return_type":"String","visibility":"Public","body":"@role"},"external_var":false},{"html_id":"role=(role:String)-instance-method","name":"role=","doc":"Role (usually \"assistant\")","summary":"<p>Role (usually &quot;assistant&quot;)</p>","abstract":false,"args":[{"name":"role","external_name":"role","restriction":"String"}],"args_string":"(role : String)","args_html":"(role : String)","location":{"filename":"src/mocopo/sampling.cr","line_number":411,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L411"},"def":{"name":"role=","args":[{"name":"role","external_name":"role","restriction":"String"}],"visibility":"Public","body":"@role = role"},"external_var":false},{"html_id":"stop_reason:String|Nil-instance-method","name":"stop_reason","doc":"Stop reason","summary":"<p>Stop reason</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":420,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L420"},"def":{"name":"stop_reason","return_type":"String | ::Nil","visibility":"Public","body":"@stop_reason"},"external_var":false},{"html_id":"stop_reason=(stop_reason:String|Nil)-instance-method","name":"stop_reason=","doc":"Stop reason","summary":"<p>Stop reason</p>","abstract":false,"args":[{"name":"stop_reason","external_name":"stop_reason","restriction":"String | ::Nil"}],"args_string":"(stop_reason : String | Nil)","args_html":"(stop_reason : String | Nil)","location":{"filename":"src/mocopo/sampling.cr","line_number":420,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L420"},"def":{"name":"stop_reason=","args":[{"name":"stop_reason","external_name":"stop_reason","restriction":"String | ::Nil"}],"visibility":"Public","body":"@stop_reason = stop_reason"},"external_var":false},{"html_id":"to_json_object:JsonObject-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":427,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L427"},"def":{"name":"to_json_object","return_type":"JsonObject","visibility":"Public","body":"result = {} of String => JsonValue\n\n\nresult[\"role\"] = @role\nresult[\"content\"] = @content.to_json_object\nresult[\"model\"] = @model\n\n\nif @stop_reason\n  result[\"stopReason\"] = @stop_reason\nend\n\nresult\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SamplingStopSequences","path":"MocoPo/SamplingStopSequences.html","kind":"alias","full_name":"MocoPo::SamplingStopSequences","name":"SamplingStopSequences","abstract":false,"locations":[{"filename":"src/mocopo/sampling.cr","line_number":6,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L6"}],"repository_name":"mocopo","program":false,"enum":false,"alias":true,"aliased":"Array(String)","aliased_html":"Array(String)","const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"}},{"html_id":"mocopo/MocoPo/Server","path":"MocoPo/Server.html","kind":"class","full_name":"MocoPo::Server","name":"Server","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo.cr","line_number":28,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L28"},{"filename":"src/mocopo/cancellation.cr","line_number":129,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L129"},{"filename":"src/mocopo/roots.cr","line_number":405,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L405"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Server class for handling MCP requests","summary":"<p>Server class for handling MCP requests</p>","constructors":[{"html_id":"new(name:String,version:String,setup_routes:Bool=true,setup_transports:Bool=true)-class-method","name":"new","doc":"Initialize a new MCP server","summary":"<p>Initialize a new MCP server</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"version","external_name":"version","restriction":"String"},{"name":"setup_routes","default_value":"true","external_name":"setup_routes","restriction":"Bool"},{"name":"setup_transports","default_value":"true","external_name":"setup_transports","restriction":"Bool"}],"args_string":"(name : String, version : String, setup_routes : Bool = true, setup_transports : Bool = true)","args_html":"(name : String, version : String, setup_routes : Bool = <span class=\"n\">true</span>, setup_transports : Bool = <span class=\"n\">true</span>)","location":{"filename":"src/mocopo.cr","line_number":57,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L57"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"version","external_name":"version","restriction":"String"},{"name":"setup_routes","default_value":"true","external_name":"setup_routes","restriction":"Bool"},{"name":"setup_transports","default_value":"true","external_name":"setup_transports","restriction":"Bool"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, version, setup_routes, setup_transports)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"cancel_token(id:String,reason:String|Nil=nil):Bool-instance-method","name":"cancel_token","doc":"Cancel a token","summary":"<p>Cancel a token</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"args_string":"(id : String, reason : String | Nil = nil) : Bool","args_html":"(id : String, reason : String | Nil = <span class=\"n\">nil</span>) : Bool","location":{"filename":"src/mocopo/cancellation.cr","line_number":144,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L144"},"def":{"name":"cancel_token","args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"reason","default_value":"nil","external_name":"reason","restriction":"String | ::Nil"}],"return_type":"Bool","visibility":"Public","body":"@cancellation_manager.cancel_token(id, reason)"},"external_var":false},{"html_id":"cancellation_manager:CancellationManager-instance-method","name":"cancellation_manager","doc":"Cancellation manager","summary":"<p>Cancellation manager</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":131,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L131"},"def":{"name":"cancellation_manager","return_type":"CancellationManager","visibility":"Public","body":"@cancellation_manager"},"external_var":false},{"html_id":"cancellation_manager=(cancellation_manager:CancellationManager)-instance-method","name":"cancellation_manager=","doc":"Cancellation manager","summary":"<p>Cancellation manager</p>","abstract":false,"args":[{"name":"cancellation_manager","external_name":"cancellation_manager","restriction":"CancellationManager"}],"args_string":"(cancellation_manager : CancellationManager)","args_html":"(cancellation_manager : <a href=\"../MocoPo/CancellationManager.html\">CancellationManager</a>)","location":{"filename":"src/mocopo/cancellation.cr","line_number":131,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L131"},"def":{"name":"cancellation_manager=","args":[{"name":"cancellation_manager","external_name":"cancellation_manager","restriction":"CancellationManager"}],"visibility":"Public","body":"@cancellation_manager = cancellation_manager"},"external_var":false},{"html_id":"create_cancellation_token(id:String|Nil=nil):CancellationToken-instance-method","name":"create_cancellation_token","doc":"Create a cancellation token","summary":"<p>Create a cancellation token</p>","abstract":false,"args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"String | ::Nil"}],"args_string":"(id : String | Nil = nil) : CancellationToken","args_html":"(id : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/CancellationToken.html\">CancellationToken</a>","location":{"filename":"src/mocopo/cancellation.cr","line_number":139,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L139"},"def":{"name":"create_cancellation_token","args":[{"name":"id","default_value":"nil","external_name":"id","restriction":"String | ::Nil"}],"return_type":"CancellationToken","visibility":"Public","body":"@cancellation_manager.create_token(id)"},"external_var":false},{"html_id":"create_http_transport:HttpTransport-instance-method","name":"create_http_transport","doc":"Create and register an HTTP transport","summary":"<p>Create and register an HTTP transport</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":198,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L198"},"def":{"name":"create_http_transport","return_type":"HttpTransport","visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.create_http_transport\nelse\n  raise(\"Transport manager not initialized\")\nend"},"external_var":false},{"html_id":"create_sse_transport:SseTransport-instance-method","name":"create_sse_transport","doc":"Create and register an SSE transport","summary":"<p>Create and register an SSE transport</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":216,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L216"},"def":{"name":"create_sse_transport","return_type":"SseTransport","visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.create_sse_transport\nelse\n  raise(\"Transport manager not initialized\")\nend"},"external_var":false},{"html_id":"create_stdio_transport:StdioTransport-instance-method","name":"create_stdio_transport","doc":"Create and register a stdio transport","summary":"<p>Create and register a stdio transport</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":207,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L207"},"def":{"name":"create_stdio_transport","return_type":"StdioTransport","visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.create_stdio_transport\nelse\n  raise(\"Transport manager not initialized\")\nend"},"external_var":false},{"html_id":"handler_manager:HandlerManager|Nil-instance-method","name":"handler_manager","doc":"Handler manager","summary":"<p>Handler manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":42,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L42"},"def":{"name":"handler_manager","return_type":"HandlerManager | ::Nil","visibility":"Public","body":"@handler_manager"},"external_var":false},{"html_id":"initialize_cancellation_manager-instance-method","name":"initialize_cancellation_manager","doc":"Initialize cancellation manager","summary":"<p>Initialize cancellation manager</p>","abstract":false,"location":{"filename":"src/mocopo/cancellation.cr","line_number":134,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L134"},"def":{"name":"initialize_cancellation_manager","visibility":"Public","body":"@cancellation_manager = CancellationManager.new"},"external_var":false},{"html_id":"is_cancelled?(id:String):Bool-instance-method","name":"is_cancelled?","doc":"Check if a token is cancelled","summary":"<p>Check if a token is cancelled</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"}],"args_string":"(id : String) : Bool","args_html":"(id : String) : Bool","location":{"filename":"src/mocopo/cancellation.cr","line_number":149,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/cancellation.cr#L149"},"def":{"name":"is_cancelled?","args":[{"name":"id","external_name":"id","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@cancellation_manager.is_cancelled?(id)"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Server name","summary":"<p>Server name</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":51,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L51"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"notification_manager:NotificationManager|Nil-instance-method","name":"notification_manager","doc":"Notification manager","summary":"<p>Notification manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":45,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L45"},"def":{"name":"notification_manager","return_type":"NotificationManager | ::Nil","visibility":"Public","body":"@notification_manager"},"external_var":false},{"html_id":"prompt_manager:PromptManager-instance-method","name":"prompt_manager","doc":"Prompt manager","summary":"<p>Prompt manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":36,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L36"},"def":{"name":"prompt_manager","return_type":"PromptManager","visibility":"Public","body":"@prompt_manager"},"external_var":false},{"html_id":"register_prompt(name:String,description:String|Nil=nil,&block:Prompt->_)-instance-method","name":"register_prompt","doc":"Register a prompt with a block","summary":"<p>Register a prompt with a block</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, description : String | Nil = nil, &block : Prompt -> _)","args_html":"(name : String, description : String | Nil = <span class=\"n\">nil</span>, &block : <a href=\"../MocoPo/Prompt.html\">Prompt</a> -> _)","location":{"filename":"src/mocopo.cr","line_number":160,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L160"},"def":{"name":"register_prompt","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Prompt -> _)"},"visibility":"Public","body":"prompt = Prompt.new(name, description)\n\n\n@prompt_manager.register(prompt)\n\n\nyield prompt\n\n\nprompt\n"},"external_var":false},{"html_id":"register_prompt(name:String,description:String|Nil=nil)-instance-method","name":"register_prompt","doc":"Register a prompt without a block","summary":"<p>Register a prompt without a block</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, description : String | Nil = nil)","args_html":"(name : String, description : String | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo.cr","line_number":175,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L175"},"def":{"name":"register_prompt","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"visibility":"Public","body":"register_prompt(name, description) do |_|\nend"},"external_var":false},{"html_id":"register_resource(uri:String,name:String,description:String|Nil=nil,mime_type:String|Nil=nil,size:Int64|Nil=nil,&block:Resource->_)-instance-method","name":"register_resource","doc":"Register a resource with a block","summary":"<p>Register a resource with a block</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"args_string":"(uri : String, name : String, description : String | Nil = nil, mime_type : String | Nil = nil, size : Int64 | Nil = nil, &block : Resource -> _)","args_html":"(uri : String, name : String, description : String | Nil = <span class=\"n\">nil</span>, mime_type : String | Nil = <span class=\"n\">nil</span>, size : Int64 | Nil = <span class=\"n\">nil</span>, &block : <a href=\"../MocoPo/Resource.html\">Resource</a> -> _)","location":{"filename":"src/mocopo.cr","line_number":139,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L139"},"def":{"name":"register_resource","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Resource -> _)"},"visibility":"Public","body":"resource = Resource.new(uri, name, description, mime_type, size)\n\n\n@resource_manager.register(resource)\n\n\nyield resource\n\n\nresource\n"},"external_var":false},{"html_id":"register_resource(uri:String,name:String,description:String|Nil=nil,mime_type:String|Nil=nil,size:Int64|Nil=nil)-instance-method","name":"register_resource","doc":"Register a resource without a block","summary":"<p>Register a resource without a block</p>","abstract":false,"args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"args_string":"(uri : String, name : String, description : String | Nil = nil, mime_type : String | Nil = nil, size : Int64 | Nil = nil)","args_html":"(uri : String, name : String, description : String | Nil = <span class=\"n\">nil</span>, mime_type : String | Nil = <span class=\"n\">nil</span>, size : Int64 | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/mocopo.cr","line_number":154,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L154"},"def":{"name":"register_resource","args":[{"name":"uri","external_name":"uri","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"},{"name":"mime_type","default_value":"nil","external_name":"mime_type","restriction":"String | ::Nil"},{"name":"size","default_value":"nil","external_name":"size","restriction":"Int64 | ::Nil"}],"visibility":"Public","body":"register_resource(uri, name, description, mime_type, size) do |_|\nend"},"external_var":false},{"html_id":"register_root(id:String,name:String,description:String,path:String,read_only:Bool=true):Root-instance-method","name":"register_root","doc":"Register a root","summary":"<p>Register a root</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"args_string":"(id : String, name : String, description : String, path : String, read_only : Bool = true) : Root","args_html":"(id : String, name : String, description : String, path : String, read_only : Bool = <span class=\"n\">true</span>) : <a href=\"../MocoPo/Root.html\">Root</a>","location":{"filename":"src/mocopo/roots.cr","line_number":410,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L410"},"def":{"name":"register_root","args":[{"name":"id","external_name":"id","restriction":"String"},{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"path","external_name":"path","restriction":"String"},{"name":"read_only","default_value":"true","external_name":"read_only","restriction":"Bool"}],"return_type":"Root","visibility":"Public","body":"@root_manager.register(id, name, description, path, read_only)"},"external_var":false},{"html_id":"register_tool(name:String,description:String,&block:Tool->_)-instance-method","name":"register_tool","doc":"Register a tool with a block","summary":"<p>Register a tool with a block</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"args_string":"(name : String, description : String, &block : Tool -> _)","args_html":"(name : String, description : String, &block : <a href=\"../MocoPo/Tool.html\">Tool</a> -> _)","location":{"filename":"src/mocopo.cr","line_number":111,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L111"},"def":{"name":"register_tool","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(Tool -> _)"},"visibility":"Public","body":"schema = {\"type\" => \"object\", \"properties\" => {} of String => JsonValue, \"required\" => [] of JsonValue} of String => JsonValue\n\n\ntool = Tool.new(name, description, schema)\n\n\n@tool_manager.register(tool)\n\n\nyield tool\n\n\ntool\n"},"external_var":false},{"html_id":"register_tool(name:String,description:String)-instance-method","name":"register_tool","doc":"Register a tool without a block","summary":"<p>Register a tool without a block</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"args_string":"(name : String, description : String)","args_html":"(name : String, description : String)","location":{"filename":"src/mocopo.cr","line_number":133,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L133"},"def":{"name":"register_tool","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"}],"visibility":"Public","body":"register_tool(name, description) do |_|\nend"},"external_var":false},{"html_id":"register_transport(transport:Transport):Transport-instance-method","name":"register_transport","doc":"Create and register a transport","summary":"<p>Create and register a transport</p>","abstract":false,"args":[{"name":"transport","external_name":"transport","restriction":"Transport"}],"args_string":"(transport : Transport) : Transport","args_html":"(transport : <a href=\"../MocoPo/Transport.html\">Transport</a>) : <a href=\"../MocoPo/Transport.html\">Transport</a>","location":{"filename":"src/mocopo.cr","line_number":189,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L189"},"def":{"name":"register_transport","args":[{"name":"transport","external_name":"transport","restriction":"Transport"}],"return_type":"Transport","visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.register(transport)\nelse\n  raise(\"Transport manager not initialized\")\nend"},"external_var":false},{"html_id":"resource_manager:ResourceManager-instance-method","name":"resource_manager","doc":"Resource manager","summary":"<p>Resource manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":33,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L33"},"def":{"name":"resource_manager","return_type":"ResourceManager","visibility":"Public","body":"@resource_manager"},"external_var":false},{"html_id":"root_manager:RootManager-instance-method","name":"root_manager","doc":"Root manager","summary":"<p>Root manager</p>","abstract":false,"location":{"filename":"src/mocopo/roots.cr","line_number":407,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L407"},"def":{"name":"root_manager","return_type":"RootManager","visibility":"Public","body":"@root_manager"},"external_var":false},{"html_id":"root_manager=(root_manager:RootManager)-instance-method","name":"root_manager=","doc":"Root manager","summary":"<p>Root manager</p>","abstract":false,"args":[{"name":"root_manager","external_name":"root_manager","restriction":"RootManager"}],"args_string":"(root_manager : RootManager)","args_html":"(root_manager : <a href=\"../MocoPo/RootManager.html\">RootManager</a>)","location":{"filename":"src/mocopo/roots.cr","line_number":407,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/roots.cr#L407"},"def":{"name":"root_manager=","args":[{"name":"root_manager","external_name":"root_manager","restriction":"RootManager"}],"visibility":"Public","body":"@root_manager = root_manager"},"external_var":false},{"html_id":"sampling_manager:SamplingManager-instance-method","name":"sampling_manager","doc":"Sampling manager","summary":"<p>Sampling manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":39,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L39"},"def":{"name":"sampling_manager","return_type":"SamplingManager","visibility":"Public","body":"@sampling_manager"},"external_var":false},{"html_id":"start(port=3000)-instance-method","name":"start","doc":"Start the server on the specified port","summary":"<p>Start the server on the specified port</p>","abstract":false,"args":[{"name":"port","default_value":"3000","external_name":"port","restriction":""}],"args_string":"(port = 3000)","args_html":"(port = <span class=\"n\">3000</span>)","location":{"filename":"src/mocopo.cr","line_number":89,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L89"},"def":{"name":"start","args":[{"name":"port","default_value":"3000","external_name":"port","restriction":""}],"visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.start_all\nend\n\n\nKemal.run(port)\n"},"external_var":false},{"html_id":"stop-instance-method","name":"stop","doc":"Stop the server","summary":"<p>Stop the server</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":100,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L100"},"def":{"name":"stop","visibility":"Public","body":"if transport_manager = @transport_manager\n  transport_manager.close_all\nend\n\n\nKemal.stop\n"},"external_var":false},{"html_id":"tool_manager:ToolManager-instance-method","name":"tool_manager","doc":"Tool manager","summary":"<p>Tool manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":30,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L30"},"def":{"name":"tool_manager","return_type":"ToolManager","visibility":"Public","body":"@tool_manager"},"external_var":false},{"html_id":"transport_manager:TransportManager|Nil-instance-method","name":"transport_manager","doc":"Transport manager","summary":"<p>Transport manager</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L48"},"def":{"name":"transport_manager","return_type":"TransportManager | ::Nil","visibility":"Public","body":"@transport_manager"},"external_var":false},{"html_id":"version:String-instance-method","name":"version","doc":"Server version","summary":"<p>Server version</p>","abstract":false,"location":{"filename":"src/mocopo.cr","line_number":54,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo.cr#L54"},"def":{"name":"version","return_type":"String","visibility":"Public","body":"@version"},"external_var":false}]},{"html_id":"mocopo/MocoPo/SseTransport","path":"MocoPo/SseTransport.html","kind":"class","full_name":"MocoPo::SseTransport","name":"SseTransport","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},"ancestors":[{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/transports/sse_transport.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L8"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Server-Sent Events (SSE) transport implementation for MCP","summary":"<p>Server-Sent Events (SSE) transport implementation for MCP</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new SSE transport","summary":"<p>Initialize a new SSE transport</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/transports/sse_transport.cr","line_number":19,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L19"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close:Nil-instance-method","name":"close","doc":"Close the transport","summary":"<p>Close the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/sse_transport.cr","line_number":115,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L115"},"def":{"name":"close","return_type":"Nil","visibility":"Public","body":"@running = false\n\n\n@clients.each do |client|\n  begin\n    client.close\n  rescue ex\n    handle_error(ex)\n  end\nend\n\n@clients.clear\nhandle_close\n"},"external_var":false},{"html_id":"send(message:JsonObject):Nil-instance-method","name":"send","doc":"Send a JSON-RPC message to all connected clients","summary":"<p>Send a JSON-RPC message to all connected clients</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"args_string":"(message : JsonObject) : Nil","args_html":"(message : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : Nil","location":{"filename":"src/mocopo/transports/sse_transport.cr","line_number":97,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L97"},"def":{"name":"send","args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"return_type":"Nil","visibility":"Public","body":"data = \"data: #{message.to_json}\\n\\n\"\n\n\n@clients.each do |client|\n  begin\n    client.puts(data)\n    client.flush\n  rescue ex\n    @clients.delete(client)\n    handle_error(ex)\n  end\nend\n"},"external_var":false},{"html_id":"start:Nil-instance-method","name":"start","doc":"Start the transport","summary":"<p>Start the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/sse_transport.cr","line_number":25,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/sse_transport.cr#L25"},"def":{"name":"start","return_type":"Nil","visibility":"Public","body":"if @running\n  return\nend\n\n@running = true\n\n\nget(\"/sse\") do |env|\n  env.response.headers.add(\"Content-Type\", \"text/event-stream\")\n  env.response.headers.add(\"Cache-Control\", \"no-cache\")\n  env.response.headers.add(\"Connection\", \"keep-alive\")\n  env.response.headers.add(\"Access-Control-Allow-Origin\", \"*\")\n\n\n  @clients << env.response\n\n\n  begin\n    env.response.puts(\": ping\\n\\n\")\n    env.response.flush\n\n\n    while @running\n      sleep(30.seconds)\n      env.response.puts(\": ping\\n\\n\")\n      env.response.flush\n    end\n  rescue ex\n    @clients.delete(env.response)\n    handle_error(ex)\n  ensure\n    @clients.delete(env.response)\n  end\nend\n\n\npost(\"/messages\") do |env|\n  begin\n    request_body = env.request.body.try(&.gets_to_end)\n    if request_body\n    else\n      next (error_response(400, \"Missing request body\")).to_json\n    end\n\n\n    json = JSON.parse(request_body)\n\n\n    json_object = {} of String => JsonValue\n    json.as_h.each do |k, v|\n      json_object[k.to_s] = Utils.to_json_value(v)\n    end\n\n\n    handle_message(json_object)\n\n\n    env.response.content_type = \"application/json\"\n    response = process_jsonrpc(json_object)\n    response.to_json\n  rescue ex : JSON::ParseException\n    env.response.status_code = 400\n    next (error_response(-32700, \"Parse error: #{ex.message}\")).to_json\n  rescue ex\n    env.response.status_code = 500\n    handle_error(ex)\n    next (error_response(-32603, \"Internal error: #{ex.message}\")).to_json\n  end\nend\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/StdioTransport","path":"MocoPo/StdioTransport.html","kind":"class","full_name":"MocoPo::StdioTransport","name":"StdioTransport","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},"ancestors":[{"html_id":"mocopo/MocoPo/Transport","kind":"class","full_name":"MocoPo::Transport","name":"Transport"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":7,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L7"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Standard input/output transport implementation for MCP","summary":"<p>Standard input/output transport implementation for MCP</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new stdio transport","summary":"<p>Initialize a new stdio transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":12,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L12"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close:Nil-instance-method","name":"close","doc":"Close the transport","summary":"<p>Close the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":77,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L77"},"def":{"name":"close","return_type":"Nil","visibility":"Public","body":"@running = false\nhandle_close\n"},"external_var":false},{"html_id":"send(message:JsonObject):Nil-instance-method","name":"send","doc":"Send a JSON-RPC message","summary":"<p>Send a JSON-RPC message</p>","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"args_string":"(message : JsonObject) : Nil","args_html":"(message : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : Nil","location":{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":70,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L70"},"def":{"name":"send","args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"return_type":"Nil","visibility":"Public","body":"STDOUT.puts(message.to_json)\nSTDOUT.flush\n"},"external_var":false},{"html_id":"start:Nil-instance-method","name":"start","doc":"Start the transport","summary":"<p>Start the transport</p>","abstract":false,"location":{"filename":"src/mocopo/transports/stdio_transport.cr","line_number":17,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transports/stdio_transport.cr#L17"},"def":{"name":"start","return_type":"Nil","visibility":"Public","body":"if @running\n  return\nend\n\n@running = true\n\n\nspawn do\n  begin\n    while @running\n      line = STDIN.gets\n\n\n      if line\n      else\n        break\n      end\n\n\n      if line.empty?\n        next\n      end\n\n      begin\n        json = JSON.parse(line)\n        json_object = json.as_h.transform_keys(&.to_s)\n\n\n        handle_message(json_object)\n      rescue ex : JSON::ParseException\n        error = (JsonRpcErrorResponse.new(JsonRpcError.new(-32700, \"Parse error: #{ex.message}\"), nil)).to_json_object\n        send(error)\n        handle_error(ex)\n      rescue ex\n        error = (JsonRpcErrorResponse.new(JsonRpcError.new(-32603, \"Internal error: #{ex.message}\"), nil)).to_json_object\n        send(error)\n        handle_error(ex)\n      end\n    end\n  rescue ex\n    handle_error(ex)\n  ensure\n    @running = false\n    handle_close\n  end\nend\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/TemperatureSamplingMethod","path":"MocoPo/TemperatureSamplingMethod.html","kind":"class","full_name":"MocoPo::TemperatureSamplingMethod","name":"TemperatureSamplingMethod","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},"ancestors":[{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":513,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L513"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Temperature sampling method","summary":"<p>Temperature sampling method</p>","constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":514,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L514"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"parameters_schema:JsonObject-instance-method","name":"parameters_schema","doc":"Return the parameters schema","summary":"<p>Return the parameters schema</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":518,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L518"},"def":{"name":"parameters_schema","return_type":"JsonObject","visibility":"Public","body":"{\"type\" => \"object\", \"properties\" => {\"temperature\" => {\"type\" => \"number\", \"description\" => \"Temperature parameter (0.0 to 1.0)\", \"minimum\" => 0.0, \"maximum\" => 1.0, \"default\" => 0.7} of String => JsonValue} of String => JsonValue, \"required\" => [\"temperature\"] of JsonValue} of String => JsonValue"},"external_var":false},{"html_id":"sample(text:String,params:JsonObject|Nil,context:Context):JsonObject-instance-method","name":"sample","doc":"Execute sampling","summary":"<p>Execute sampling</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(text : String, params : JsonObject | Nil, context : Context) : JsonObject","args_html":"(text : String, params : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":534,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L534"},"def":{"name":"sample","args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"JsonObject","visibility":"Public","body":"temperature = 0.7\n\nif params\n  temp_value = params[\"temperature\"]?\n  temperature = (MocoPo.safe_float(temp_value)) || 0.7\nend\n\n{\"text\" => \"Sampling result (temperature: #{temperature}): #{text}\"} of String => JsonValue\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/TextContent","path":"MocoPo/TextContent.html","kind":"class","full_name":"MocoPo::TextContent","name":"TextContent","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},"ancestors":[{"html_id":"mocopo/MocoPo/MessageContent","kind":"class","full_name":"MocoPo::MessageContent","name":"MessageContent"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/prompts.cr","line_number":9,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L9"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Text content for messages","summary":"<p>Text content for messages</p>","constructors":[{"html_id":"new(text:String)-class-method","name":"new","doc":"Initialize a new text content","summary":"<p>Initialize a new text content</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"}],"args_string":"(text : String)","args_html":"(text : String)","location":{"filename":"src/mocopo/prompts.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L14"},"def":{"name":"new","args":[{"name":"text","external_name":"text","restriction":"String"}],"visibility":"Public","body":"_ = allocate\n_.initialize(text)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"text:String-instance-method","name":"text","doc":"Text content","summary":"<p>Text content</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L11"},"def":{"name":"text","return_type":"String","visibility":"Public","body":"@text"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/prompts.cr","line_number":18,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/prompts.cr#L18"},"def":{"name":"to_json_object","visibility":"Public","body":"{\"type\" => \"text\", \"text\" => @text} of String => String | Hash(String, String | Nil)"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Tool","path":"MocoPo/Tool.html","kind":"class","full_name":"MocoPo::Tool","name":"Tool","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/tools.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L5"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Represents a tool that can be invoked by language models","summary":"<p>Represents a tool that can be invoked by language models</p>","constructors":[{"html_id":"new(name:String,description:String,input_schema:JsonObject,&callback:JsonObject|Nil,Context|Nil->Hash(String,String|Array(Hash(String,String))))-class-method","name":"new","doc":"Initialize a new tool","summary":"<p>Initialize a new tool</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"input_schema","external_name":"input_schema","restriction":"JsonObject"}],"args_string":"(name : String, description : String, input_schema : JsonObject, &callback : JsonObject | Nil, Context | Nil -> Hash(String, String | Array(Hash(String, String))))","args_html":"(name : String, description : String, input_schema : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>, &callback : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, <a href=\"../MocoPo/Context.html\">Context</a> | Nil -> Hash(String, String | Array(Hash(String, String))))","location":{"filename":"src/mocopo/tools.cr","line_number":25,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L25"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"input_schema","external_name":"input_schema","restriction":"JsonObject"}],"yields":2,"block_arity":2,"block_arg":{"name":"callback","external_name":"callback","restriction":"(JsonObject | ::Nil, Context | ::Nil -> Hash(String, String | Array(Hash(String, String))))"},"visibility":"Public","body":"_ = allocate\n_.initialize(name, description, input_schema, &callback) do |_arg0, _arg1|\n  yield _arg0, _arg1\nend\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false},{"html_id":"new(name:String,description:String,input_schema:JsonObject)-class-method","name":"new","doc":"Initialize a new tool without callback","summary":"<p>Initialize a new tool without callback</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"input_schema","external_name":"input_schema","restriction":"JsonObject"}],"args_string":"(name : String, description : String, input_schema : JsonObject)","args_html":"(name : String, description : String, input_schema : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>)","location":{"filename":"src/mocopo/tools.cr","line_number":32,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L32"},"def":{"name":"new","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"description","external_name":"description","restriction":"String"},{"name":"input_schema","external_name":"input_schema","restriction":"JsonObject"}],"visibility":"Public","body":"_ = allocate\n_.initialize(name, description, input_schema)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"allowed_clients:Array(String)|Nil-instance-method","name":"allowed_clients","doc":"List of allowed client IDs (for access control)","summary":"<p>List of allowed client IDs (for access control)</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L22"},"def":{"name":"allowed_clients","return_type":"Array(String) | ::Nil","visibility":"Public","body":"@allowed_clients"},"external_var":false},{"html_id":"allowed_clients=(allowed_clients:Array(String)|Nil)-instance-method","name":"allowed_clients=","doc":"List of allowed client IDs (for access control)","summary":"<p>List of allowed client IDs (for access control)</p>","abstract":false,"args":[{"name":"allowed_clients","external_name":"allowed_clients","restriction":"Array(String) | ::Nil"}],"args_string":"(allowed_clients : Array(String) | Nil)","args_html":"(allowed_clients : Array(String) | Nil)","location":{"filename":"src/mocopo/tools.cr","line_number":22,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L22"},"def":{"name":"allowed_clients=","args":[{"name":"allowed_clients","external_name":"allowed_clients","restriction":"Array(String) | ::Nil"}],"visibility":"Public","body":"@allowed_clients = allowed_clients"},"external_var":false},{"html_id":"argument_array(name:String,item_type:String,required:Bool=false,description:String|Nil=nil):Tool-instance-method","name":"argument_array","doc":"Add an array argument","summary":"<p>Add an array argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"item_type","external_name":"item_type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, item_type : String, required : Bool = false, description : String | Nil = nil) : Tool","args_html":"(name : String, item_type : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Tool.html\">Tool</a>","location":{"filename":"src/mocopo/tools.cr","line_number":75,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L75"},"def":{"name":"argument_array","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"item_type","external_name":"item_type","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Tool","visibility":"Public","body":"@argument_builder.array(name, item_type, required, description)\nupdate_input_schema\nself\n"},"external_var":false},{"html_id":"argument_boolean(name:String,required:Bool=false,description:String|Nil=nil):Tool-instance-method","name":"argument_boolean","doc":"Add a boolean argument","summary":"<p>Add a boolean argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Tool","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Tool.html\">Tool</a>","location":{"filename":"src/mocopo/tools.cr","line_number":59,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L59"},"def":{"name":"argument_boolean","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Tool","visibility":"Public","body":"@argument_builder.boolean(name, required, description)\nupdate_input_schema\nself\n"},"external_var":false},{"html_id":"argument_builder:ArgumentBuilder-instance-method","name":"argument_builder","doc":"Argument builder","summary":"<p>Argument builder</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L16"},"def":{"name":"argument_builder","return_type":"ArgumentBuilder","visibility":"Public","body":"@argument_builder"},"external_var":false},{"html_id":"argument_number(name:String,required:Bool=false,description:String|Nil=nil):Tool-instance-method","name":"argument_number","doc":"Add a number argument","summary":"<p>Add a number argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Tool","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Tool.html\">Tool</a>","location":{"filename":"src/mocopo/tools.cr","line_number":52,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L52"},"def":{"name":"argument_number","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Tool","visibility":"Public","body":"@argument_builder.number(name, required, description)\nupdate_input_schema\nself\n"},"external_var":false},{"html_id":"argument_object(name:String,required:Bool=false,description:String|Nil=nil,&):Tool-instance-method","name":"argument_object","doc":"Add an object argument","summary":"<p>Add an object argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil, &) : Tool","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>, &) : <a href=\"../MocoPo/Tool.html\">Tool</a>","location":{"filename":"src/mocopo/tools.cr","line_number":66,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L66"},"def":{"name":"argument_object","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"yields":1,"block_arity":1,"return_type":"Tool","visibility":"Public","body":"@argument_builder.object(name, required, description) do |builder|\n  yield builder\nend\nupdate_input_schema\nself\n"},"external_var":false},{"html_id":"argument_string(name:String,required:Bool=false,description:String|Nil=nil):Tool-instance-method","name":"argument_string","doc":"Add a string argument","summary":"<p>Add a string argument</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"args_string":"(name : String, required : Bool = false, description : String | Nil = nil) : Tool","args_html":"(name : String, required : Bool = <span class=\"n\">false</span>, description : String | Nil = <span class=\"n\">nil</span>) : <a href=\"../MocoPo/Tool.html\">Tool</a>","location":{"filename":"src/mocopo/tools.cr","line_number":45,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L45"},"def":{"name":"argument_string","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"required","default_value":"false","external_name":"required","restriction":"Bool"},{"name":"description","default_value":"nil","external_name":"description","restriction":"String | ::Nil"}],"return_type":"Tool","visibility":"Public","body":"@argument_builder.string(name, required, description)\nupdate_input_schema\nself\n"},"external_var":false},{"html_id":"description:String-instance-method","name":"description","doc":"Human-readable description","summary":"<p>Human-readable description</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":10,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L10"},"def":{"name":"description","return_type":"String","visibility":"Public","body":"@description"},"external_var":false},{"html_id":"execute(arguments:JsonObject|Nil,context:Context|Nil=nil):Hash(String,String|Array(Hash(String,String)))-instance-method","name":"execute","doc":"Execute the tool with the given arguments","summary":"<p>Execute the tool with the given arguments</p>","abstract":false,"args":[{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"},{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"args_string":"(arguments : JsonObject | Nil, context : Context | Nil = nil) : Hash(String, String | Array(Hash(String, String)))","args_html":"(arguments : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a> | Nil = <span class=\"n\">nil</span>) : Hash(String, String | Array(Hash(String, String)))","location":{"filename":"src/mocopo/tools.cr","line_number":137,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L137"},"def":{"name":"execute","args":[{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"},{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"return_type":"Hash(String, String | Array(Hash(String, String)))","visibility":"Public","body":"if @allowed_clients && context\n  if @allowed_clients.not_nil!.includes?(context.client_id)\n  else\n    return {\"content\" => [{\"type\" => \"text\", \"text\" => \"Access denied: client_id '#{context.client_id}' is not authorized to use this tool.\"}] of Hash(String, String), \"isError\" => \"true\"}\n  end\nend\n\nvalidation_errors = validate_arguments(arguments)\nif !validation_errors.empty?\n  {\"content\" => [{\"type\" => \"text\", \"text\" => \"Input validation error(s): \" + (validation_errors.join(\", \"))}] of Hash(String, String), \"isError\" => \"true\"}\nelse\n  if @callback\n    raw_result = @callback.not_nil!.call(arguments, context)\n    if raw_result[\"content\"]?.is_a?(Array)\n      sanitized_content = (raw_result[\"content\"].as(Array(Hash(String, String)))).map do |item|\n        if (item[\"type\"]? == \"text\") && item[\"text\"]?\n          item = item.dup\n          item[\"text\"] = html_escape(item[\"text\"])\n        end\n        item\n      end\n      raw_result[\"content\"] = sanitized_content\n    end\n    raw_result\n  else\n    {\"content\" => [{\"type\" => \"text\", \"text\" => \"Tool execution not implemented for: #{@name}\"}] of Hash(String, String), \"isError\" => \"false\"}\n  end\nend\n"},"external_var":false},{"html_id":"input_schema:JsonObject-instance-method","name":"input_schema","doc":"JSON Schema defining expected parameters","summary":"<p>JSON Schema defining expected parameters</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":13,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L13"},"def":{"name":"input_schema","return_type":"JsonObject","visibility":"Public","body":"@input_schema"},"external_var":false},{"html_id":"name:String-instance-method","name":"name","doc":"Tool name (unique identifier)","summary":"<p>Tool name (unique identifier)</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":7,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L7"},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"},"external_var":false},{"html_id":"on_execute(&callback:JsonObject|Nil,Context|Nil->Hash(String,String|Array(Hash(String,String))))-instance-method","name":"on_execute","doc":"Set the execution callback","summary":"<p>Set the execution callback</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":39,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L39"},"def":{"name":"on_execute","yields":2,"block_arity":2,"block_arg":{"name":"callback","external_name":"callback","restriction":"(JsonObject | ::Nil, Context | ::Nil -> Hash(String, String | Array(Hash(String, String))))"},"visibility":"Public","body":"@callback = callback\nself\n"},"external_var":false},{"html_id":"to_json_object-instance-method","name":"to_json_object","doc":"Convert to JSON-compatible Hash","summary":"<p>Convert to JSON-compatible Hash</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":202,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L202"},"def":{"name":"to_json_object","visibility":"Public","body":"{\"name\" => @name, \"description\" => @description, \"inputSchema\" => @input_schema} of String => String | JsonObject"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ToolManager","path":"MocoPo/ToolManager.html","kind":"class","full_name":"MocoPo::ToolManager","name":"ToolManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/tools.cr","line_number":212,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L212"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"RATE_LIMIT_MAX_CALLS","name":"RATE_LIMIT_MAX_CALLS","value":"5"},{"id":"RATE_LIMIT_WINDOW","name":"RATE_LIMIT_WINDOW","value":"10","doc":"Rate limit settings","summary":"<p>Rate limit settings</p>"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Manages tools for an MCP server","summary":"<p>Manages tools for an MCP server</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new tool manager","summary":"<p>Initialize a new tool manager</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":224,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L224"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"execute_tool(name:String,arguments:JsonObject|Nil,context:Context|Nil=nil):Hash(String,String|Array(Hash(String,String)))-instance-method","name":"execute_tool","doc":"Execute a tool by name with rate limiting.\nReturns an error if the tool is not found, or if the client exceeds the rate limit.\nThis method should be called by handlers to enforce security best practices.","summary":"<p>Execute a tool by name with rate limiting.</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"},{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"args_string":"(name : String, arguments : JsonObject | Nil, context : Context | Nil = nil) : Hash(String, String | Array(Hash(String, String)))","args_html":"(name : String, arguments : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a> | Nil = <span class=\"n\">nil</span>) : Hash(String, String | Array(Hash(String, String)))","location":{"filename":"src/mocopo/tools.cr","line_number":233,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L233"},"def":{"name":"execute_tool","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"arguments","external_name":"arguments","restriction":"JsonObject | ::Nil"},{"name":"context","default_value":"nil","external_name":"context","restriction":"Context | ::Nil"}],"return_type":"Hash(String, String | Array(Hash(String, String)))","visibility":"Public","body":"tool = @tools[name]?\nif tool\nelse\n  return {\"content\" => [{\"type\" => \"text\", \"text\" => \"Tool not found: #{name}\"}] of Hash(String, String), \"isError\" => \"true\"}\nend\n\n\nif context\n  client_id = context.client_id\n  now = Time.utc\n  log = @rate_limit_log.has_key?(client_id) ? @rate_limit_log[client_id] : [] of Time\n\n  log = log.select do |t|\n    (now - t).total_seconds < RATE_LIMIT_WINDOW\n  end\n  if log.size >= RATE_LIMIT_MAX_CALLS\n    return {\"content\" => [{\"type\" => \"text\", \"text\" => \"Rate limit exceeded: max #{RATE_LIMIT_MAX_CALLS} calls per #{RATE_LIMIT_WINDOW} seconds.\"}] of Hash(String, String), \"isError\" => \"true\"}\n  end\n  log << now\n  @rate_limit_log[client_id] = log\nend\n\ntool.execute(arguments, context)\n"},"external_var":false},{"html_id":"exists?(name:String):Bool-instance-method","name":"exists?","doc":"Check if a tool exists","summary":"<p>Check if a tool exists</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Bool","args_html":"(name : String) : Bool","location":{"filename":"src/mocopo/tools.cr","line_number":299,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L299"},"def":{"name":"exists?","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Bool","visibility":"Public","body":"@tools.has_key?(name)"},"external_var":false},{"html_id":"get(name:String):Tool|Nil-instance-method","name":"get","doc":"Get a tool by name","summary":"<p>Get a tool by name</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String) : Tool | Nil","args_html":"(name : String) : <a href=\"../MocoPo/Tool.html\">Tool</a> | Nil","location":{"filename":"src/mocopo/tools.cr","line_number":289,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L289"},"def":{"name":"get","args":[{"name":"name","external_name":"name","restriction":"String"}],"return_type":"Tool | ::Nil","visibility":"Public","body":"@tools[name]?"},"external_var":false},{"html_id":"list:Array(Tool)-instance-method","name":"list","doc":"List all registered tools","summary":"<p>List all registered tools</p>","abstract":false,"location":{"filename":"src/mocopo/tools.cr","line_number":294,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L294"},"def":{"name":"list","return_type":"Array(Tool)","visibility":"Public","body":"@tools.values"},"external_var":false},{"html_id":"register(tool:Tool)-instance-method","name":"register","doc":"Register a new tool","summary":"<p>Register a new tool</p>","abstract":false,"args":[{"name":"tool","external_name":"tool","restriction":"Tool"}],"args_string":"(tool : Tool)","args_html":"(tool : <a href=\"../MocoPo/Tool.html\">Tool</a>)","location":{"filename":"src/mocopo/tools.cr","line_number":278,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L278"},"def":{"name":"register","args":[{"name":"tool","external_name":"tool","restriction":"Tool"}],"visibility":"Public","body":"was_new = !(@tools.has_key?(tool.name))\n@tools[tool.name] = tool\n\n\nif (was_new && (server = @server)) && (notification_manager = server.notification_manager)\n  notification_manager.tools_list_changed\nend\n"},"external_var":false},{"html_id":"remove(name:String)-instance-method","name":"remove","doc":"Remove a tool","summary":"<p>Remove a tool</p>","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/mocopo/tools.cr","line_number":304,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L304"},"def":{"name":"remove","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"if @tools.has_key?(name)\n  @tools.delete(name)\n\n\n  if (server = @server) && (notification_manager = server.notification_manager)\n    notification_manager.tools_list_changed\n  end\nend"},"external_var":false},{"html_id":"server=(server:Server)-instance-method","name":"server=","doc":"Set the server instance","summary":"<p>Set the server instance</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/tools.cr","line_number":273,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/tools.cr#L273"},"def":{"name":"server=","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"@server = server"},"external_var":false}]},{"html_id":"mocopo/MocoPo/ToolsHandler","path":"MocoPo/ToolsHandler.html","kind":"class","full_name":"MocoPo::ToolsHandler","name":"ToolsHandler","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},"ancestors":[{"html_id":"mocopo/MocoPo/BaseHandler","kind":"class","full_name":"MocoPo::BaseHandler","name":"BaseHandler"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/handlers/tools_handler.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/tools_handler.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Handler for tools methods","summary":"<p>Handler for tools methods</p>","instance_methods":[{"html_id":"handle(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle","doc":"Handle a JSON-RPC request","summary":"<p>Handle a JSON-RPC request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/tools_handler.cr","line_number":109,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/tools_handler.cr#L109"},"def":{"name":"handle","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"error_response(-32603, \"ToolsHandler.handle called directly\", id)"},"external_var":false},{"html_id":"handle_call(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_call","doc":"Handle tools/call request","summary":"<p>Handle tools/call request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/tools_handler.cr","line_number":44,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/tools_handler.cr#L44"},"def":{"name":"handle_call","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"name = get_string_param(params, \"name\")\narguments = get_hash_param(params, \"arguments\")\n\n\nif name && (@server.tool_manager.exists?(name))\nelse\n  return error_response(-32602, \"Unknown tool: #{name || \"missing name\"}\", id)\nend\n\n\ntool = (@server.tool_manager.get(name)).not_nil!\n\nbegin\n  json_args = arguments\n\n\n  request_id = id.to_s\n  client_id = \"client-#{Random.new.hex(4)}\"\n  context = Context.new(request_id, client_id, @server)\n\n\n  raw_result = tool.execute(json_args, context)\n\n\n  result = {\"content\" => raw_result[\"content\"]?.try do |content|\n    if content.is_a?(Array)\n      content.map do |item|\n        if item.is_a?(Hash)\n          item_hash = {} of String => String | Bool\n          item.each do |k, v|\n            item_hash[k] = v\n          end\n          item_hash\n        else\n          {} of String => String\n        end\n      end\n    else\n      [] of Hash(String, String)\n    end\n  end || ([] of Hash(String, String)), \"isError\" => raw_result[\"isError\"]? == \"true\"}\n\n\n  safe_success_response(id, result)\nrescue ex\n  error_result = {\"content\" => [{\"type\" => \"text\", \"text\" => \"Error executing tool: #{ex.message}\"}], \"isError\" => true}\n\n\n  safe_success_response(id, error_result)\nend\n"},"external_var":false},{"html_id":"handle_list(id:JsonRpcId,params:JsonRpcParams):JsonObject-instance-method","name":"handle_list","doc":"Handle tools/list request","summary":"<p>Handle tools/list request</p>","abstract":false,"args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"args_string":"(id : JsonRpcId, params : JsonRpcParams) : JsonObject","args_html":"(id : <a href=\"../MocoPo/JsonRpcId.html\">JsonRpcId</a>, params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/handlers/tools_handler.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/handlers/tools_handler.cr#L5"},"def":{"name":"handle_list","args":[{"name":"id","external_name":"id","restriction":"JsonRpcId"},{"name":"params","external_name":"params","restriction":"JsonRpcParams"}],"return_type":"JsonObject","visibility":"Public","body":"cursor = get_string_param(params, \"cursor\")\n\n\ntools = @server.tool_manager.list\n\n\npage_tools, next_cursor = Pagination.paginate(tools, cursor)\n\n\nresponse = {} of String => JsonValue\n\n\ntools_array = [] of JsonValue\npage_tools.each do |tool|\n  tool_json = tool.to_json_object\n  tool_json_str = tool_json.to_json\n  tool_json_value = (JSON.parse(tool_json_str)).as_h\n\n\n  tool_value = {} of String => JsonValue\n  tool_json_value.each do |k, v|\n    tool_value[k] = Utils.to_json_value(v)\n  end\n\n  tools_array << tool_value\nend\nresponse[\"tools\"] = tools_array\n\n\nif next_cursor\n  response[\"nextCursor\"] = next_cursor\nend\n\n\nsafe_success_response(id, response)\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/TopKSamplingMethod","path":"MocoPo/TopKSamplingMethod.html","kind":"class","full_name":"MocoPo::TopKSamplingMethod","name":"TopKSamplingMethod","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},"ancestors":[{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":551,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L551"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Top-K sampling method","summary":"<p>Top-K sampling method</p>","constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":552,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L552"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"parameters_schema:JsonObject-instance-method","name":"parameters_schema","doc":"Return the parameters schema","summary":"<p>Return the parameters schema</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":556,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L556"},"def":{"name":"parameters_schema","return_type":"JsonObject","visibility":"Public","body":"{\"type\" => \"object\", \"properties\" => {\"k\" => {\"type\" => \"integer\", \"description\" => \"Number of tokens to select from\", \"minimum\" => 1, \"default\" => 40} of String => JsonValue} of String => JsonValue, \"required\" => [\"k\"] of JsonValue} of String => JsonValue"},"external_var":false},{"html_id":"sample(text:String,params:JsonObject|Nil,context:Context):JsonObject-instance-method","name":"sample","doc":"Execute sampling","summary":"<p>Execute sampling</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(text : String, params : JsonObject | Nil, context : Context) : JsonObject","args_html":"(text : String, params : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":571,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L571"},"def":{"name":"sample","args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"JsonObject","visibility":"Public","body":"k = 40\n\nif params\n  k_value = params[\"k\"]?\n  k = (MocoPo.safe_int(k_value)) || 40\nend\n\n{\"text\" => \"Sampling result (top_k: #{k}): #{text}\"} of String => JsonValue\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/TopPSamplingMethod","path":"MocoPo/TopPSamplingMethod.html","kind":"class","full_name":"MocoPo::TopPSamplingMethod","name":"TopPSamplingMethod","abstract":false,"superclass":{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},"ancestors":[{"html_id":"mocopo/MocoPo/SamplingMethod","kind":"class","full_name":"MocoPo::SamplingMethod","name":"SamplingMethod"},{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/sampling.cr","line_number":588,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L588"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Top-P sampling method","summary":"<p>Top-P sampling method</p>","constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":589,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L589"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"parameters_schema:JsonObject-instance-method","name":"parameters_schema","doc":"Return the parameters schema","summary":"<p>Return the parameters schema</p>","abstract":false,"location":{"filename":"src/mocopo/sampling.cr","line_number":593,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L593"},"def":{"name":"parameters_schema","return_type":"JsonObject","visibility":"Public","body":"{\"type\" => \"object\", \"properties\" => {\"p\" => {\"type\" => \"number\", \"description\" => \"Cumulative probability threshold (0.0 to 1.0)\", \"minimum\" => 0.0, \"maximum\" => 1.0, \"default\" => 0.9} of String => JsonValue} of String => JsonValue, \"required\" => [\"p\"] of JsonValue} of String => JsonValue"},"external_var":false},{"html_id":"sample(text:String,params:JsonObject|Nil,context:Context):JsonObject-instance-method","name":"sample","doc":"Execute sampling","summary":"<p>Execute sampling</p>","abstract":false,"args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"args_string":"(text : String, params : JsonObject | Nil, context : Context) : JsonObject","args_html":"(text : String, params : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a> | Nil, context : <a href=\"../MocoPo/Context.html\">Context</a>) : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>","location":{"filename":"src/mocopo/sampling.cr","line_number":609,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/sampling.cr#L609"},"def":{"name":"sample","args":[{"name":"text","external_name":"text","restriction":"String"},{"name":"params","external_name":"params","restriction":"JsonObject | ::Nil"},{"name":"context","external_name":"context","restriction":"Context"}],"return_type":"JsonObject","visibility":"Public","body":"p = 0.9\n\nif params\n  p_value = params[\"p\"]?\n  p = (MocoPo.safe_float(p_value)) || 0.9\nend\n\n{\"text\" => \"Sampling result (top_p: #{p}): #{text}\"} of String => JsonValue\n"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Transport","path":"MocoPo/Transport.html","kind":"class","full_name":"MocoPo::Transport","name":"Transport","abstract":true,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/transport.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"mocopo/MocoPo/HttpTransport","kind":"class","full_name":"MocoPo::HttpTransport","name":"HttpTransport"},{"html_id":"mocopo/MocoPo/SseTransport","kind":"class","full_name":"MocoPo::SseTransport","name":"SseTransport"},{"html_id":"mocopo/MocoPo/StdioTransport","kind":"class","full_name":"MocoPo::StdioTransport","name":"StdioTransport"}],"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Transport interface for MCP communication","summary":"<p>Transport interface for MCP communication</p>","constructors":[{"html_id":"new-class-method","name":"new","doc":"Initialize a new transport","summary":"<p>Initialize a new transport</p>","abstract":false,"location":{"filename":"src/mocopo/transport.cr","line_number":14,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L14"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close:Nil-instance-method","name":"close","doc":"Close the transport","summary":"<p>Close the transport</p>","abstract":true,"location":{"filename":"src/mocopo/transport.cr","line_number":27,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L27"},"def":{"name":"close","return_type":"Nil","visibility":"Public","body":""},"external_var":false},{"html_id":"on_close:Proc(Nil)|Nil-instance-method","name":"on_close","doc":"Event handler for when the transport is closed","summary":"<p>Event handler for when the transport is closed</p>","abstract":false,"location":{"filename":"src/mocopo/transport.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L11"},"def":{"name":"on_close","return_type":"Proc(Nil) | ::Nil","visibility":"Public","body":"@on_close"},"external_var":false},{"html_id":"on_close=(on_close:Proc(Nil)|Nil)-instance-method","name":"on_close=","doc":"Event handler for when the transport is closed","summary":"<p>Event handler for when the transport is closed</p>","abstract":false,"args":[{"name":"on_close","external_name":"on_close","restriction":"Proc(Nil) | ::Nil"}],"args_string":"(on_close : Proc(Nil) | Nil)","args_html":"(on_close : Proc(Nil) | Nil)","location":{"filename":"src/mocopo/transport.cr","line_number":11,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L11"},"def":{"name":"on_close=","args":[{"name":"on_close","external_name":"on_close","restriction":"Proc(Nil) | ::Nil"}],"visibility":"Public","body":"@on_close = on_close"},"external_var":false},{"html_id":"on_error:Proc(Exception,Nil)|Nil-instance-method","name":"on_error","doc":"Event handler for when an error occurs","summary":"<p>Event handler for when an error occurs</p>","abstract":false,"location":{"filename":"src/mocopo/transport.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L8"},"def":{"name":"on_error","return_type":"Proc(Exception, Nil) | ::Nil","visibility":"Public","body":"@on_error"},"external_var":false},{"html_id":"on_error=(on_error:Proc(Exception,Nil)|Nil)-instance-method","name":"on_error=","doc":"Event handler for when an error occurs","summary":"<p>Event handler for when an error occurs</p>","abstract":false,"args":[{"name":"on_error","external_name":"on_error","restriction":"Proc(Exception, Nil) | ::Nil"}],"args_string":"(on_error : Proc(Exception, Nil) | Nil)","args_html":"(on_error : Proc(Exception, Nil) | Nil)","location":{"filename":"src/mocopo/transport.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L8"},"def":{"name":"on_error=","args":[{"name":"on_error","external_name":"on_error","restriction":"Proc(Exception, Nil) | ::Nil"}],"visibility":"Public","body":"@on_error = on_error"},"external_var":false},{"html_id":"on_message:Proc(JsonObject,Nil)|Nil-instance-method","name":"on_message","doc":"Event handler for when a message is received","summary":"<p>Event handler for when a message is received</p>","abstract":false,"location":{"filename":"src/mocopo/transport.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L5"},"def":{"name":"on_message","return_type":"Proc(JsonObject, Nil) | ::Nil","visibility":"Public","body":"@on_message"},"external_var":false},{"html_id":"on_message=(on_message:Proc(JsonObject,Nil)|Nil)-instance-method","name":"on_message=","doc":"Event handler for when a message is received","summary":"<p>Event handler for when a message is received</p>","abstract":false,"args":[{"name":"on_message","external_name":"on_message","restriction":"Proc(JsonObject, Nil) | ::Nil"}],"args_string":"(on_message : Proc(JsonObject, Nil) | Nil)","args_html":"(on_message : Proc(<a href=\"../MocoPo/JsonObject.html\">JsonObject</a>, Nil) | Nil)","location":{"filename":"src/mocopo/transport.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L5"},"def":{"name":"on_message=","args":[{"name":"on_message","external_name":"on_message","restriction":"Proc(JsonObject, Nil) | ::Nil"}],"visibility":"Public","body":"@on_message = on_message"},"external_var":false},{"html_id":"send(message:JsonObject):Nil-instance-method","name":"send","doc":"Send a JSON-RPC message","summary":"<p>Send a JSON-RPC message</p>","abstract":true,"args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"args_string":"(message : JsonObject) : Nil","args_html":"(message : <a href=\"../MocoPo/JsonObject.html\">JsonObject</a>) : Nil","location":{"filename":"src/mocopo/transport.cr","line_number":24,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L24"},"def":{"name":"send","args":[{"name":"message","external_name":"message","restriction":"JsonObject"}],"return_type":"Nil","visibility":"Public","body":""},"external_var":false},{"html_id":"start:Nil-instance-method","name":"start","doc":"Start the transport","summary":"<p>Start the transport</p>","abstract":true,"location":{"filename":"src/mocopo/transport.cr","line_number":21,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport.cr#L21"},"def":{"name":"start","return_type":"Nil","visibility":"Public","body":""},"external_var":false}]},{"html_id":"mocopo/MocoPo/TransportManager","path":"MocoPo/TransportManager.html","kind":"class","full_name":"MocoPo::TransportManager","name":"TransportManager","abstract":false,"superclass":{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"mocopo/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"mocopo/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/mocopo/transport_manager.cr","line_number":8,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L8"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Manager for MCP transports","summary":"<p>Manager for MCP transports</p>","constructors":[{"html_id":"new(server:Server)-class-method","name":"new","doc":"Initialize a new transport manager","summary":"<p>Initialize a new transport manager</p>","abstract":false,"args":[{"name":"server","external_name":"server","restriction":"Server"}],"args_string":"(server : Server)","args_html":"(server : <a href=\"../MocoPo/Server.html\">Server</a>)","location":{"filename":"src/mocopo/transport_manager.cr","line_number":16,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L16"},"def":{"name":"new","args":[{"name":"server","external_name":"server","restriction":"Server"}],"visibility":"Public","body":"_ = allocate\n_.initialize(server)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"},"external_var":false}],"instance_methods":[{"html_id":"close_all:Nil-instance-method","name":"close_all","doc":"Close all registered transports","summary":"<p>Close all registered transports</p>","abstract":false,"location":{"filename":"src/mocopo/transport_manager.cr","line_number":74,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L74"},"def":{"name":"close_all","return_type":"Nil","visibility":"Public","body":"@transports.each(&.close)\n@transports.clear\n"},"external_var":false},{"html_id":"create_http_transport:HttpTransport-instance-method","name":"create_http_transport","doc":"Create and register an HTTP transport","summary":"<p>Create and register an HTTP transport</p>","abstract":false,"location":{"filename":"src/mocopo/transport_manager.cr","line_number":48,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L48"},"def":{"name":"create_http_transport","return_type":"HttpTransport","visibility":"Public","body":"transport = HttpTransport.new(@server)\nregister(transport)\ntransport\n"},"external_var":false},{"html_id":"create_sse_transport:SseTransport-instance-method","name":"create_sse_transport","doc":"Create and register an SSE transport","summary":"<p>Create and register an SSE transport</p>","abstract":false,"location":{"filename":"src/mocopo/transport_manager.cr","line_number":62,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L62"},"def":{"name":"create_sse_transport","return_type":"SseTransport","visibility":"Public","body":"transport = SseTransport.new(@server)\nregister(transport)\ntransport\n"},"external_var":false},{"html_id":"create_stdio_transport:StdioTransport-instance-method","name":"create_stdio_transport","doc":"Create and register a stdio transport","summary":"<p>Create and register a stdio transport</p>","abstract":false,"location":{"filename":"src/mocopo/transport_manager.cr","line_number":55,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L55"},"def":{"name":"create_stdio_transport","return_type":"StdioTransport","visibility":"Public","body":"transport = StdioTransport.new\nregister(transport)\ntransport\n"},"external_var":false},{"html_id":"register(transport:Transport):Transport-instance-method","name":"register","doc":"Register a transport","summary":"<p>Register a transport</p>","abstract":false,"args":[{"name":"transport","external_name":"transport","restriction":"Transport"}],"args_string":"(transport : Transport) : Transport","args_html":"(transport : <a href=\"../MocoPo/Transport.html\">Transport</a>) : <a href=\"../MocoPo/Transport.html\">Transport</a>","location":{"filename":"src/mocopo/transport_manager.cr","line_number":21,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L21"},"def":{"name":"register","args":[{"name":"transport","external_name":"transport","restriction":"Transport"}],"return_type":"Transport","visibility":"Public","body":"transport.on_message = ->(message : JsonObject) do\n  handle_message(message, transport)\n  nil\nend\n\n\ntransport.on_error = ->(error : Exception) do\n  handle_error(error, transport)\n  nil\nend\n\n\ntransport.on_close = -> do\n  handle_close(transport)\n  nil\nend\n\n\n@transports << transport\n\n\ntransport\n"},"external_var":false},{"html_id":"start_all:Nil-instance-method","name":"start_all","doc":"Start all registered transports","summary":"<p>Start all registered transports</p>","abstract":false,"location":{"filename":"src/mocopo/transport_manager.cr","line_number":69,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/transport_manager.cr#L69"},"def":{"name":"start_all","return_type":"Nil","visibility":"Public","body":"@transports.each(&.start)"},"external_var":false}]},{"html_id":"mocopo/MocoPo/Utils","path":"MocoPo/Utils.html","kind":"module","full_name":"MocoPo::Utils","name":"Utils","abstract":false,"locations":[{"filename":"src/mocopo/utils.cr","line_number":3,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L3"}],"repository_name":"mocopo","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"mocopo/MocoPo","kind":"module","full_name":"MocoPo","name":"MocoPo"},"doc":"Utility functions for MocoPo","summary":"<p>Utility functions for MocoPo</p>","class_methods":[{"html_id":"ensure_json_value(obj):JsonValue-class-method","name":"ensure_json_value","doc":"Ensure any object is converted to JsonValue","summary":"<p>Ensure any object is converted to JsonValue</p>","abstract":false,"args":[{"name":"obj","external_name":"obj","restriction":""}],"args_string":"(obj) : JsonValue","args_html":"(obj) : <a href=\"../MocoPo/JsonValue.html\">JsonValue</a>","location":{"filename":"src/mocopo/utils.cr","line_number":80,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L80"},"def":{"name":"ensure_json_value","args":[{"name":"obj","external_name":"obj","restriction":""}],"return_type":"JsonValue","visibility":"Public","body":"case obj\nwhen String, Int32, Float64, Bool, Nil\n  obj\nwhen Hash\n  result = {} of String => JsonValue\n  obj.each do |k, v|\n    result[k.to_s] = ensure_json_value(v)\n  end\n  result\nwhen Array\n  result = [] of JsonValue\n  obj.each do |v|\n    result << (ensure_json_value(v))\n  end\n  result\nelse\n  obj.to_s\nend"},"external_var":false},{"html_id":"get_array_param(params:JsonRpcParams|Nil,key:String):Array(JsonValue)|Nil-class-method","name":"get_array_param","doc":"Extract an array parameter from JsonRpcParams","summary":"<p>Extract an array parameter from JsonRpcParams</p>","abstract":false,"args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(params : JsonRpcParams | Nil, key : String) : Array(JsonValue) | Nil","args_html":"(params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a> | Nil, key : String) : Array(<a href=\"../MocoPo/JsonValue.html\">JsonValue</a>) | Nil","location":{"filename":"src/mocopo/utils.cr","line_number":118,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L118"},"def":{"name":"get_array_param","args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"return_type":"Array(JsonValue) | ::Nil","visibility":"Public","body":"if params && params[key]?\nelse\n  return nil\nend\n\nvalue = params[key]\nvalue.is_a?(Array) ? value.as(Array(JsonValue)) : nil\n"},"external_var":false},{"html_id":"get_hash_param(params:JsonRpcParams|Nil,key:String):Hash(String,JsonValue)|Nil-class-method","name":"get_hash_param","doc":"Extract a hash parameter from JsonRpcParams","summary":"<p>Extract a hash parameter from JsonRpcParams</p>","abstract":false,"args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(params : JsonRpcParams | Nil, key : String) : Hash(String, JsonValue) | Nil","args_html":"(params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a> | Nil, key : String) : Hash(String, <a href=\"../MocoPo/JsonValue.html\">JsonValue</a>) | Nil","location":{"filename":"src/mocopo/utils.cr","line_number":110,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L110"},"def":{"name":"get_hash_param","args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"return_type":"Hash(String, JsonValue) | ::Nil","visibility":"Public","body":"if params && params[key]?\nelse\n  return nil\nend\n\nvalue = params[key]\nvalue.is_a?(Hash) ? value.as(Hash(String, JsonValue)) : nil\n"},"external_var":false},{"html_id":"get_string_param(params:JsonRpcParams|Nil,key:String):String|Nil-class-method","name":"get_string_param","doc":"Extract a string parameter from JsonRpcParams","summary":"<p>Extract a string parameter from JsonRpcParams</p>","abstract":false,"args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"args_string":"(params : JsonRpcParams | Nil, key : String) : String | Nil","args_html":"(params : <a href=\"../MocoPo/JsonRpcParams.html\">JsonRpcParams</a> | Nil, key : String) : String | Nil","location":{"filename":"src/mocopo/utils.cr","line_number":102,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L102"},"def":{"name":"get_string_param","args":[{"name":"params","external_name":"params","restriction":"JsonRpcParams | ::Nil"},{"name":"key","external_name":"key","restriction":"String"}],"return_type":"String | ::Nil","visibility":"Public","body":"if params && params[key]?\nelse\n  return nil\nend\n\nvalue = params[key]\nvalue.is_a?(String) ? value : nil\n"},"external_var":false},{"html_id":"to_json_any(value:JsonValue):JSON::Any-class-method","name":"to_json_any","doc":"Convert JsonValue to JSON::Any","summary":"<p>Convert JsonValue to JSON::Any</p>","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JsonValue"}],"args_string":"(value : JsonValue) : JSON::Any","args_html":"(value : <a href=\"../MocoPo/JsonValue.html\">JsonValue</a>) : JSON::Any","location":{"filename":"src/mocopo/utils.cr","line_number":5,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L5"},"def":{"name":"to_json_any","args":[{"name":"value","external_name":"value","restriction":"JsonValue"}],"return_type":"JSON::Any","visibility":"Public","body":"case value\nwhen String\n  JSON::Any.new(value)\nwhen Int32\n  JSON::Any.new(value)\nwhen Float64\n  JSON::Any.new(value)\nwhen Bool\n  JSON::Any.new(value)\nwhen Nil\n  JSON::Any.new(nil)\nwhen Hash\n  hash = {} of String => JSON::Any\n  (value.as(Hash)).each do |k, v|\n    hash[k.to_s] = to_json_any(v)\n  end\n  JSON::Any.new(hash)\nwhen Array\n  array = [] of JSON::Any\n  (value.as(Array)).each do |v|\n    array << (to_json_any(v))\n  end\n  JSON::Any.new(array)\nelse\n  JSON::Any.new(nil)\nend"},"external_var":false},{"html_id":"to_json_value(value:JSON::Any):JsonValue-class-method","name":"to_json_value","doc":"Convert JSON::Any to JsonValue","summary":"<p>Convert JSON::Any to JsonValue</p>","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"JSON::Any"}],"args_string":"(value : JSON::Any) : JsonValue","args_html":"(value : JSON::Any) : <a href=\"../MocoPo/JsonValue.html\">JsonValue</a>","location":{"filename":"src/mocopo/utils.cr","line_number":35,"url":"https://github.com/kojix2/mocopo/blob/772353588e3578e6ac3e677cf3847d11dd5ebd27/src/mocopo/utils.cr#L35"},"def":{"name":"to_json_value","args":[{"name":"value","external_name":"value","restriction":"JSON::Any"}],"return_type":"JsonValue","visibility":"Public","body":"raw = value.raw\ncase raw\nwhen String, Int32, Float64, Bool, Nil\n  raw\nwhen Hash\n  hash = {} of String => JsonValue\n  (raw.as(Hash)).each do |k, v|\n    case v\n    when String, Int32, Float64, Bool, Nil\n      hash[k.to_s] = v\n    when Hash, Array\n      v_str = v.to_json\n      v_json = JSON.parse(v_str)\n      hash[k.to_s] = to_json_value(v_json)\n    else\n      hash[k.to_s] = nil\n    end\n  end\n  hash\nwhen Array\n  array = [] of JsonValue\n  (raw.as(Array)).each do |v|\n    case v\n    when String, Int32, Float64, Bool, Nil\n      array << v\n    when Hash, Array\n      v_str = v.to_json\n      v_json = JSON.parse(v_str)\n      array << (to_json_value(v_json))\n    else\n      array << nil\n    end\n  end\n  array\nelse\n  nil\nend\n"},"external_var":false}]}]}]}}